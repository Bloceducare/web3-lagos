(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3712],{67813:(e,t,n)=>{"use strict";n.d(t,{So:()=>o});var r=n(52105),s=n(5862),i=n(71016),l=n(7094);let a=(0,s._)({get:{data:i.qY,query:l.z.object({isLiveCapture:l.z.string().optional()})}});n(94344),n(79879);let o=(0,r.In)("GET","/api/lindyEmbed",a.get.data)},22283:(e,t,n)=>{"use strict";n.d(t,{o:()=>y});var r=n(50612),s=n(56779),i=n(94344),l=n(71995),a=n(56567),o=n(32419),c=n(25919);let d=e=>{let t=(e,t)=>({level:e,title:t,content:[],stringMarkdownContent:""}),n=[],r=null,s="",i=!1,l=[];if(e.split("\n").forEach(e=>{if(e.startsWith("```")){if(i){l.push(e);let r=t(0,"");r.content.push(...l),n.push(r),l=[]}else l.push(e);i=!i}else if(i)l.push(e);else{let i=e.startsWith("####")?4:e.startsWith("###")?3:e.startsWith("##")?2:e.startsWith("#")?1:0;if(i>0){let s=t(i,e);for(;r&&r.level>=i;)r=r.parent||null;r?(s.parent=r,r.content.push(s)):n.push(s),r=s}else r?r.content.push(e):s+=e+"\n"}}),s){let e=t(0,"");e.content.push(s.trim()),n.unshift(e)}let a=e=>{e.stringMarkdownContent=e.title,e.content.forEach(t=>{"object"==typeof t?(a(t),e.stringMarkdownContent+="\n"+t.stringMarkdownContent):e.stringMarkdownContent+="\n"+t})};n.forEach(e=>a(e));let o=e=>{delete e.parent,e.content.forEach(e=>{"object"==typeof e&&o(e)})};return n.forEach(e=>o(e)),n},u=(0,s.l)(),p=(0,s.m)(!1),m=["img"],g={CHILD_WRAPPER:"child-wrapper",COPY_CHILD_CONTENT:"copy-child-content",CHILD_CONTENT:"child-content",PARENT_COPY:"parent-copy",PARENT_CONTENT:"parent-content"},h=e=>{let{markdownContent:t,components:n,className:s}=e,h=e=>{let t=e.currentTarget.querySelector(".parent-content");null==t||t.classList.add("bg-slate-4","rounded-lg");let n=e.currentTarget.querySelector(".parent-copy");n&&n.classList.add("opacity-100")},f=e=>{let t=e.currentTarget.querySelector(".parent-content");null==t||t.classList.remove("bg-slate-4","rounded-lg");let n=e.currentTarget.querySelector(".parent-copy");n&&n.classList.remove("opacity-100")},x=e=>{e.stopPropagation();let t=e.currentTarget.querySelector(".child-content");null==t||t.classList.add("bg-slate-4","rounded-lg");let n=e.currentTarget.querySelector(".copy-child-content");n&&n.classList.add("opacity-100")},v=e=>{e.stopPropagation();let t=e.currentTarget.querySelector(".child-content");null==t||t.classList.remove("bg-slate-4","rounded-lg");let n=e.currentTarget.querySelector(".copy-child-content");n&&n.classList.remove("opacity-100")},y=(0,i.useMemo)(()=>({...n,h1:e=>{let{...t}=e;return(0,r.jsx)("h1",{...t,className:"mt-1",children:t.children})},h2:e=>{let{...t}=e;return(0,r.jsx)("h2",{...t,className:"mt-1",children:t.children})},h3:e=>{let{...t}=e;return(0,r.jsx)("h3",{...t,className:"mt-1",children:t.children})},h4:e=>{let{...t}=e;return(0,r.jsx)("h4",{...t,className:"mt-1",children:t.children})},p:e=>{let{...t}=e;return(0,r.jsx)("p",{...t,className:"my-1 mr-2",children:t.children})}}),[n]),w=(0,i.useMemo)(()=>d(t),[t]),j=()=>{o.z.capture("markdown_copied")},b=e=>{let t=Array.isArray(e.content)?e.content:[],n=t.filter(e=>"string"==typeof e).join("\n");return(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)(l.o,{remarkPlugins:u,rehypePlugins:p,components:y,disallowedElements:m,className:s,children:e.title?"".concat(e.title,"\n").concat(n):n}),t.filter(e=>"object"==typeof e).map((e,t)=>(0,r.jsxs)("div",{className:(0,c.QP)(g.CHILD_WRAPPER,"mb-4 flex flex-row"),onMouseOver:x,onMouseOut:v,children:[(0,r.jsx)("div",{className:(0,c.QP)(g.COPY_CHILD_CONTENT,"shrink-0 pr-1 pt-1 opacity-0 transition-opacity absolute left-0 mt-1"),onClick:j,children:(0,r.jsx)(a.Q,{result:e.stringMarkdownContent})}),(0,r.jsx)("div",{className:(0,c.QP)(g.CHILD_CONTENT,"flex w-full cursor-pointer flex-col rounded-xl -ml-1 pl-2"),children:b(e)})]},t))]},e.title)};return(0,r.jsx)("div",{children:w.map((e,t)=>(0,r.jsxs)("div",{className:"flex flex-row bg-slate-1",onMouseOver:h,onMouseOut:f,children:[(0,r.jsx)("div",{className:(0,c.QP)(g.PARENT_COPY,"shrink-0 p-1 pl-0 opacity-0 transition-opacity absolute left-0 bg-slate-1 -mt-1"),onClick:j,children:(0,r.jsx)(a.Q,{result:e.stringMarkdownContent})}),(0,r.jsx)("div",{className:(0,c.QP)(g.PARENT_CONTENT,"w-full cursor-pointer flex-col rounded-xl pl-2"),children:b(e)})]},t))})},f=(0,s.l)(),x=e=>e.startsWith("https://i.giphy.com/")?e:"",v=e=>e.stopPropagation(),y=(0,i.memo)(function(e){let{children:t,className:n,components:a,disableCopyUI:o,allowHTML:c}=e,d=(0,i.useMemo)(()=>(0,s.m)(c),[c]),u=(0,i.useMemo)(()=>({li:e=>{let{node:t,...n}=e,s=i.Children.toArray(n.children);return"string"==typeof s[0]&&""===s[0].trim()&&(s=s.slice(1)),"ordered"in n&&(n.ordered=n.ordered.toString()),(0,r.jsx)("li",{...n,children:s})},a:e=>{let{node:t,...n}=e;return(0,r.jsx)("a",{...n,onClick:v,className:"dark:text-white",children:n.children})},...a}),[a]);return!o&&/(\n#)|(^#)/.test(t)?(0,r.jsx)(h,{markdownContent:t,className:n,components:u}):(0,r.jsx)(l.o,{remarkPlugins:f,rehypePlugins:d,components:u,className:n,urlTransform:x,children:t})})},6762:(e,t,n)=>{"use strict";n.d(t,{f:()=>o});var r=n(50612),s=n(20335),i=n(45801),l=n(94344),a=n(25919);let o=(0,l.memo)((0,l.forwardRef)(function(e,t){let{className:n,value:o,onChange:c,onChangeRaw:d,readOnly:u,disabled:p,...m}=e,g=(0,l.useCallback)(e=>{null==d||d(e),null==c||c(e.target.value)},[d,c]);return(0,r.jsx)("textarea",{ref:t,className:(0,a.QP)(s.jp,i.Oc,n,p&&"bg-slate-2 text-slate-9"),value:o,enterKeyHint:"send",readOnly:u,onChange:g,disabled:p,...m})}))},66287:(e,t,n)=>{"use strict";n.d(t,{nQ:()=>b,YE:()=>C,nN:()=>N});var r=n(50612),s=n(52105),i=n(5862),l=n(7094);let a=(0,i._)({post:{body:l.z.object({userDeviceId:l.z.string().optional()}),data:l.z.object({success:l.z.boolean()})}}),o=(0,s.In)("POST","/api/lindyEmbed/closeSession",a.post.data);var c=n(67813),d=n(90719);let u=(0,i._)({post:{body:l.z.object({userDeviceId:l.z.string().optional(),events:d.qR.array()}),data:l.z.object({success:l.z.boolean(),lindyMessengerConversationId:l.z.string(),userDeviceId:l.z.string().optional()}),query:l.z.object({isLiveCapture:l.z.string().optional()})}}),p=(0,s.In)("POST","/api/lindyEmbed/sendEvents",u.post.data);function m(e){return e?"ancestorOrigins"in window.location?window.location.ancestorOrigins[0]:window.document.referrer:void 0}var g=n(51580),h=n(13268);let f=(0,n(14600).DS)({name:"lindyMessenger",events:{updateEvent:d.qR}});var x=n(89073),v=n(98354),y=n(77566),w=n(94344);async function j(e,t){let n=m(!0);if(n)return await new Promise(r=>{let s=setTimeout(()=>{r(void 0)},500),i=n=>{if(n.data.type==="return:".concat(e)){clearTimeout(s);let e=t.safeParse(n.data.data);e.success?r(e.data):r(void 0),window.removeEventListener("message",i)}};window.addEventListener("message",i),window.parent.postMessage({type:e},n)})}let b=(0,w.createContext)(null);function C(e){var t,n;let i=(0,x.jE)(),l=m(!0),a=(0,w.useRef)(null),[u,C]=(0,w.useState)(e.messengerConversationId),N=(0,w.useMemo)(()=>["lindyMessenger",e.messengerId],[e.messengerId]),z=(0,v.I)({queryKey:N,queryFn:async()=>(0,s.oA)((0,c.So)({query:{}},{headers:{"x-lindy-messenger-id":e.messengerId}})),onSuccess:e=>{e.userDeviceId&&(a.current=e.userDeviceId)}}),_=(0,w.useMemo)(()=>{var t,n,r;return null!==(r=null!==(n=null===(t=z.data)||void 0===t?void 0:t.conversationEvents)&&void 0!==n?n:e.conversationEvents)&&void 0!==r?r:[]},[null===(t=z.data)||void 0===t?void 0:t.conversationEvents,e.conversationEvents]),P=_.length>0,k=(0,w.useMemo)(()=>!_.length&&e.agentDefinition.greetingMessage?{type:"message",from:"bot",timestamp:Date.now().toString(),message:e.agentDefinition.greetingMessage}:void 0,[_,e.agentDefinition.greetingMessage]),E=(0,w.useMemo)(()=>_.length?_:k?[k]:[],[_,k]),T=(0,w.useCallback)(t=>{i.setQueryData(N,n=>{var r,s,i,l,a,o,c;let d=[...null!==(r=null==n?void 0:n.conversationEvents)&&void 0!==r?r:[]];if("optimistic-response"===t.type){let t=h.D.findLast(d,e=>"message"===e.type);return(null==t?void 0:t.from)==="user"?(d.push({type:"message",from:"bot",timestamp:"optimistic",message:""}),{configuration:null!==(s=null==n?void 0:n.configuration)&&void 0!==s?s:e.configuration,conversationEvents:d,agentDefinition:null!==(i=null==n?void 0:n.agentDefinition)&&void 0!==i?i:e.agentDefinition,isCreatorOfTrigger:null!==(l=null==n?void 0:n.isCreatorOfTrigger)&&void 0!==l?l:e.isCreatorOfTrigger}):n}let u=d.findIndex(e=>e.timestamp===t.timestamp||"optimistic"===e.timestamp),p=d[u];if(p){if("message"===t.type&&"message"===p.type&&p.message.length>t.message.length)return n;d[u]=t}else d.push(t);return{configuration:null!==(a=null==n?void 0:n.configuration)&&void 0!==a?a:e.configuration,conversationEvents:d,agentDefinition:null!==(o=null==n?void 0:n.agentDefinition)&&void 0!==o?o:e.agentDefinition,isCreatorOfTrigger:null!==(c=null==n?void 0:n.isCreatorOfTrigger)&&void 0!==c?c:e.isCreatorOfTrigger}})},[e.agentDefinition,e.configuration,e.isCreatorOfTrigger,z,i,N]);(0,g.S)(f,"updateEvent",u,e=>{T(e)});let[M,I]=(0,w.useState)(null),D=(0,y.n)({mutationFn:async t=>{var n,r,i;let{queryParams:l={},...o}=null!==(r=await j("currentLocation",d.es))&&void 0!==r?r:{},c=[{type:"message",from:"user",timestamp:String(Date.now()),message:t,locationData:o,queryParamContext:{...e.queryParamContext,...l}},...M?[M]:[]];return[...k?[k]:[],...c].forEach(T),await (0,s.oA)(p({body:{userDeviceId:null!==(i=a.current)&&void 0!==i?i:void 0,events:c},query:{isLiveCapture:String(!!(null===(n=e.queryParamContext)||void 0===n?void 0:n.isLiveCapture))}},{headers:{"x-lindy-messenger-id":e.messengerId}}))},onSuccess:e=>{e.userDeviceId&&(a.current=e.userDeviceId),setTimeout(()=>T({type:"optimistic-response"}),500),C(e.lindyMessengerConversationId)}}),S=(0,w.useCallback)(async()=>{var t;i.setQueryData(N,t=>{var n,r;return{configuration:null!==(n=null==t?void 0:t.configuration)&&void 0!==n?n:e.configuration,conversationEvents:[],agentDefinition:e.agentDefinition,isCreatorOfTrigger:null!==(r=null==t?void 0:t.isCreatorOfTrigger)&&void 0!==r?r:e.isCreatorOfTrigger}}),await (0,s.oA)(o({body:{userDeviceId:null!==(t=a.current)&&void 0!==t?t:void 0}},{headers:{"x-lindy-messenger-id":e.messengerId}})),C(void 0)},[e.agentDefinition,e.configuration,e.messengerId,e.isCreatorOfTrigger,z,i,N]),L=(0,w.useCallback)(e=>{D.mutate(e)},[D]),O=(0,w.useCallback)(async e=>{I(d.qR.parse({type:"user_data",timestamp:String(Date.now()),...e}))},[]),A=(0,w.useCallback)(()=>{e.minimizeChat&&e.minimizeChat(),l&&window.parent.postMessage({type:"minimizeChat"},{targetOrigin:l})},[l,!0,e]);(0,w.useEffect)(()=>{let e=e=>{"ping"===e.data.type||"userData"===e.data.type&&O(e.data.payload)};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[O]);let F=(0,w.useMemo)(()=>{var t,n;return{configuration:null!==(n=null===(t=z.data)||void 0===t?void 0:t.configuration)&&void 0!==n?n:e.configuration,conversationEvents:E,messengerId:e.messengerId,messengerConversationId:u,agentDefinition:e.agentDefinition,sendMessage:L,closeSession:S,setUserData:O,minimizeChat:A,isPopup:e.isPopup,isSending:D.isLoading,isInConversation:P,isInTestMode:e.isCreatorOfTrigger,hidePoweredByLindy:e.hidePoweredByLindy}},[null===(n=z.data)||void 0===n?void 0:n.configuration,e.configuration,e.messengerId,e.agentDefinition,e.isPopup,e.isCreatorOfTrigger,e.hidePoweredByLindy,E,u,L,S,O,A,D.isLoading,P]);return(0,r.jsx)(b.Provider,{value:F,children:e.children})}function N(){let e=(0,w.useContext)(b);if(!e)throw Error("useLindyEmbed must be used within a LindyEmbedContextProvider");return e}},93712:(e,t,n)=>{"use strict";n.d(t,{y:()=>M});var r=n(50612),s=n(97152),i=n(6762),l=n(66287),a=n(72260),o=n(90996),c=n(21649),d=n(38001),u=n(9966),p=n(16008),m=n(35774),g=n(94344),h=n(25919),f=n(33762);let x="flex cursor-pointer items-center whitespace-nowrap rounded-lg border px-3 py-1 h-[32px] text-xs text-slate-11 hover:bg-slate-3 active:bg-slate-4 border-slate-4";function v(e){let{submitQuery:t,conversationStarters:n,isPopup:s}=e,i=(0,d.LM)(),l=(0,g.useRef)(null),v=(0,g.useRef)(null),y=(0,g.useCallback)(e=>{let n=e.currentTarget.dataset.promptStarter;n&&t(n,()=>{})},[t]),w=(0,g.useMemo)(()=>({visible:{opacity:1,transition:{when:"beforeChildren",duration:0,staggerChildren:.1}},hidden:{opacity:0,transition:{when:"afterChildren"}}}),[]),j=(0,g.useMemo)(()=>({visible:{opacity:1,y:0},hidden:{opacity:0,y:10}}),[]),[b,C]=(0,g.useState)(null),[N,z]=(0,g.useState)([]),_=(0,g.useCallback)(()=>{let e=l.current,t=v.current;if(!n.length||!e||!t)return;let r=Array.from(e.children).filter(e=>e instanceof HTMLLIElement),s=t.clientWidth,i=r.filter(e=>e.clientWidth).length,a=!1;if(e.scrollWidth>s)for(let t=r.length-1;t>=1;t--){let n=r[t];if(!n||e.scrollWidth<=s)break;n.style.display="none",i--,a=!0}else if(e.scrollWidth<s)for(let t=i;t<r.length;t++){let n=r[t];if(!n)break;if(n.style.display="block",e.scrollWidth>s){n.style.display="none";break}i++,a=!0}(a||(null==b?void 0:b.length)!==n.length||b.some((e,t)=>e.value!==n[t]))&&(C(n.map((e,t)=>({value:e,style:{display:t<i?"block":"none"}}))),z(n.slice(i)))},[n,b]);(0,u.A)(v,_),(0,g.useEffect)(()=>{_(),n.length||(C(null),z([]))},[_,n]);let P=(0,g.useMemo)(()=>{var e;return b||(null!==(e=null==n?void 0:n.map(e=>({value:e,style:{display:"block"}})))&&void 0!==e?e:[])},[b,n]),k=(0,g.useRef)(null),[E,T]=(0,g.useState)(0);(0,f.Es)(()=>{k.current&&T(k.current.clientHeight)},[k.current]);let M=(0,g.useMemo)(()=>({bottom:"calc(".concat(E,"px + 1rem)")}),[E]),I=N.length>0;return(0,r.jsx)("div",{className:"flex w-full flex-col",ref:v,children:(0,r.jsxs)(a.AM,{className:"relative w-min max-w-full","data-testid":"lindy.conversation-view.prompt-starters.show-more",children:[(0,r.jsx)(p.N,{children:!i.data&&!!(null==P?void 0:P.length)&&(0,r.jsxs)(m.P.ul,{initial:"hidden",animate:"visible",variants:w,className:(0,h.QP)("flex max-w-full gap-2  w-min leading-6",s?"p-2 pl-0":"py-2"),ref:l,children:[P.map(e=>(0,r.jsx)(m.P.li,{variants:j,className:(0,h.QP)(x),onClick:y,style:e.style,"data-testid":"lindy.conversation-view.prompt-starters.pill","data-prompt-starter":e.value,children:e.value},e.value)),I&&(0,r.jsx)(a.AM.Button,{ref:k,children:(0,r.jsx)(m.P.li,{variants:j,className:x,children:(0,r.jsx)(c.A,{className:"size-6"})})})]})}),(0,r.jsx)(o.e,{enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:(0,r.jsx)(a.AM.Panel,{className:(0,h.QP)("absolute bg-white dark:bg-slate-2 rounded-lg shadow","flex w-60 flex-col gap-1 p-2 right-0"),style:M,children:N.map((e,t)=>(0,r.jsx)(a.AM.Button,{className:"rounded-lg border border-transparent px-2 py-1 text-left text-sm text-slate-12 hover:border-slate-4","data-testid":"lindy.conversation-view.prompt-starters.show-more-item","data-prompt-starter":e,onClick:y,children:e},t))})})]})})}var y=n(22283),w=n(3859),j=n(76532),b=n(25363),C=n(67373),N=n(39274),z=n(99968),_=n(21069),P=n(99100),k=n(48866),E=n.n(k);let T=(0,g.memo)(function(e){let{className:t}=e;return(0,r.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[(0,r.jsxs)("g",{clipPath:"url(#clip0_5730_5324)",children:[(0,r.jsx)("rect",{width:"24",height:"24",rx:"6",fill:"url(#paint0_linear_5730_5324)"}),(0,r.jsx)("path",{d:"M9.33301 8.3335C9.33301 6.86074 10.5269 5.66683 11.9997 5.66683C13.4724 5.66683 14.6663 6.86074 14.6663 8.3335C14.6663 9.80626 13.4724 11.0002 11.9997 11.0002C10.5269 11.0002 9.33301 9.80626 9.33301 8.3335ZM7.47511 15.3293C8.33062 13.7381 9.95087 12.6668 11.9997 12.6668C14.0485 12.6668 15.6687 13.7381 16.5242 15.3293C16.8381 15.9131 16.725 16.5078 16.3713 16.9479C16.022 17.3823 15.4401 17.6668 14.8028 17.6668H9.19651C8.55921 17.6668 7.97733 17.3823 7.62809 16.9479C7.27437 16.5078 7.16124 15.9131 7.47511 15.3293Z",fill:"#754F2E",stroke:"#754F2E",strokeWidth:"0.666667"})]}),(0,r.jsx)("rect",{x:"0.25",y:"0.25",width:"23.5",height:"23.5",rx:"5.75",stroke:"black",strokeOpacity:"0.05",strokeWidth:"0.5"}),(0,r.jsxs)("defs",{children:[(0,r.jsxs)("linearGradient",{id:"paint0_linear_5730_5324",x1:"35.3572",y1:"-5.14286",x2:"-8.78573",y2:"36.6428",gradientUnits:"userSpaceOnUse",children:[(0,r.jsx)("stop",{stopColor:"white"}),(0,r.jsx)("stop",{offset:"1",stopColor:"#FFD518"})]}),(0,r.jsx)("clipPath",{id:"clip0_5730_5324",children:(0,r.jsx)("rect",{width:"24",height:"24",rx:"6",fill:"white"})})]})]})});function M(){let{sendMessage:e,conversationEvents:t,configuration:n,agentDefinition:a,isPopup:o,minimizeChat:c,isInConversation:d,isInTestMode:u,closeSession:p,isInConfigurationPreview:x,hidePoweredByLindy:y}=(0,l.nN)(),[w,j]=(0,g.useState)(""),N=(0,g.useRef)(null),P=(0,g.useCallback)(e=>{j(e)},[]),k=(0,g.useCallback)(async t=>{null==t||t.preventDefault(),w&&(e(w),j(""))},[w,e]),T=(0,g.useCallback)(async t=>{t&&(e(t),j(""))},[e]),M=(0,g.useCallback)(async e=>{var t,n,r;"Enter"===e.key&&((null===(n=(r=window).matchMedia)||void 0===n?void 0:null===(t=n.call(r,"(pointer:coarse"))||void 0===t?void 0:t.matches)||!e.shiftKey)&&(e.preventDefault(),await k())},[k]);(0,f.Es)(()=>{var e;null===(e=N.current)||void 0===e||e.focus()},[]);let D=(0,g.useMemo)(()=>({backgroundColor:n.accentColor,color:(0,_.s)(n.accentColor)}),[n.accentColor]),S=(0,g.useMemo)(()=>({initial:{opacity:0,y:100},animate:{opacity:1,y:0},exit:{opacity:0,y:100},transition:{duration:.2,ease:"easeInOut"}}),[]),L=(0,g.useMemo)(()=>{let e=[],n=[];for(let r of t)if("message"===r.type){let t=n.at(-1);(null==t?void 0:t.type)!=="message"||t.from!==r.from?(n.length&&e.push(n),n=[r]):n.push(r)}else n.length&&(e.push(n),n=[]),e.push([r]);return n.length&&e.push(n),e},[t]);(0,b.Q)(N,[w]);let O=(0,g.useMemo)(()=>{var e;return null!==(e=n.lindyEmbedPromptStarters)&&void 0!==e?e:n.promptStarters},[n.lindyEmbedPromptStarters,n.promptStarters]);return(0,r.jsxs)("div",{className:(0,h.QP)("flex h-full w-full flex-col overflow-hidden items-center [color-scheme:light] text-slate-800 bg-white"),children:[(0,r.jsx)("div",{className:"w-full",style:D,children:(0,r.jsxs)("div",{className:"mx-auto flex max-w-[576px] cursor-pointer items-center justify-between gap-4 p-4 hover:opacity-85",onClick:c,children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[!!n.logoUrl&&(0,r.jsx)(E(),{alt:"".concat(n.displayName," logo"),src:n.logoUrl,className:"rounded",height:28,width:28}),(0,r.jsx)("h2",{className:"truncate font-semibold",children:n.displayName})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[!y&&(0,r.jsxs)("a",{href:"https://lindy.ai",target:"_blank",className:(0,h.QP)("text-xs opacity-80 hover:underline",x&&"pointer-events-none"),rel:"noreferrer",children:["Powered by ",(0,r.jsx)("span",{className:"font-bold",children:"Lindy"})]}),o&&(0,r.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsxs)("g",{clipPath:"url(#clip0_2815_2888)",children:[(0,r.jsx)("rect",{width:"20",height:"20",rx:"4",fill:"currentColor",fillOpacity:"0.1"}),(0,r.jsx)("path",{d:"M5.8335 10H14.1668",stroke:"currentColor",strokeWidth:"1.66667",strokeLinecap:"round"})]}),(0,r.jsx)("defs",{children:(0,r.jsx)("clipPath",{id:"clip0_2815_2888",children:(0,r.jsx)("rect",{width:"20",height:"20",rx:"4",fill:"white"})})})]})]})]})}),(0,r.jsx)("div",{className:"flex w-full grow flex-col-reverse items-center overflow-y-auto",children:(0,r.jsx)("div",{className:"flex w-full max-w-xl grow flex-col gap-6 p-4 text-sm",children:L.map((e,t)=>(0,r.jsx)("div",{className:"flex flex-col gap-2",children:e.map((e,t)=>(0,r.jsx)(m.P.div,{...S,children:(0,r.jsx)(I,{messageEvent:e,agentDefinition:a,logoUrl:n.logoUrl,showIcon:0===t},t)},t))},t))})}),d?u?(0,r.jsxs)("div",{className:(0,h.QP)("flex w-full max-w-xl items-center justify-between px-4",o&&"mb-1"),children:[(0,r.jsx)("div",{className:"ml-1 text-sm text-slate-600",children:"Test mode"}),(0,r.jsx)(C.$,{level:"outline",size:"sm",icon:(0,r.jsx)(s.A,{className:"w-4 text-slate-600"}),className:"bg-white text-slate-600",onClick:p,children:"Reset"})]}):null:(0,r.jsx)("div",{className:"mx-auto w-full max-w-[576px] px-4",children:(0,r.jsx)(v,{submitQuery:T,conversationStarters:O,isPopup:o})}),(0,r.jsx)("div",{className:(0,h.QP)("flex-shrink-0 w-full",o?"":"max-w-xl px-4 mt-2 mb-4"),children:(0,r.jsxs)("form",{onSubmit:k,className:"relative w-full resize-none",children:[(0,r.jsx)(i.f,{value:w,ref:N,placeholder:"Enter a message",name:"input",onChange:P,onKeyDown:M,className:(0,h.QP)("w-full resize-none bg-white dark:bg-white px-3 max-h-48 pr-12",o?"min-h-[52px] pb-[10px] pt-[15px] rounded-none border-0 border-t focus:ring-0 focus:border-t-slate-6":"min-h-[45px] py-[13px]","text-slate-800"),"data-testid":"lindy-messenger.input"}),(0,r.jsx)(z.G,{onClick:k,className:(0,h.QP)("absolute top-[10px] right-[7px] w-8 h-8 p-2 rounded hover:bg-slate-100 cursor-pointer",w.length?"fill-[#007AFF]":"fill-[#C1C8CD]","transition-all",o?"top-[10px]":"top-[7px]"),"data-testid":"lindy-messenger.send-button"})]})})]})}function I(e){let{messageEvent:t,agentDefinition:n,logoUrl:s,showIcon:i=!0}=e;return"message"!==t.type?null:"bot"===t.from?(0,r.jsx)(S,{message:t.message,agentDefinition:n,logoUrl:s,showIcon:i}):(0,r.jsx)(L,{message:t.message})}let D={a:e=>{let{node:t,...n}=e;return(0,r.jsx)("a",{...n,onClick:P.d,children:n.children})}};function S(e){var t,n;let{message:s,agentDefinition:i,logoUrl:l,showIcon:a=!0}=e;return(0,r.jsx)("div",{className:"flex w-full justify-start gap-2",children:(0,r.jsxs)("div",{className:"flex w-full gap-3",children:[(0,r.jsx)("div",{className:"flex size-6 shrink-0 items-center justify-center",children:a&&(l?(0,r.jsx)(E(),{alt:"".concat(i.name," logo"),src:l,className:"rounded object-cover",height:24,width:24}):(0,r.jsx)(N.l,{iconName:null===(t=i.icon)||void 0===t?void 0:t.name,color:null===(n=i.icon)||void 0===n?void 0:n.color,className:"shrink-0 border border-slate-4"}))}),(0,r.jsxs)("div",{className:"flex grow flex-col gap-1 overflow-hidden","data-testid":"lindy-messenger.agent-message",children:[(0,r.jsx)("div",{className:"flex flex-col",children:a&&(0,r.jsx)("div",{className:"mt-px font-medium",children:i.name})}),s?(0,r.jsx)(j.V,{className:"text-slate-800 [&_sup]:hidden",children:(0,r.jsx)(y.o,{disableCopyUI:!0,allowHTML:!1,components:D,children:s})}):(0,r.jsx)("div",{children:(0,r.jsx)(w.M,{className:"ml-1 mt-2 w-4"})})]})]})})}function L(e){let{message:t}=e;return(0,r.jsx)("div",{className:"flex w-full justify-start gap-2",children:(0,r.jsxs)("div",{className:"flex w-full gap-3",children:[(0,r.jsx)(T,{className:"shrink-0"}),(0,r.jsxs)("div",{className:"flex grow flex-col gap-1 overflow-hidden",children:[(0,r.jsx)("div",{className:"flex flex-col",children:(0,r.jsx)("div",{className:"mt-px font-medium",children:"You"})}),(0,r.jsx)(j.V,{className:"text-slate-800",children:(0,r.jsx)(y.o,{disableCopyUI:!0,isInput:!0,allowHTML:!1,children:t})})]})]})})}},67418:(e,t,n)=>{"use strict";n.d(t,{c:()=>r});let r=()=>-1!=(navigator.userAgent.indexOf("Opera")||navigator.userAgent.indexOf("OPR"))?"Opera":navigator.userAgent.includes("Edg")?"Edge":navigator.userAgent.includes("Chrome")?"Chrome":navigator.userAgent.includes("Safari")?"Safari":navigator.userAgent.includes("Firefox")?"Firefox":navigator.userAgent.includes("MSIE")||!0==!!document.DOCUMENT_NODE?"IE":"unknown"},3859:(e,t,n)=>{"use strict";n.d(t,{M:()=>a});var r=n(50612),s=n(25919),i=n(45895),l=n.n(i);function a(e){let{className:t}=e;return(0,r.jsxs)("svg",{viewBox:"0 0 16 4",overflow:"visible",xmlns:"http://www.w3.org/2000/svg",className:(0,s.QP)(l().wrapper,t),children:[(0,r.jsx)("circle",{cx:"2",cy:"2",r:"2",fill:"url(#paint0_linear_1933_50804)",className:l().a}),(0,r.jsx)("circle",{cx:"8",cy:"2",r:"2",fill:"url(#paint1_linear_1933_50804)",className:l().b}),(0,r.jsx)("circle",{cx:"14",cy:"2",r:"2",fill:"url(#paint2_linear_1933_50804)",className:l().c}),(0,r.jsxs)("defs",{children:[(0,r.jsxs)("linearGradient",{id:"paint0_linear_1933_50804",x1:"-0.153846",y1:"3.33333",x2:"4.00039",y2:"3.36489",gradientUnits:"userSpaceOnUse",children:[(0,r.jsx)("stop",{stopColor:"#5F6FFF"}),(0,r.jsx)("stop",{offset:"1",stopColor:"#1ED6FF"})]}),(0,r.jsxs)("linearGradient",{id:"paint1_linear_1933_50804",x1:"5.84615",y1:"3.33333",x2:"10.0004",y2:"3.36489",gradientUnits:"userSpaceOnUse",children:[(0,r.jsx)("stop",{stopColor:"#5F6FFF"}),(0,r.jsx)("stop",{offset:"1",stopColor:"#1ED6FF"})]}),(0,r.jsxs)("linearGradient",{id:"paint2_linear_1933_50804",x1:"11.8462",y1:"3.33333",x2:"16.0004",y2:"3.36489",gradientUnits:"userSpaceOnUse",children:[(0,r.jsx)("stop",{stopColor:"#5F6FFF"}),(0,r.jsx)("stop",{offset:"1",stopColor:"#1ED6FF"})]})]})]})}},56567:(e,t,n)=>{"use strict";n.d(t,{Q:()=>f});var r=n(50612),s=n(93505),i=n(73868),l=n(21937),a=n(67418),o=n(69507),c=n(67373),d=n(44646),u=n(33025),p=n(16008),m=n(35774),g=n(94344),h=n(25919);let f=(0,g.memo)(function(e){let{result:t,className:n,iconClassName:f}=e,[x,v]=(0,g.useState)("idle"),{isMobileOnly:y}=(0,o.Y0)(),w=(0,g.useCallback)(async()=>{let e="Safari"===(0,a.c)()&&y?t.replace(/:/g,""):t,n=await (0,s.V)(e),r=(0,l.l)(n,"\n\n"),o=(0,i.v)(n,{preserveWhitespace:!0});if(void 0!==window.ClipboardItem){let e=new ClipboardItem({"text/plain":new Blob([r],{type:"text/plain"}),"text/html":new Blob([o],{type:"text/html"})});await navigator.clipboard.write([e])}else await navigator.clipboard.writeText(r);v("copied")},[t,v,y]);return(0,g.useEffect)(()=>{if("copied"===x){let e=setTimeout(()=>{v("idle")},2e3);return()=>{clearTimeout(e)}}},[x]),(0,r.jsx)("div",{className:"flex",children:(0,r.jsx)(function(e){let{status:t}=e;switch(t){case"idle":return(0,r.jsx)(p.N,{children:(0,r.jsx)(m.P.div,{className:"group flex items-center justify-center",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},children:(0,r.jsx)(c.$,{size:"xs",level:"text",className:"group p-0.5 disabled:opacity-100",onClick:w,children:(0,r.jsx)("span",{className:(0,h.QP)(n),children:(0,r.jsx)(u.T,{className:(0,h.QP)("w-4 h-4 transition","stroke-slate-8 group-hover:stroke-slate-9",f)})})})})});case"copied":return(0,r.jsx)(p.N,{children:(0,r.jsx)(m.P.div,{className:"group flex items-center justify-center border-1 border-transparent px-0.5",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},children:(0,r.jsx)("span",{className:(0,h.QP)(n),children:(0,r.jsx)(d.S,{className:(0,h.QP)("size-4 transition fill-slate-7",f)})})})})}},{status:x})})})},76532:(e,t,n)=>{"use strict";n.d(t,{V:()=>o});var r=n(50612),s=n(94344),i=n(25919),l=n(34098),a=n.n(l);let o=(0,s.forwardRef)(function(e,t){let{children:n,className:s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.QP)("prose prose-slate max-w-none break-words","prose-pre:p-0 prose-pre:border prose-pre:border-slate-6 prose-pre:clear-both",a().prose,s),children:n})})},56779:(e,t,n)=>{"use strict";n.d(t,{l:()=>d,m:()=>u});var r=n(40907),s=n(31985),i=n(33241),l=n.n(i),a=n(72431),o=n(37120);function c(){return function(e){(0,o.YR)(e,function(e,t,n){"code"===e.tagName&&(n&&"pre"===n.tagName?e.properties.inline=!1:e.properties.inline=!0)})}}function d(){return[a.A]}function u(e){return[...e?[s.A]:[],r.A,c,[l(),function(e){return/^[a-z]+\.com/.test(e.pathname)?"https://".concat(e.pathname):e}]]}},25363:(e,t,n)=>{"use strict";n.d(t,{Q:()=>s});var r=n(33762);function s(e,t){(0,r.Es)(()=>{let t=e.current;if(!t)return;let n=t.offsetHeight-t.clientHeight;t.style.height="0px",t.style.height="".concat(t.scrollHeight+n,"px")},[e,...t])}},90719:(e,t,n)=>{"use strict";n.d(t,{es:()=>l,hb:()=>c,qR:()=>o});var r=n(38928),s=n(7094);let i=s.z.record(s.z.string().or(s.z.string().array())),l=s.z.object({origin:s.z.string().optional(),path:s.z.string().optional(),title:s.z.string().optional(),queryParams:i.optional()}),a=s.z.object({toolCallId:s.z.string().optional()}).optional(),o=s.z.discriminatedUnion("type",[s.z.object({type:s.z.literal("message"),timestamp:s.z.coerce.string(),metadata:a,from:s.z.enum(["user","bot"]),message:s.z.string(),locationData:l.optional(),queryParamContext:i.optional()}),s.z.object({type:s.z.literal("user_data"),timestamp:s.z.coerce.string(),metadata:a,id:s.z.string().optional(),name:s.z.string().optional(),email:s.z.string().optional(),additionalData:s.z.any().optional()})]);s.z.object({_id:r.k.objectIdString(),userDeviceId:s.z.string().optional(),messengerId:s.z.string().optional(),conversationId:r.k.objectIdString().optional(),agentDefinitionId:r.k.objectIdString().optional(),triggerId:r.k.objectIdString(),ownerId:r.k.objectIdString(),events:s.z.array(o),isClosed:s.z.boolean().optional()});let c="onLindyEmbedMessageReceived"},45801:(e,t,n)=>{"use strict";n.d(t,{Oc:()=>l,UU:()=>c,yE:()=>o});var r=n(50612),s=n(94344),i=n(25919);let l="scrollbar scrollbar-w-2 scrollbar-h-2 scrollbar-thumb-rounded-full scrollbar-thumb-slate-7 hover:scrollbar-thumb-slate-8",a=(0,s.createContext)({scrollableRef:(0,s.createRef)(),scrollToBottom:()=>{},scrollToTop:()=>{},isMobile:!1}),o=(0,s.forwardRef)(function(e,t){let{className:n,children:o,...c}=e,{isMobile:d}=(0,s.useContext)(a);return(0,r.jsx)("div",{className:(0,i.QP)(l,d&&"scrollbar-w-[4px]",n),...c,ref:t,children:o})});function c(e){let{children:t,isMobile:n=!1}=e,i=(0,s.useRef)(null),l=function(e){let{behavior:t="smooth"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i.current&&i.current.scrollTo({top:e,behavior:t})},o=(0,s.useMemo)(()=>({scrollToBottom:function(){var e,t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(null!==(t=null===(e=i.current)||void 0===e?void 0:e.scrollHeight)&&void 0!==t?t:0,n)},scrollToTop:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(0,e)},scrollableRef:i,isMobile:n}),[i,n]);return(0,r.jsx)(a.Provider,{value:o,children:t})}},44646:(e,t,n)=>{"use strict";n.d(t,{S:()=>s});var r=n(50612);let s=(0,n(94344).memo)(function(e){let{className:t}=e;return(0,r.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,r.jsx)("path",{className:t,fillRule:"evenodd",clipRule:"evenodd",d:"M16.707 5.293C16.8945 5.48053 16.9998 5.73484 16.9998 6C16.9998 6.26516 16.8945 6.51947 16.707 6.707L8.70698 14.707C8.51945 14.8945 8.26514 14.9998 7.99998 14.9998C7.73482 14.9998 7.48051 14.8945 7.29298 14.707L3.29298 10.707C3.11082 10.5184 3.01003 10.2658 3.01231 10.0036C3.01458 9.7414 3.11975 9.49059 3.30516 9.30518C3.49057 9.11977 3.74138 9.0146 4.00358 9.01233C4.26578 9.01005 4.51838 9.11084 4.70698 9.293L7.99998 12.586L15.293 5.293C15.4805 5.10553 15.7348 5.00021 16 5.00021C16.2651 5.00021 16.5195 5.10553 16.707 5.293Z",fill:"#111928"})})})},33025:(e,t,n)=>{"use strict";n.d(t,{T:()=>s});var r=n(50612);function s(e){let{className:t}=e;return(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"none",className:t,children:(0,r.jsx)("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"1.5",d:"M4.667 4.667V4c0-.933 0-1.4.181-1.757.16-.313.415-.568.729-.728.356-.182.823-.182 1.756-.182H12c.933 0 1.4 0 1.757.182.313.16.568.415.728.728.182.357.182.824.182 1.757v4.667c0 .933 0 1.4-.182 1.756-.16.314-.415.569-.728.729-.357.181-.824.181-1.757.181h-.667m0-4V12c0 .934 0 1.4-.181 1.757-.16.313-.415.568-.729.728-.356.182-.823.182-1.756.182H4c-.933 0-1.4 0-1.757-.182a1.667 1.667 0 0 1-.728-.728c-.182-.357-.182-.823-.182-1.757V7.333c0-.933 0-1.4.182-1.756.16-.314.415-.569.728-.729.357-.181.824-.181 1.757-.181h4.667c.933 0 1.4 0 1.756.181.314.16.569.415.729.729.181.356.181.823.181 1.756Z"})})}},99968:(e,t,n)=>{"use strict";n.d(t,{G:()=>s});var r=n(50612);let s=n(94344).memo(function(e){return(0,r.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,r.jsx)("path",{d:"M0.335828 2.64349C-0.130964 1.24312 1.31869 -0.0280325 2.64608 0.61772L14.7407 6.5016C15.9908 7.10975 15.9908 8.8909 14.7407 9.49905L2.64607 15.3829C1.31869 16.0287 -0.130962 14.7575 0.335828 13.3572L1.84371 8.8335H5.49987C5.9601 8.8335 6.3332 8.4604 6.3332 8.00016C6.3332 7.53993 5.9601 7.16683 5.49987 7.16683H1.84361L0.335828 2.64349Z"})})})},21069:(e,t,n)=>{"use strict";function r(e){var t;return .5>(e=>{let{r:t,g:n,b:r}=e;return(.299*t+.587*n+.114*r)/255})({r:parseInt((t=e).slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16)})?"#FFFFFF":"#11181c"}function s(e){return/^#([\dA-Fa-f]{6}|[\dA-Fa-f]{3})$/.test(e)}n.d(t,{Z:()=>s,s:()=>r})},99100:(e,t,n)=>{"use strict";function r(e){e.stopPropagation()}n.d(t,{d:()=>r})},71016:(e,t,n)=>{"use strict";n.d(t,{e2:()=>c,qY:()=>d});var r=n(90769),s=n(90719),i=n(91777),l=n(7094);let a=l.z.object({messengerId:l.z.string(),domains:l.z.string().array(),displayName:l.z.string(),accentColor:l.z.string(),promptStarters:l.z.string().array(),lindyEmbedPromptStarters:l.z.string().array().nullable().optional(),lindyEmbedConversationStarters:l.z.object({value:l.z.string(),isActive:l.z.boolean().optional(),id:l.z.string().optional()}).array().nullish(),lindyEmbedGreetingMessage:l.z.string().nullish(),logoUrl:l.z.string(),iconUrl:l.z.string(),darkMode:l.z.boolean(),positioning:l.z.discriminatedUnion("type",[l.z.object({type:l.z.literal("popup"),position:l.z.enum(["left","right"]),spacing:l.z.object({x:l.z.number(),y:l.z.number()}),iconShape:l.z.enum(["circle","rounded-rectangle"]),message:l.z.string().optional()}),l.z.object({type:l.z.literal("embedded")})])}),o=l.z.object({name:l.z.string(),description:l.z.string().nullish(),icon:r.e0.nullish(),greetingMessage:l.z.string().nullish()});function c(){return(0,i.gZ)()}let d=l.z.object({configuration:a,conversationEvents:s.qR.array().optional(),agentDefinition:o,isCreatorOfTrigger:l.z.boolean(),userDeviceId:l.z.string().optional(),hidePoweredByLindy:l.z.boolean().optional()})},45895:e=>{e.exports={wrapper:"agentLoadingAnimation_wrapper__X6cVI",enter:"agentLoadingAnimation_enter__938_Z",a:"agentLoadingAnimation_a__Zvnzx","up-down":"agentLoadingAnimation_up-down__yCffS",b:"agentLoadingAnimation_b__LYPEv",c:"agentLoadingAnimation_c__JTyb4"}},34098:e=>{e.exports={prose:"styledProse_prose___WBUl"}}}]);