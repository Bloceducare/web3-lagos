(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6020],{68317:(e,t,n)=>{"use strict";n.d(t,{e:()=>d});var a=n(52105),l=n(5862),i=n(34698),r=n(38928),s=n(7094);let o=(0,l._)({post:{body:s.z.object({conversationId:r.k.objectIdString(),blockToCancel:s.z.nativeEnum(i.Jl).optional()}),data:s.z.object({ok:s.z.literal(!0)})}}),d=(0,a.In)("POST","/api/agent/abortScript",o.post.data)},54931:(e,t,n)=>{"use strict";n.d(t,{F:()=>d});var a=n(52105),l=n(5862),i=n(34698),r=n(38928),s=n(7094);let o=(0,l._)({post:{body:s.z.object({conversationId:r.k.objectIdString(),actionExecutionId:s.z.string(),actionTraceId:s.z.string(),actionName:s.z.string(),invocationIndex:s.z.number(),inputSubmission:s.z.unknown(),modifiedFields:s.z.array(i.j$),codeBlockId:s.z.string().nullish(),toolCallId:s.z.string().nullish()}),data:s.z.object({ok:s.z.literal(!0)})}}),d=(0,a.In)("POST","/api/agent/actionInput",o.post.data)},98722:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var a=n(52105),l=n(5862),i=n(38928),r=n(7094);let s=(0,l._)({post:{body:r.z.object({conversationId:i.k.objectIdString(),messageId:i.k.objectIdString().optional(),input:r.z.string(),attachmentIds:i.k.objectIdString().array().optional(),isPrivate:r.z.boolean().optional(),ts:r.z.coerce.date().optional(),alwaysContinue:r.z.boolean().optional()}),data:r.z.object({conversationId:i.k.objectIdString(),messageId:i.k.objectIdString(),hasAlwaysContinue:r.z.boolean().optional()})}}),o=(0,a.In)("POST","/api/agent/continue",s.post.data)},83664:(e,t,n)=>{"use strict";n.d(t,{QT:()=>p});var a=n(52105),l=n(5862),i=n(38928),r=n(7094);let s=(0,l._)({get:{params:r.z.object({id:i.k.objectIdString()}),data:r.z.object({name:r.z.string(),id:r.z.string()})},patch:{params:r.z.object({id:i.k.objectIdString()}),body:r.z.object({name:r.z.string()}),data:r.z.object({ok:r.z.boolean()})}});var o=n(98354),d=n(94344),u=n(94559),c=n(79879);let m=(0,a.In)("GET","/api/identity/:id/user",s.get.data);function p(e){let t=(0,d.useMemo)(()=>["identity/[id]/user","get",e.params.id],[e.params.id]),n=(0,u.lB)(()=>null==e?void 0:e.options,[null==e?void 0:e.options]),a=(0,o.I)({queryKey:t,queryFn:async()=>{let{data:t,error:n}=await m(e);if(n)throw n;return t},...null==e?void 0:e.options}),l=(0,u.lB)(()=>a,[a]);return(0,c.R)(t,l,n)}},38400:(e,t,n)=>{"use strict";n.d(t,{w:()=>o});var a=n(5862),l=n(7461),i=n(13249),r=n(38928),s=n(7094);let o=(0,a._)({get:{params:s.z.object({id:r.k.objectIdString(),stateGraphId:r.k.objectIdString()}),data:l.tu.nullish()},patch:{params:s.z.object({id:r.k.objectIdString(),stateGraphId:r.k.objectIdString()}),body:l.tu.omit({_id:!0,agentDefinitionId:!0,owner:!0,version:!0}).partial(),data:s.z.object({stateGraph:l.tu.nullable(),issues:s.z.array(i.b0).optional()})}})},57459:(e,t,n)=>{"use strict";n.d(t,{T:()=>c});var a=n(50612),l=n(95158),i=n(64189),r=n(67373),s=n(66679),o=n(94344),d=n(25919),u=n(33762);let c=o.memo(function(e){let{text:t,className:n,title:c,useDefaultButtonText:m,children:p,...g}=e,[,h]=(0,u.Cj)(),[f,v]=(0,o.useState)(!1),x=(0,o.useCallback)(()=>{t&&!f&&(h(t),v(!0))},[h,t,v,f]);(0,o.useEffect)(()=>{if(!f)return;let e=setTimeout(()=>{v(!1)},2e3);return()=>clearTimeout(e)},[f]);let b=(null!=p?p:m)?f?"Copied":"Copy to clipboard":null;return(0,a.jsxs)(s.m_,{children:[(0,a.jsx)(s.ZI,{children:null!=c?c:"Copy to clipboard"}),(0,a.jsx)(s.k$,{asChild:!0,children:(0,a.jsx)(r.$,{className:(0,d.QP)("p-1 flex flex-row items-center justify-center",!b&&"w-9 h-9",n),level:"text",size:"sm",onClick:x,...g,children:(0,a.jsxs)("div",{className:"flex w-full items-center justify-center gap-2",children:[b,f?(0,a.jsx)(l.A,{className:"size-4"}):(0,a.jsx)(i.A,{className:"size-4"})]})})})]})})},57577:(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n(50612),l=n(94344),i=n(25919);let r=e=>{let{children:t,className:n}=e,r=(0,l.useRef)(null),[s,o]=(0,l.useState)(!1),[d,u]=(0,l.useState)(!0),c=(0,l.useCallback)(()=>{u(e=>!e)},[]);return(0,l.useEffect)(()=>{if(!r.current)return;let e=new ResizeObserver(e=>{let[t]=e;t&&o(t.target.scrollHeight>t.target.clientHeight)});return e.observe(r.current),()=>{e.disconnect()}},[]),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{ref:r,className:(0,i.QP)(n,d&&"line-clamp-2"),children:t}),d&&s&&(0,a.jsx)("button",{className:"text-xs text-blue-10 transition-colors hover:text-blue-11",onClick:c,children:"More"}),!d&&(0,a.jsx)("button",{className:"text-xs text-blue-10 transition-colors hover:text-blue-11",onClick:c,children:"Less"})]})}},11211:(e,t,n)=>{"use strict";n.d(t,{N:()=>r});var a=n(50612),l=n(57459),i=n(25919);function r(e){return(0,a.jsxs)(a.Fragment,{children:[!!e.label&&(0,a.jsx)("div",{className:"my-2 text-xs font-bold tracking-wide text-neutral-500 dark:text-neutral-400",children:e.label}),(0,a.jsxs)("pre",{className:(0,i.QP)("relative font-mono flex w-full items-start overflow-x-auto rounded-md border border-slate-4 bg-slate-1 p-2 text-xs text-neutral-800 dark:text-neutral-200",e.className),children:[(0,a.jsx)("code",{className:(0,i.QP)("flex min-h-[20px] grow items-center whitespace-pre-wrap font-[inherit]",e.codeClassName),children:e.children}),!!e.copyText&&(0,a.jsx)("div",{className:"grow-0",children:(0,a.jsx)(l.T,{className:"-m-2 ml-2 grow-0",text:e.copyText})})]})]})}},76916:(e,t,n)=>{"use strict";n.d(t,{$:()=>o});var a=n(50612),l=n(97746),i=n(40453),r=n(67434),s=n(94344);function o(e){var t;(0,s.useEffect)(()=>{e.error&&!e.doNotCapture&&r.Cp(e.error)},[e.doNotCapture,e.error]);let n=null!==(t=e.errorMessage)&&void 0!==t?t:e.error?(0,i.V4)(e.error):"An unknown error occurred";return(0,a.jsxs)("p",{className:"flex w-full items-baseline gap-1 rounded-lg bg-danger-2 p-4 text-sm text-danger-9",children:[(0,a.jsx)("div",{className:"flex h-4 w-5 items-center",children:(0,a.jsx)("div",{className:"h-5 w-5",children:(0,a.jsx)(l.A,{className:"h-5 w-5 translate-y-[4px]"})})}),(0,a.jsx)("div",{className:"font-semibold",children:"Error:"}),(0,a.jsx)("div",{className:"flex min-w-0 grow flex-col break-words",children:n})]})}},35769:(e,t,n)=>{"use strict";n.d(t,{g:()=>p});var a=n(50612),l=n(86383),i=n(67373),r=n(20335),s=n(10502),o=n(94344),d=n(25919);function u(e){return"string"==typeof e?e:e.value}function c(e){let{isValid:t,icon:n,tooltip:l,onClick:i}=e,r=(0,o.useCallback)(e=>{e.stopPropagation(),null==i||i()},[i]);return(0,a.jsxs)("div",{className:(0,d.QP)("group relative",t?"text-primary-11 hover:text-primary-9":"text-danger-11 hover:text-danger-9"),onClick:r,children:[n,!!l&&(0,a.jsx)("div",{className:"pointer-events-none absolute bottom-full left-1/2 mb-1 -translate-x-1/2 whitespace-nowrap rounded border border-slate-7 bg-white px-1 py-0.5 text-xs text-slate-12 opacity-0 transition-opacity group-hover:opacity-100 dark:bg-slate-3",children:l})]})}function m(e){let{disabled:t,validator:n,item:r,onRemove:s}=e,m=u(r),p="string"==typeof r?void 0:r.actions,g=(0,o.useMemo)(()=>!n||n(m),[n,m]),h=(0,o.useCallback)(()=>s(m),[s,m]),f=(0,o.useCallback)(e=>{"Backspace"===e.key&&s(m)},[s,m]),v=(0,a.jsxs)("div",{className:"-mx-1 flex items-center gap-0.5",children:[null==p?void 0:p.map((e,t)=>(0,a.jsx)(c,{isValid:g,...e},t)),(0,a.jsx)(c,{isValid:g,icon:(0,a.jsx)(l.A,{className:"w-4 text-white"}),tooltip:"Remove",onClick:h})]});return(0,a.jsx)(i.$,{size:"xs",level:"text",className:(0,d.QP)("disabled:opacity-100",t?"bg-slate-3 text-slate-12":g?"bg-primary-3 text-white hover:bg-primary-4 active:bg-primary-5 hover:border-primary-7 active:border-primary-7":"bg-danger-3 text-danger-11 hover:bg-danger-4 active:bg-danger-5 hover:border-danger-6 active:border-danger-7"),trailingIcon:t?void 0:v,disabled:t,onKeyDown:f,children:m})}let p=(0,o.memo)(function(e){let{id:t,className:n,disabled:l=!1,maxCount:i,validator:c,placeholder:p,items:g=[],onChange:h}=e,f=(0,o.useMemo)(()=>(0,s.A)(g,u),[g]),v=(0,o.useMemo)(()=>f.map(u),[f]),[x,b]=(0,o.useState)(""),y=null!=i&&v.length>=i,j=(0,o.useCallback)(e=>{null==h||h(v.filter(t=>t!==e))},[h,v]),k=(0,o.useCallback)(()=>{let e=x.trim();e&&h&&(h([...v.filter(e=>e!==x),e]),b(""))},[h,x,v]),N=(0,o.useCallback)(()=>{v.length>0&&(null==h||h(v.slice(0,-1)))},[h,v]),C=(0,o.useCallback)(e=>{y||b(e.target.value)},[y]),F=(0,o.useCallback)(e=>{"Enter"===e.key?(e.preventDefault(),k()):"Backspace"===e.key&&""===x&&(e.preventDefault(),N())},[k,x,N]),w=l&&v.length>0;return(0,a.jsxs)("div",{className:(0,d.QP)(r.jp,"flex flex-wrap items-center gap-x-1.5 gap-y-1 px-2 py-1",l&&"pointer-events-none",n),children:[f.map(e=>(0,a.jsx)(m,{disabled:l,validator:c,item:e,onRemove:j},u(e))),!w&&(0,a.jsx)("input",{id:t,className:"inline-block w-4 grow appearance-none bg-transparent py-[3px] text-sm text-slate-12 placeholder:text-slate-8 focus:w-24 focus:outline-none",disabled:l,placeholder:0===v.length?p:void 0,value:x,onChange:C,onKeyDown:F,onBlur:k})]})})},22525:(e,t,n)=>{"use strict";n.d(t,{e:()=>m});var a=n(50612),l=n(83476),i=n(90996),r=n(84785),s=n(35121),o=n(39388),d=n(20335),u=n(94344),c=n(25919);let m=(0,u.memo)(function(e){let{value:t,onSelect:n,onInputChange:m,options:p,inputName:g,inputIcon:h,placeholder:f,isFromModal:v,...x}=e,[b,y]=(0,u.useState)(""),j=(0,u.useMemo)(()=>""===b.trim()?p:p.filter(e=>e.value===t||e.label.toLowerCase().replace(/\s+/g,"").includes(b.toLowerCase().replace(/\s+/g,""))).sort((e,n)=>{let a=e.value===t||e.label.toLowerCase().startsWith(b.toLowerCase());return a===(n.value===t||n.label.toLowerCase().startsWith(b.toLowerCase()))?0:a?-1:1}),[p,b,t]),k=(0,u.useCallback)(e=>{var t,n;return null!==(n=null===(t=p.find(t=>t.value===e))||void 0===t?void 0:t.label)&&void 0!==n?n:""},[p]),N=(0,u.useCallback)(e=>{y(e.target.value),null==m||m(e.target.value),!t&&p.some(t=>t.value===e.target.value)&&(null==n||n(e.target.value))},[m,n,p,t]),C=(0,u.useCallback)(e=>null==n?void 0:n(e),[n]),F=(0,u.useCallback)(()=>y(""),[]),w=(0,u.useCallback)(e=>{let{active:t}=e;return(0,c.QP)("cursor-pointer flex items-center justify-between gap-3 px-4 py-2 text-sm text-slate-12 w-full",t&&"bg-slate-3 dark:bg-slate-5")},[]);return(0,a.jsx)(l.G3,{immediate:!0,value:t,onChange:C,...x,children:e=>{let{open:t}=e;return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("div",{className:"light:bg-white relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 flex items-center pl-2.5 text-slate-11",children:h||(0,a.jsx)(r.A,{className:"h-4 w-4"})}),(0,a.jsx)(l.G3.Input,{name:g,onBlur:F,className:(0,c.QP)(d.jp,"pl-8 pr-8 bg-white dark:bg-slate-1"),displayValue:k,onChange:N,placeholder:f,autoComplete:"off"}),(0,a.jsx)(l.G3.Button,{className:"absolute inset-y-0 right-0 flex items-center pr-2",children:(0,a.jsx)(s.z,{direction:t?"up":"down",className:(0,c.QP)("size-5 text-slate-11 transition-transform"),"aria-hidden":"true",stroke:2})})]}),(0,a.jsx)(i.e,{as:u.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",afterLeave:F,children:(0,a.jsx)(l.G3.Options,{className:(0,c.QP)("fixed right-0 z-50 mt-2.5 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-slate-12/5 focus:outline-none sm:text-sm dark:bg-slate-1",!v&&"absolute"),children:0===j.length&&""!==b?(0,a.jsx)("div",{className:"relative cursor-default select-none px-4 py-2 text-slate-12",children:"Nothing found."}):j.map(e=>(0,a.jsx)(l.G3.Option,{className:w,value:e.value,children:t=>{let{selected:n}=t;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"truncate pl-4",children:e.label}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[e.postLabel&&(0,a.jsx)("div",{className:"text-slate-10",children:e.postLabel}),(0,a.jsx)("div",{className:"w-4",children:n?(0,a.jsx)(o.v,{}):null})]})]})}},e.label+e.value))})})]})}})})},70732:(e,t,n)=>{"use strict";n.d(t,{d:()=>s});var a=n(50612),l=n(10206),i=n(94344),r=n(25919);let s=(0,i.memo)((0,i.forwardRef)(function(e,t){let{id:n,className:i,disabled:s,checked:o,onChange:d,autoLabelEntity:u,title:c}=e;return(0,a.jsxs)(l.dO,{id:n,checked:o,onChange:d,className:(0,r.QP)("focus:outline-none","relative inline-flex h-4 w-8 flex-shrink-0 rounded-full border-2 border-transparent","transition duration-200 ease-in-out","focus-visible:ring-2 ring-primary-8 ring-offset-2 ring-offset-slate-1",s&&"opacity-50 cursor-not-allowed",o&&!s&&"active:bg-primary-11",!o&&!s&&"active:bg-slate-8",o?"bg-primary-9 hover:bg-primary-10":"bg-slate-6 hover:bg-slate-7",i),disabled:s,ref:t,title:c,children:[(0,a.jsx)("span",{className:"sr-only",children:u?"Switch ".concat(u," ").concat(o?"off":"on"):"switch on/off"}),(0,a.jsx)("span",{"aria-hidden":"true",className:(0,r.QP)("pointer-events-none inline-block h-3 w-3 rounded-full bg-white shadow ring-0","transition duration-200 ease-in-out",o?"translate-x-4":"translate-x-0")})]})}))},18218:(e,t,n)=>{"use strict";n.d(t,{X:()=>s});var a=n(50612),l=n(41285),i=n(94344),r=n(6762);let s=(0,i.memo)((0,i.forwardRef)(function(e,t){let{label:n,id:i,className:s,textAreaClassName:o,labelClassName:d,...u}=e;return(0,a.jsxs)("div",{className:s,children:[(0,a.jsx)(l.J,{htmlFor:i,className:d,children:n}),(0,a.jsx)(r.f,{ref:t,id:i,className:o,...u})]})}))},35940:(e,t,n)=>{"use strict";n.d(t,{F:()=>b});var a=n(50612),l=n(14144),i=n(83476),r=n(97881),s=n(61264),o=n(57577),d=n(42717),u=n(22283),c=n(69507),m=n(35121),p=n(20335),g=n(41285),h=n(45801),f=n(94344),v=n(25919);let x=(0,f.forwardRef)(function(e,t){let{children:n,fetchMoreOptions:l,hasMoreData:i,isFetchingMore:r,...s}=e,o=(0,f.useRef)(null);(0,f.useImperativeHandle)(t,()=>o.current,[]);let d=(0,f.useCallback)(e=>{e.currentTarget.scrollHeight-e.currentTarget.scrollTop-e.currentTarget.clientHeight<300&&!r&&i&&l()},[l,i,r]);return(0,f.useEffect)(()=>{!r&&i&&o.current&&o.current.scrollHeight<o.current.clientHeight+300&&l()},[l,i,r]),(0,a.jsx)(h.yE,{ref:o,...s,onScroll:d,children:n})}),b=(0,f.memo)(function(e){let{disabled:t,label:n,description:h,value:b,onChange:y,options:j,displayValue:k,isOptionDisabled:N,isOptionDisplayOnly:C,renderOption:F,fetchMoreOptions:w,isFetchingMore:T,hasMoreData:S,by:I,onSearchChange:_,className:z,labelClassName:L,autoFocus:A,...D}=e,{isMobileOnly:E}=(0,c.Y0)(),M=T?r.A:s.A,K=(0,f.useRef)(null),R=(0,f.useCallback)(()=>{null==_||_("")},[_]),P=(0,f.useCallback)(e=>{null==_||_(e.target.value)},[_]),O=(0,f.useMemo)(()=>({options:j,disabled:N}),[j,N]),q=(0,f.useCallback)(e=>{y(e),null!==e&&setTimeout(()=>{var e;null===(e=K.current)||void 0===e||e.blur()},0)},[y]);return(0,f.useEffect)(()=>{if(A){let e=setTimeout(()=>{var e;null===(e=K.current)||void 0===e||e.focus({preventScroll:!0})});return()=>clearTimeout(e)}},[A]),(0,a.jsxs)(l.D,{children:[n?(0,a.jsxs)("div",{className:"mb-1.5",children:[(0,a.jsx)(g.J,{shouldUseHeadless:!0,className:L,children:n}),!!h&&(0,a.jsx)(o.a,{className:"text-xs font-medium text-slate-9",children:(0,a.jsx)(u.o,{className:"[&_a:hover]:no-underline [&_a]:underline",allowHTML:!1,disableCopyUI:!0,isInput:!1,children:h})})]}):null,(0,a.jsx)(i.G3,{immediate:!0,by:I,value:b,disabled:t,virtual:O,onChange:q,onClose:R,children:e=>{let{open:n}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:(0,v.QP)("relative group",t&&"cursor-not-allowed",z),...D,children:[(0,a.jsx)("div",{className:"group absolute inset-y-0 left-0 flex flex-row items-center justify-between",children:!!n&&(0,a.jsx)(M,{className:(0,v.QP)("size-5 ml-2 text-slate-9 group-data-[hover]:text-slate-11",T&&"animate-spin")})}),(0,a.jsx)(i.oK,{ref:K,className:(0,v.QP)(p.jp,"pl-4 pr-9 text-sm py-2",!n&&"cursor-pointer",!n&&!b&&"text-slate-9",n&&"pl-9",!t&&"data-[hover]:bg-slate-4",t&&"bg-slate-2 text-slate-9"),disabled:t,"aria-label":"Assignee",displayValue:n&&!b?void 0:k,onChange:P}),(0,a.jsx)(i.i7,{className:"group absolute inset-y-0 right-0 z-5 flex flex-row items-center justify-between",children:(0,a.jsx)(m.z,{direction:n?"up":"down",className:(0,v.QP)("size-5 text-slate-11 transition-transform group-data-[hover]:text-slate-11/60","ml-auto mr-[16.8px]")})})]}),(0,a.jsx)(i.Kc,{anchor:"bottom",className:(0,v.QP)(d.xu,"w-[var(--input-width)] empty:invisible mt-1 max-h-36","[--anchor-max-height:theme(spacing.96)]"),as:x,fetchMoreOptions:w,hasMoreData:S,isFetchingMore:T,children:e=>{let{option:t}=e;return(null==C?void 0:C(t))?(0,a.jsx)("div",{tabIndex:0,className:"flex items-center gap-3 p-2 px-2.5 text-sm text-slate-12",children:F(t)}):(0,a.jsx)(i.jO,{value:t,className:(0,v.QP)("group w-full rounded-md select-none cursor-pointer","data-[disabled]:opacity-50 data-[disabled]:cursor-not-allowed","py-2 px-[9px]","flex items-center gap-3 p-2 px-2.5 text-sm text-slate-12",!E&&"data-[focus]:bg-slate-4 data-[focus]:dark:bg-slate-5",E&&"data-[focus]:opacity-50",E&&"text-[17px] px-3.5"),children:F(t)})}})]})}})]})})},78629:(e,t,n)=>{"use strict";n.d(t,{ch:()=>o,cq:()=>s});var a=n(50612),l=n(22283),i=n(33296),r=n(94344);function s(e){let{isInput:t,children:n}=e,s=(0,r.useMemo)(()=>o(n),[n]);return(0,a.jsx)("div",{"data-testid":"transcript-markdown",children:(0,a.jsx)(l.o,{className:"[&_sup]:mr-1 [&_sup]:text-xxs [&_sup]:font-medium [&_sup]:text-blue-9",components:t?i.RD:i.l3,isInput:t,allowHTML:!1,children:s})})}function o(e){let t="",n=!1;for(let l of e.split("\n")){var a;l.startsWith("```")&&(n=!n);let e=null!==(a=l[0])&&void 0!==a?a:"";n||["*","-",">","`","#","|"].includes(e)||(t+="\n"),t+=l+"\n"}return t}},46945:(e,t,n)=>{"use strict";n.d(t,{L:()=>z});var a=n(50612),l=n(78629),i=n(20292),r=n(10293),s=n(67373),o=n(35121),d=n(20335),u=n(76804),c=n(16008),m=n(35774),p=n(94344),g=n(25919),h=n(30589),f=n(79671),v=n(31634),x=n(85680),b=n(90819),y=n(52105),j=n(89073);let k={opacity:1},N={opacity:0},C={duration:.5},F=e=>{let{visible:t}=e,[n,l]=(0,p.useState)(!1),[i,r]=(0,p.useState)(!0),[o,d]=(0,p.useState)(!0),u=(0,b.T)(),g=(0,x.aV)(),F=(0,j.jE)(),w=(0,p.useCallback)(async()=>{if(u)try{await (0,y.oA)((0,f.c)({params:{id:u},body:{askForConfirmation:!1}})),l(!0),setTimeout(()=>r(!1),3e3),F.setQueryData((0,h.ZF)({params:{id:u}}),e=>{if(e)return{...e,askForConfirmation:!1}})}catch(e){g({level:"danger",label:"Error",message:"Failed to disable safe mode.",duration:3e3})}},[u,g,F]);return((0,p.useEffect)(()=>{t?d(!1):setTimeout(()=>{d(!0)},3e3)},[t]),!i||o)?null:(0,a.jsx)(c.N,{children:i&&(0,a.jsx)(m.P.div,{initial:k,exit:N,transition:C,children:(0,a.jsxs)(v.f,{className:"bottom-0 -m-3 mt-3 rounded-b-xl bg-yellow-3 px-3 py-1.5 text-xs text-slate-12",between:!0,children:[(0,a.jsx)("span",{children:n?"Safe mode has been disabled.":"Safe mode is enabled. Disable to automatically confirm actions like this one."}),(0,a.jsx)(s.$,{onClick:w,level:"text",className:"shrink-0 px-2 py-0.5",size:"xs",disabled:n,children:n?"Disabled":"Disable"})]})})})};function w(e){let{children:t}=e;return(0,a.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:t})}function T(e){let{status:t}=e;switch(t){case"none":return null;case"loading":return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(w,{children:(0,a.jsx)("rect",{x:"1.25",y:"1.25",width:"11.5",height:"11.5",rx:"5.75",stroke:"white",strokeWidth:"1.5",fill:"white"})}),(0,a.jsx)(u.y,{className:"absolute left-1/2 top-1/2 w-2.5 -translate-x-1/2 -translate-y-1/2"})]});case"success":return(0,a.jsxs)(w,{children:[(0,a.jsx)("rect",{x:"1.25",y:"1.25",width:"11.5",height:"11.5",rx:"5.75",fill:"#0CCA6E"}),(0,a.jsx)("path",{d:"M4.5 7.25L6 8.75L9.5 5.25",stroke:"white",strokeLinecap:"round",strokeLinejoin:"round"}),(0,a.jsx)("rect",{x:"1.25",y:"1.25",width:"11.5",height:"11.5",rx:"5.75",stroke:"white",strokeWidth:"1.5"})]});case"reverted":return(0,a.jsxs)(w,{children:[(0,a.jsx)("rect",{x:"1.25",y:"1.25",width:"11.5",height:"11.5",rx:"5.75",fill:"#03A0FF"}),(0,a.jsx)("g",{clipPath:"url(#clip0_330_3907)",children:(0,a.jsx)("path",{d:"M5.21039 4.85852L4.23036 5.83855C4.11413 5.95478 4.11413 6.14322 4.23036 6.25945L5.21039 7.23947M4.46634 6.049H8.33539C8.99287 6.049 9.52586 6.58199 9.52586 7.23947V7.53709C9.52586 8.19457 8.99287 8.72757 8.33539 8.72757H6.84729",stroke:"white",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,a.jsx)("rect",{x:"1.25",y:"1.25",width:"11.5",height:"11.5",rx:"5.75",stroke:"white",strokeWidth:"1.5"}),(0,a.jsx)("defs",{children:(0,a.jsx)("clipPath",{id:"clip0_330_3907",children:(0,a.jsx)("rect",{width:"7.14286",height:"7.14286",fill:"white",transform:"translate(3.42859 3.42859)"})})})]});case"canceled":return(0,a.jsxs)(w,{children:[(0,a.jsx)("rect",{x:"1.25",y:"1.25",width:"11.5",height:"11.5",rx:"5.75",fill:"#889096"}),(0,a.jsx)("circle",{cx:"7",cy:"7",r:"3",fill:"white"}),(0,a.jsx)("rect",{x:"1.25",y:"1.25",width:"11.5",height:"11.5",rx:"5.75",stroke:"white",strokeWidth:"1.5"})]});case"error":return(0,a.jsxs)(w,{children:[(0,a.jsx)("rect",{x:"1.25",y:"1.25",width:"11.5",height:"11.5",rx:"5.75",fill:"#E54D2E"}),(0,a.jsx)("circle",{cx:"7",cy:"7",r:"3",fill:"white"}),(0,a.jsx)("rect",{x:"1.25",y:"1.25",width:"11.5",height:"11.5",rx:"5.75",stroke:"white",strokeWidth:"1.5"})]});case"notification":return(0,a.jsxs)(w,{children:[(0,a.jsx)("rect",{x:"1.25",y:"1.25",width:"11.5",height:"11.5",rx:"5.75",fill:"white"}),(0,a.jsx)("circle",{cx:"7",cy:"7",r:"4",fill:"#E54D2E"}),(0,a.jsx)("rect",{x:"1.25",y:"1.25",width:"11.5",height:"11.5",rx:"5.75",stroke:"white",strokeWidth:"1.5"})]})}}let S={initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8}};function I(e){let{show:t,cancelIntervalMs:n,onClick:l,isLoading:i,children:r}=e,o=(0,p.useMemo)(()=>n?{initial:{x:"-100%"},animate:{x:0},transition:{ease:"linear",duration:n/1e3}}:null,[n]);return(0,a.jsx)(c.N,{children:t&&(0,a.jsxs)(m.P.div,{className:"relative overflow-hidden rounded-md",initial:S.initial,animate:S.animate,exit:S.exit,children:[(0,a.jsx)(s.$,{level:"outline",size:"sm",className:"block",onClick:l,isLoading:i,children:r}),o&&(0,a.jsx)(m.P.div,{className:"pointer-events-none absolute inset-0 bg-slate-9 opacity-30",initial:o.initial,animate:o.animate,transition:o.transition})]})})}let _={type:"tween",duration:.15,ease:"easeOut"},z=(0,p.memo)(function(e){let{title:t,subtitle:n,icon:u,status:c="none",titleIsEditable:h=!1,titlePlaceholder:f,onTitleChange:v,hideSubtitleWhenOpen:x=!1,showCancelButton:b=!1,cancelIntervalMs:y,onCancel:j,showSkipButton:k=!1,isSkipping:N=!1,onSkip:C,onOpen:w,children:S,startExpanded:z=!1,expandable:L=!0,autoToggleOnStatusChange:A=!0,customTitle:D,hasSideEffects:E=!1,hasUserInput:M=!1}=e,[K,R]=(0,p.useState)(z),{data:P}=(0,r.f)();(0,p.useEffect)(()=>{K&&(null==w||w())},[w,K]);let O=h&&K,q="none"===c&&M&&K,B=(0,p.useCallback)(e=>{e.stopPropagation(),R(e=>!e)},[]),Q=(0,p.useCallback)(()=>{R(!0)},[]),V=(0,p.useCallback)(e=>{O&&e.stopPropagation()},[O]),U=(0,p.useCallback)(e=>{e.stopPropagation(),null==j||j()},[j]),H=(0,p.useCallback)(e=>{e.stopPropagation(),null==C||C()},[C]);(0,p.useEffect)(()=>{A&&("loading"===c||"success"===c||"canceled"===c||"error"===c?R(!1):"none"===c&&R(!0))},[A,c]);let G=!!n&&!(x&&K),[Y,W]=(0,p.useState)(n);(0,p.useEffect)(()=>{G&&W(n)},[G,n]);let $=null!=S,Z=L&&!b&&!q&&$,J=Z&&!K&&!q;return(0,a.jsxs)(i.Z,{className:J?"cursor-pointer":void 0,onClick:J?B:void 0,children:[(0,a.jsxs)("div",{className:(0,g.QP)("flex items-center gap-2",Z&&"cursor-pointer"),onClick:Z?B:void 0,children:[u&&(0,a.jsxs)("div",{className:"relative mt-1.5 self-baseline",children:[(0,a.jsx)("div",{className:"overflow-hidden rounded-md shadow",children:u}),(0,a.jsx)(m.P.div,{className:"absolute -bottom-0.5 -right-1",initial:{scale:0},animate:{scale:1},transition:_,children:(0,a.jsx)(T,{status:c})},c)]}),(0,a.jsxs)("div",{className:"flex-1",children:[null!=D?D:O?(0,a.jsx)(d.pd,{className:"border-transparent bg-white px-1.5 py-1 text-sm font-medium text-slate-12 shadow-none disabled:bg-green-5 disabled:text-slate-12 dark:bg-slate-3 disabled:dark:bg-slate-3",placeholder:f,value:t,onChange:v,onFocus:Q,onClick:V}):(0,a.jsx)("p",{className:"py-1 pl-[7px] pr-1.5 text-sm font-medium text-slate-12",children:t}),(0,a.jsx)(m.P.div,{transition:_,animate:{height:G?"auto":0,opacity:G?1:0,pointerEvents:G?"auto":"none"},children:(0,a.jsx)("p",{className:(0,g.QP)("text-xs ml-[7px] mb-1 transition-all whitespace-normal break-words",O?"mt-0.5":"-mt-0.5","success"===c?"text-success-11":"error"===c?"text-danger-11":"text-slate-11"),children:(0,a.jsx)(l.cq,{isInput:!1,children:null!=Y?Y:""})})})]}),(0,a.jsx)(I,{show:b,cancelIntervalMs:y,onClick:U,children:"Cancel"}),(0,a.jsx)(I,{show:k,onClick:H,isLoading:N,children:"Skip"}),L&&!q&&$&&(0,a.jsx)(s.$,{level:"text",size:"xs",className:"p-0",onClick:B,children:(0,a.jsx)(o.z,{direction:K?"up":"down",stroke:2,className:(0,g.QP)("size-6 text-slate-12 transition-transform")})})]}),$&&(0,a.jsx)(m.P.div,{initial:z?"open":"closed",animate:K?"open":"closed",variants:{open:{height:"auto",overflow:"visible",transition:{..._,when:"beforeChildren"}},closed:{height:0,overflow:"hidden",transition:_}},children:(0,a.jsxs)(m.P.div,{variants:{open:{opacity:1,y:0},closed:{opacity:0,y:5}},transition:_,children:[S,(0,a.jsx)(F,{visible:!!(null==P?void 0:P.askForConfirmation)&&E})]})})]})})},6978:(e,t,n)=>{"use strict";n.d(t,{i:()=>r});var a=n(50612),l=n(40985),i=n(94344);let r=(0,i.memo)(function(e){let{value:t,onChange:n,...r}=e,s=(0,i.useCallback)(e=>null==e||isNaN(e)?"":String(e),[]),[o,d]=(0,i.useState)(s(t));(0,i.useEffect)(()=>{d(s(t))},[s,t]);let u=(0,i.useCallback)(()=>{let e=parseInt(o);n&&n(isNaN(e)?void 0:e),d(s(t))},[n,o,s,t]);return(0,a.jsx)(l.R,{...r,value:o,onChange:d,onBlur:u})})},65832:(e,t,n)=>{"use strict";n.d(t,{G:()=>x});var a=n(50612),l=n(77715),i=n(11211),r=n(76916),s=n(41285),o=n(72352),d=n(53532),u=n(94344),c=n(18218),m=n(6978),p=n(25363),g=n(40985),h=n(25919);function f(e){let{data:t,onChange:n,basePath:r}=e,d=(0,u.useMemo)(()=>n?(e,t)=>{n(void 0!==r?"".concat(r,".").concat(e):e,t)}:void 0,[r,n]);if((0,o.OW)(t)){let e=Object.keys(t).map(e=>{let n=(0,o.OW)(t[e])?t[e]:(0,o.qJ)(t[e]);return{key:e,label:(0,o.ku)(e),type:(0,o.OW)(n)?"json":"number"==typeof n?"number":"string"==typeof n?"textarea":null,initialValue:n}});return(0,a.jsx)("form",{className:"space-y-4",children:e.map(e=>{let t=e.initialValue;switch(e.type){case"textarea":return(0,a.jsx)(v,{label:e.label,path:e.key,value:String(t),onChange:d},e.key);case"number":return(0,a.jsx)(m.i,{label:e.label,id:e.key,value:Number(t),labelClassName:"text-slate-11",inputClassName:"font-light p-2 text-sm readonly"},e.key);case"json":return(0,a.jsxs)("div",{children:[(0,a.jsx)(s.J,{className:"text-sm text-slate-11",htmlFor:e.key,children:e.label}),(0,a.jsx)(i.N,{children:(0,a.jsx)(l.n,{src:e.initialValue})})]},e.key);default:return null}})})}return(0,a.jsx)("div",{className:"overflow-hidden overflow-x-auto font-mono text-xs text-neutral-800 dark:text-neutral-100",children:(0,a.jsx)(g.R,{label:"Input",id:(0,o.qJ)(t),type:"textarea",value:(0,o.qJ)(t),labelClassName:"text-slate-11",inputClassName:"font-light p-2 text-sm readonly"})})}function v(e){let{label:t,path:n,value:l,onChange:i}=e,r=(0,u.useRef)(null),s=(0,u.useCallback)(e=>{null==i||i(n,e)},[i,n]);return(0,p.Q)(r,[l]),(0,a.jsx)(c.X,{label:t,id:n,ref:r,value:l,onChange:s,labelClassName:"text-slate-11",textAreaClassName:(0,h.QP)("font-light p-2 text-sm resize-none",!i&&"focus:border-1 focus:border-slate-4 focus:ring-0 focus:hover:border-slate-4")})}function x(e){let{input:t,onInputChange:n,output:c,error:m,disabled:p}=e,g=(0,u.useMemo)(()=>n&&!p?(e,a)=>{let l=Array.isArray(t)?[...t]:"object"==typeof t?{...t}:void 0;l&&((0,d.A)(l,e,a),n(l))}:void 0,[t,p,n]),h=t&&("object"!=typeof t||Object.keys(t).length>0);return(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[!!h&&(0,a.jsxs)("div",{children:[(0,a.jsx)(s.J,{children:"Input"}),Array.isArray(t)?t.map((e,t)=>(0,a.jsx)(f,{data:(0,o.YO)((0,o.aE)(e)),onChange:g,basePath:t.toString()},t)):(0,a.jsx)(f,{data:(0,o.YO)((0,o.aE)(t)),onChange:g})]}),!!c&&(0,a.jsxs)("div",{children:[(0,a.jsx)(s.J,{children:"Result"}),(0,a.jsx)(i.N,{children:(0,a.jsx)(l.n,{src:(0,o.aE)(c)})})]}),!!m&&(0,a.jsx)("div",{children:(0,a.jsx)(r.$,{error:m,doNotCapture:!0})})]})}},95277:(e,t,n)=>{"use strict";n.d(t,{Cp:()=>nC});var a=n(50612);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ActionTraceCard_Identity",selections:[{args:null,kind:"FragmentSpread",name:"AgentUi_Identity"}],type:"Identity",abstractKey:null};l.hash="e92e1e0a724ed5572238dcb6a8bd2454";let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ActionTraceCard_AgentDefinition",selections:[{args:null,kind:"FragmentSpread",name:"AgentUi_AgentDefinition"}],type:"AgentDefinition",abstractKey:null};i.hash="98d818d5a8dc372c5e08b2afc1b916b0";var r=n(46945);let s={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"AgentUi_Identity",selections:[{args:null,kind:"FragmentSpread",name:"FormBuilder_Identity"}],type:"Identity",abstractKey:null};s.hash="5ec1dab27c69ef9058da384b124b39ed";let o={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"AgentUi_AgentDefinition",selections:[{args:null,kind:"FragmentSpread",name:"FormBuilder_AgentDefinition"}],type:"AgentDefinition",abstractKey:null};o.hash="1055296a828fa1bfbb9f2180124a944e";var d=n(94344),u=n(79124);let c=(0,d.memo)(function(e){let{data:t}=e;return(0,a.jsx)("pre",{children:JSON.stringify(t,null,2)})});var m=n(35769),p=n(6762),g=n(958),h=n(25363),f=n(68317),v=n(54931),x=n(98722),b=n(52105),y=n(5862),j=n(27273),k=n(38928),N=n(7094);let C=(0,y._)({get:{params:N.z.object({id:k.k.objectIdString(),traceid:k.k.objectIdString()}),data:j.PJ},patch:{params:N.z.object({id:k.k.objectIdString(),traceid:k.k.objectIdString()}),body:N.z.object({canceled:N.z.boolean().optional()}),data:j.PJ}}),F=(0,b.In)("PATCH","/api/executionDetails/:id/trace/:traceid",C.patch.data);var w=n(39704);function T(e){let{conversationId:t,sourceAction:n,disableInteraction:a,customStatus:l,cancelIntervalMs:i}=e,[r,s]=(0,d.useState)("collecting-input"),[o,u]=(0,d.useState)(null),c=(0,d.useRef)(null);(0,d.useEffect)(()=>{"collecting-input"!==r&&u(null)},[r]),(0,d.useEffect)(()=>{let e=function(e){switch(e){case"success":return"submitted";case"canceled":case"error":return"canceled";case"loading":return"submitting";default:return null}}(l);s(null!=e?e:"collecting-input")},[l]);let m=(0,d.useCallback)(async(e,a)=>{var l,i;if(!t||!n)return;let r=null!==(l=n.codeBlockId)&&void 0!==l?l:void 0,o=null!==(i=n.toolCallId)&&void 0!==i?i:void 0;s("submitting");let d=await (0,v.F)({body:{conversationId:t,actionExecutionId:n.executionId,actionTraceId:n.traceId,actionName:n.actionName,invocationIndex:n.invocationIndex,inputSubmission:e,modifiedFields:a,toolCallId:o,codeBlockId:r}});if(d.error){u(d.error.message),s("collecting-input");return}s("submitted"),c.current&&(clearTimeout(c.current),c.current=null)},[t,n]),p=(0,d.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];null!=i?(c.current&&clearTimeout(c.current),c.current=setTimeout(async()=>{await m(e,t)},i),s("submit-pending")):await m(e,t)},[i,m]);return{submitState:r,disabled:a||"collecting-input"!==r,submitForm:p,cancelForm:(0,d.useCallback)(async()=>{if(t){s("canceled"),c.current&&(clearTimeout(c.current),c.current=null);try{n?(await F({params:{id:n.executionId,traceid:n.traceId},body:{canceled:!0}}),await (0,f.e)({body:{conversationId:t}})):await (0,x.A)({body:{conversationId:t,input:"The user canceled the form submission."}})}catch(e){s("collecting-input"),u("Something went wrong. Please try again.")}}},[t,n]),cancelPendingSubmit:(0,d.useCallback)(()=>{s("collecting-input")},[]),fieldErrorMessage:o,setFieldErrorMessage:u,computeFormDeltas:(0,d.useCallback)((e,t)=>{let n=[];for(let a in t)(0,w.A)(e[a],t[a])||n.push({key:a,originalValue:e[a]});return n},[])}}var S=n(67373),I=n(46251),_=n(23664),z=n(25919),L=n(32159),A=n(18218),D=n(40985),E=n(41285),M=n(6978);function K(e,t,n){if(e)return e;if("collecting-input"===t&&n)return"error";switch(t){case"collecting-input":return"none";case"submit-pending":case"submitting":case"submitted":return"loading";case"canceled":return"canceled"}}function R(e,t){if(null==t)return"This field is required";switch(e.type){case"text":case"textarea":case"dropdown":return 0===String(t).length?"This field is required":null;case"number":return isNaN(Number(t))?"This field must be a number":null}}let P=(0,d.memo)(function(e){let{formField:t,disabled:n,curValue:l,setFormValues:i}=e,r=(0,d.useCallback)(e=>{i(n=>({...n,[t.id]:e}))},[t.id,i]);switch(t.type){case"text":return(0,a.jsx)(D.R,{label:t.label,id:t.id,type:"text",disabled:n,value:String(null!=l?l:""),onChange:r});case"textarea":return(0,a.jsx)(A.X,{label:t.label,id:t.id,readOnly:n,value:String(null!=l?l:""),onChange:r,textAreaClassName:(0,z.QP)("h-48 ",n&&"bg-slate-2 text-slate-9")});case"number":return(0,a.jsx)(M.i,{label:t.label,id:t.id,disabled:n,value:Number(l),onChange:r});case"dropdown":return(0,a.jsxs)("div",{children:[(0,a.jsx)(E.J,{htmlFor:t.id,children:t.label}),(0,a.jsx)(L.m,{menuPosition:"top",options:t.options,disabled:n,value:String(null!=l?l:""),onChange:r})]})}}),O=(0,d.memo)(function(e){var t;let{conversationId:n,data:l,sourceAction:i,disableInteraction:s,customStatus:o,autoToggleOnStatusChange:u,customError:c}=e,m=(0,d.useMemo)(()=>Object.fromEntries(l.formFields.map(e=>[e.id,e.initialValue])),[l]),[p,g]=(0,d.useState)(m);(0,d.useEffect)(()=>{g(m)},[m]);let{submitState:h,disabled:f,submitForm:v,cancelForm:x,fieldErrorMessage:b,setFieldErrorMessage:y}=T({conversationId:n,sourceAction:i,disableInteraction:s,customStatus:o}),j=(0,d.useCallback)(async e=>{e.preventDefault(),l.formFields.some(e=>null!=R(e,p[e.id]))?y("Please fix the form errors"):await v({...l.passThrough,...p})},[l.formFields,l.passThrough,p,y,v]),k=!!b;return(0,a.jsx)(r.L,{title:l.title,subtitle:function(e,t,n,a){switch(e){case"success":return"Action submitted successfully";case"error":return null!=a?a:"Error executing action";case"canceled":return"Action canceled";default:if("collecting-input"===t&&n)return n}if("canceled"===t)return"Action canceled"}(o,h,b,c),icon:(0,a.jsx)(I.si,{tool:null!==(t=l.tool)&&void 0!==t?t:_.h6.Lindy,className:"h-5 w-5"}),status:K(o,h,b),autoToggleOnStatusChange:u,hasUserInput:!0,children:(0,a.jsxs)("form",{className:"space-y-4",onSubmit:j,children:[!!l.message&&(0,a.jsx)("p",{className:"-mt-2 pb-1 text-slate-12",children:l.message}),l.formFields.map(e=>{if("[hidden]"===e.label)return null;let t=p[e.id],n=k&&R(e,t);return(0,a.jsxs)("div",{children:[(0,a.jsx)(P,{formField:e,disabled:f,curValue:t,setFormValues:g}),n&&(0,a.jsx)("p",{className:"mt-1.5 text-xs text-danger-11",children:n})]},e.id)}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(S.$,{type:"submit",level:"primary",disabled:f,children:l.submitButtonLabel}),(0,a.jsx)(S.$,{level:"outline",disabled:f,onClick:x,children:"Cancel"})]})]})})});function q(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function B(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)||/^.+\s<[^\s@]+@[^\s@]+\.[^\s@]+>$/.test(e)}let Q=(0,d.memo)(function(e){var t,n;let{conversationId:l,data:i,sourceAction:s,disableInteraction:o,customStatus:u,autoToggleOnStatusChange:c}=e,{isDark:f}=(0,g.G)(),v=(0,d.useMemo)(()=>{var e,t;return{to:i.to,cc:null!==(e=i.cc)&&void 0!==e?e:[],bcc:null!==(t=i.bcc)&&void 0!==t?t:[],subject:i.subject,body:i.body,saveAsDraft:i.saveAsDraft,from:i.from}},[i]),[x]=(0,d.useState)(v),[b,y]=(0,d.useState)(v);(0,d.useEffect)(()=>{y(v)},[v]);let{userEmail:j}=i.from,k=(0,d.useMemo)(()=>[j],[j]),N=(0,d.useCallback)(e=>{y(t=>({...t,subject:e}))},[]),C=(0,d.useCallback)(e=>{y(t=>({...t,to:e}))},[]),F=(0,d.useCallback)(e=>{y(t=>({...t,cc:e}))},[]),w=(0,d.useCallback)(e=>{y(t=>({...t,bcc:e}))},[]),L=(0,d.useCallback)(e=>{y(t=>({...t,body:e}))},[]),A=b.cc.length>0,D=b.bcc.length>0,[E,M]=(0,d.useState)(A),[R,P]=(0,d.useState)(D);(0,d.useEffect)(()=>{A&&M(!0)},[A]),(0,d.useEffect)(()=>{D&&P(!0)},[D]);let O=(0,d.useCallback)(()=>{E?(M(!1),F([])):M(!0)},[F,E]),q=(0,d.useCallback)(()=>{R?(P(!1),w([])):P(!0)},[w,R]),Q=!!i.replyOptions,V=Q&&b.cc.length>0,[U,H]=(0,d.useState)(V&&(null===(n=null===(t=i.replyOptions)||void 0===t?void 0:t.replyAll)||void 0===n||n)),G=(0,d.useCallback)(()=>{H(e=>!e)},[]),{submitState:Y,disabled:W,submitForm:$,cancelForm:Z,fieldErrorMessage:J,setFieldErrorMessage:X,computeFormDeltas:ee}=T({conversationId:l,sourceAction:s,disableInteraction:o,customStatus:u,cancelIntervalMs:5e3}),et=b.subject.length>0,en=(0,d.useMemo)(()=>b.to.every(B),[b.to]),ea=(0,d.useMemo)(()=>b.cc.every(B),[b.cc]),el=(0,d.useMemo)(()=>b.bcc.every(B),[b.bcc]),ei=(0,d.useMemo)(()=>b.to.length>0||b.cc.length>0||b.bcc.length>0,[b.to,b.cc,b.bcc]),er=b.body.length>0,es=(0,d.useCallback)(async e=>{if(e.preventDefault(),et){if(en&&ea&&el&&er&&ei){let e=ee(x,b);await $({...b,replyOptions:i.replyOptions?{parentEmailId:i.replyOptions.parentEmailId,replyAll:U}:void 0},e)}else X("Please fix the form errors")}else X("Please specify an email subject")},[el,er,ea,i.replyOptions,b,ei,U,X,et,$,en,x,ee]),[eo,ed]=(0,d.useState)(0),eu=(0,d.useCallback)(()=>{ed(e=>e+1)},[]),ec=(0,d.useRef)(null);(0,h.Q)(ec,[b.body,eo]);let{subtitle:em,hideSubtitleWhenOpen:ep}=(0,d.useMemo)(()=>(function(e,t,n,a,l,i,r,s,o){let d=!r||s,u=a.join(", "),c=d?l.join(", "):"",m=i.join(", "),p=[...a,...d?l:[],...i].join(", ");switch(e){case"success":return{subtitle:o?"Draft saved":"Email sent to ".concat(p)};case"canceled":return{subtitle:"Email not sent"};case"error":return{subtitle:"Error sending email"};default:if("collecting-input"!==t&&n)return{subtitle:n}}switch(t){case"collecting-input":{let e="To: ".concat(u);return c&&(e+="; Cc: ".concat(c)),m&&(e+="; Bcc: ".concat(m)),{subtitle:e,hideSubtitleWhenOpen:!0}}case"submit-pending":case"submitting":case"submitted":return{subtitle:"Sending email to ".concat(p)};case"canceled":return{subtitle:"Email canceled"}}})(u,Y,J,b.to,b.cc,b.bcc,Q,U,b.saveAsDraft),[u,J,b.bcc,b.cc,b.saveAsDraft,b.to,Q,U,Y]),eg=!!J,eh=f?"":"bg-transparent border-transparent shadow-none";return(0,a.jsx)(r.L,{title:b.subject,subtitle:em,icon:(0,a.jsx)(I.si,{tool:_.h6.Gmail,className:"h-5 w-5"}),status:K(u,Y,J),titleIsEditable:!W,titlePlaceholder:"Email subject",onTitleChange:N,hideSubtitleWhenOpen:ep,showCancelButton:"submit-pending"===Y,cancelIntervalMs:5e3,onCancel:Z,onOpen:eu,autoToggleOnStatusChange:c,hasSideEffects:!0,hasUserInput:!0,children:(0,a.jsxs)("form",{className:"mt-2 space-y-5",onSubmit:es,children:[(0,a.jsxs)("div",{className:"grid grid-cols-[auto,minmax(0,1fr)] items-start gap-2",children:[(0,a.jsx)("label",{htmlFor:"from",className:"mt-2.5 text-sm text-slate-11",children:"From"}),(0,a.jsxs)("div",{className:"grid grid-cols-[minmax(80px,1fr),auto] items-start gap-1",children:[(0,a.jsx)(m.g,{id:"from",className:(0,z.QP)(eh,"min-h-10 bg-slate-1 border-slate-4 shadow-none"),disabled:!0,items:k}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-x-1",children:[V&&(0,a.jsx)(S.$,{size:"xs",level:U?"outline":"text",disabled:W,onClick:G,children:"Reply all"}),!Q&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.$,{className:"h-10",size:"xs",level:E?"outline":"text",disabled:W,onClick:O,children:"Cc"}),(0,a.jsx)(S.$,{className:"h-10",size:"xs",level:R?"outline":"text",disabled:W,onClick:q,children:"Bcc"})]})]})]}),(0,a.jsx)("label",{htmlFor:"to",className:"mt-2.5 text-sm text-slate-12",children:"To"}),(0,a.jsxs)("div",{children:[(0,a.jsx)(m.g,{id:"to",className:(0,z.QP)(eh,"min-h-10 bg-slate-1 border-slate-4 shadow-none"),validator:B,disabled:W||Q,items:b.to,onChange:C}),eg&&!en&&(0,a.jsx)("p",{className:"ml-2 mt-1 text-xs text-danger-11",children:"Please specify one or more valid recipients"})]}),(Q?U:E)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("label",{htmlFor:"cc",className:"mt-2.5 text-sm text-slate-12",children:"Cc"}),(0,a.jsxs)("div",{children:[(0,a.jsx)(m.g,{id:"cc",className:(0,z.QP)(eh,"min-h-10 bg-slate-1 border-slate-4 shadow-none"),validator:B,disabled:W||Q,items:b.cc,onChange:F}),eg&&!ea&&(0,a.jsx)("p",{className:"ml-2 mt-1 text-xs text-danger-11",children:"Please fix invalid recipients"})]})]}),R&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("label",{htmlFor:"bcc",className:"mt-2.5 text-sm text-slate-12",children:"Bcc"}),(0,a.jsxs)("div",{children:[(0,a.jsx)(m.g,{id:"bcc",className:(0,z.QP)(eh,"min-h-10 bg-slate-1 border-slate-4 shadow-none"),validator:B,disabled:W,items:b.bcc,onChange:w}),eg&&!el&&(0,a.jsx)("p",{className:"ml-2 mt-1 text-xs text-danger-11",children:"Please fix invalid recipients"})]})]}),eg&&!ei&&(0,a.jsx)("p",{className:"ml-2 mt-1 text-xs text-danger-11",children:"Please specify at least one recipient"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(p.f,{ref:ec,id:"body",className:"resize-none rounded-none border-none bg-transparent p-0 text-sm shadow-none focus:ring-0 ",placeholder:"Email body",value:b.body,onChange:L,disabled:W}),eg&&!er&&(0,a.jsx)("p",{className:"mt-2 text-xs text-danger-11",children:"The email body cannot be empty"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(S.$,{type:"submit",level:"primary",size:"sm",disabled:W,children:v.saveAsDraft?"Save draft":Q?"Send reply":"Send email"}),(0,a.jsx)(S.$,{level:"outline",size:"sm",disabled:W,onClick:Z,children:"Cancel"})]})]})})});var V=n(93369),U=n(67966),H=n(64600),G=n(86278),Y=n(13770),W=n(97881),$=n(93030),Z=n(5572),J=n(31859),X=n(56255),ee=n(61670),et=n(35237);let en=(0,y._)({post:{body:N.z.object({start:N.z.string(),name:N.z.string(),authId:N.z.string().nullish()}),data:N.z.object({agenda:N.z.string(),created_at:N.z.string(),encrypted_password:N.z.string(),h323_password:N.z.string(),host_email:N.z.string(),host_id:N.z.string(),id:N.z.number(),join_url:N.z.string(),password:N.z.string(),pre_schedule:N.z.boolean(),pstn_password:N.z.string(),start_time:N.z.string(),start_url:N.z.string(),status:N.z.string(),timezone:N.z.string(),topic:N.z.string()})}}),ea=(0,b.In)("POST","/api/meetings/zoom",en.post.data),el=(0,y._)({get:{query:N.z.object({authId:N.z.string()}),data:N.z.boolean()}});var ei=n(79879);let er=(0,b.In)("GET","/api/oauth2/zoom",el.get.data);var es=n(48866),eo=n.n(es);let ed={zoom:"https://lindy.nyc3.cdn.digitaloceanspaces.com/vendor/zoom/logo.svg",google:"https://lindy.nyc3.cdn.digitaloceanspaces.com/vendor/google/logo.svg"};function eu(e){return(0,a.jsx)("div",{className:"rounded-md bg-white",children:(0,a.jsx)(eo(),{src:ed[e]||"",alt:"".concat(e," icon"),height:20,width:20,priority:!0})})}var ec=n(88036),em=n(70732),ep=n(39212),eg=n(77576),eh=n(85680),ef=n(20335),ev=n(76804);n(83356);var ex=n(15207),eb=n(28097),ey=n(95082),ej=n.n(ey);let ek="moment.Moment";N.z.union([N.z.unknown(),N.z.string().datetime({offset:!0})]).transform((e,t)=>{if(ex.D.validateDateTimeISOString(e))return ej()(e);let n={code:N.z.ZodIssueCode.custom,message:"Not a ".concat(ek)},a=eb.J.safeParse(e);if(!a.success||a.data.type!==ek)return t.addIssue(n),N.z.NEVER;let l=a.data.rawValue;return"string"!=typeof l?(t.addIssue(n),N.z.NEVER):ej()(l)}).superBrand(ek);let eN=e=>e instanceof ej(),eC=N.z.custom(eN).transform(e=>{let t=e.toISOString(!0);return{_isNativeObject:!0,type:ek,constructExpr:'moment("'.concat(t,'")'),rawValue:t,preview:e.format("dddd, MMMM Do YYYY, h:mm a")}}).superBrand(ek);function eF(e){return eC.parse(eN(e)?e:e._get_internal_moment())}var ew=n(33341);function eT(e){return ej()(String(e.rawValue))}function eS(e,t,n){let a=e.format(n?"ddd MMM D":"ddd MMM D, h:mm A"),l=t.format(n?"ddd MMM D":"ddd MMM D, h:mm A");return"".concat(a," - ").concat(l)}let eI=[{label:"No response",value:"none"},{label:"Accept",value:"accepted"},{label:"Maybe",value:"tentative"},{label:"Decline",value:"declined"}],e_=[{label:"Google Meet",value:"google-meet",icon:eu("google")},{label:"Zoom",value:"zoom",icon:eu("zoom")}],ez=[{label:"Sunday",value:"SU"},{label:"Monday",value:"MO"},{label:"Tuesday",value:"TU"},{label:"Wednesday",value:"WE"},{label:"Thursday",value:"TH"},{label:"Friday",value:"FR"},{label:"Saturday",value:"SA"}],eL="detected";function eA(e){let t=e%10,n=e%100;return 1==t&&11!=n?"st":2==t&&12!=n?"nd":3==t&&13!=n?"rd":"th"}let eD=(0,d.memo)(function(e){var t,n,l,i;let{conversationId:s,data:o,sourceAction:u,disableInteraction:c,customStatus:f,autoToggleOnStatusChange:v,conferenceLink:x}=e,{isDark:b}=(0,g.G)(),y=(0,eh.aV)(),j=(0,eg.U)(),k=(0,d.useMemo)(()=>{var e;let t=null!==(e=o.existingAttendees)&&void 0!==e?e:[],n=eT(o.start),a=eT(o.end);o.allDay&&(n.startOf("day"),a.startOf("day"));let l=new Set(o.attendeesToInvite.map(e=>e.email)),i=[...t.filter(e=>!l.has(e.email)),...o.attendeesToInvite];return{name:o.name,description:o.description,location:o.location,start:n,end:a,allDay:o.allDay,attendees:i,ownAttendance:o.ownAttendance,conferenceType:o.conferenceType,conferenceLink:o.conferenceLink,recurrence:o.recurrence}},[o]),[N]=(0,d.useState)(k),[C,F]=(0,d.useState)(k);(0,d.useEffect)(()=>{F(k)},[k]);let w=!o.existingEvent,A=(0,d.useMemo)(()=>{let e=new Set(o.existingAttendees.map(e=>e.email));return C.attendees.filter(t=>!e.has(t.email))},[o.existingAttendees,C.attendees]),D=A.length>0,E=(0,d.useMemo)(()=>(function(e){let t=e.match(/meet\.google\.com\/([\da-z-]+)/i);if(t){let e="https://"+t[0],n=t[1];return{type:"google-meet",url:e,displayOption:{label:"Google Meet: ".concat(n," (auto-detected)"),value:eL,icon:eu("google")}}}let n=e.match(/[\da-z]+\.zoom\.us\/j\/(\d+)[\d=?a-z]*/i);if(n){let e="https://"+n[0],t=n[1];return{type:"zoom",url:e,displayOption:{label:"Zoom: ".concat(t," (auto-detected)"),value:eL,icon:eu("zoom")}}}})(C.description),[C.description]);(0,d.useEffect)(()=>{F(e=>({...e,conferenceType:null==E?void 0:E.type,conferenceLink:null==E?void 0:E.url}))},[E]);let M=(0,d.useMemo)(()=>E?[E.displayOption,...e_]:e_,[E]),[R,P]=(0,d.useState)(!1),O=(0,d.useCallback)(e=>{F(t=>({...t,name:e}))},[]),B=(0,d.useCallback)(e=>{F(t=>({...t,description:e}))},[]),Q=(0,d.useCallback)(e=>{F(t=>({...t,location:e}))},[]),en=(0,d.useCallback)(e=>{F(t=>({...t,allDay:e})),P(!0)},[]),el=(0,d.useCallback)(e=>{F(t=>{let n=new Set(t.attendees.map(e=>e.email)),a=new Set(e),l=e.filter(e=>!n.has(e));return{...t,attendees:[...t.attendees.filter(e=>a.has(e.email)),...l.map(e=>({email:e,optional:!1}))]}})},[]),ei=(0,d.useCallback)(()=>{F(e=>({...e,conferenceLink:void 0,conferenceType:void 0}))},[]),es=(0,d.useCallback)(()=>{var e;navigator.clipboard.writeText(null!==(e=C.conferenceLink)&&void 0!==e?e:""),y({level:"success",label:"Link copied",message:"Video conference link has been copied to your clipboard",duration:3e3})},[C.conferenceLink,y]),eo=(0,d.useCallback)(e=>{F(t=>({...t,ownAttendance:e}))},[]),ed=(0,d.useMemo)(()=>{var e,t,n,a;let l=[{label:"Does not repeat",value:""},{label:"Every day",value:"RRULE:FREQ=DAILY"},{label:"Every weekday (Mon-Fri)",value:"RRULE:FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR"}],i=null===(e=C.start)||void 0===e?void 0:e.day();if("number"==typeof i&&ez.at(i)){let{label:e,value:t}=ez.at(i);l.push({label:"Every week on ".concat(e),value:"RRULE:FREQ=WEEKLY;BYDAY=".concat(t)},{label:"Every 2 weeks on ".concat(e),value:"RRULE:FREQ=WEEKLY;INTERVAL=2;BYDAY=".concat(t)})}let r=null===(t=C.start)||void 0===t?void 0:t.date();"number"==typeof r&&l.push({label:"Every month on the ".concat(r).concat(eA(r)),value:"RRULE:FREQ=MONTHLY;BYMONTHDAY=".concat(r)});let s=null===(n=C.start)||void 0===n?void 0:n.month();if("number"==typeof s&&"number"==typeof r){let e=ej()().month(s).format("MMM");l.push({label:"Every year on ".concat(e," ").concat(r),value:"RRULE:FREQ=YEARLY;BYMONTH=".concat(s+1,";BYMONTHDAY=").concat(r)})}if("number"==typeof r&&"number"==typeof i&&ez.at(i)){let e=Math.ceil(r/7),{label:t,value:n}=ez.at(i);l.push({label:"Every month on the ".concat(e).concat(eA(e)," ").concat(t),value:"RRULE:FREQ=MONTHLY;BYDAY=".concat(e).concat(n)})}let o=null===(a=C.recurrence)||void 0===a?void 0:a.at(0);if(o&&!l.some(e=>e.value===o)){let e=(0,ew.YI)(o).toText();l.push({label:e.slice(0,1).toUpperCase()+e.slice(1),value:o})}return l},[C.start,C.recurrence]),ex=(0,d.useCallback)(e=>{F(t=>({...t,recurrence:e?[e]:[]}))},[]),[eb,ey]=(0,d.useState)(!1),[ek,eN]=(0,d.useState)(!1);(0,d.useEffect)(()=>{(async()=>{if(!o.authId)return;let{data:e}=await er({query:{authId:o.authId}});e||eN(!0)})()},[o.authId]),(0,d.useEffect)(()=>{if(!eb)return;let e=setTimeout(()=>{ey(!1)},750);return()=>clearTimeout(e)},[eb]);let eC=(0,d.useCallback)(async()=>{var e;ey(!0);let{data:t}=await er({query:{authId:null!==(e=o.authId)&&void 0!==e?e:""}});if(t){let{data:e}=await ea({body:{start:C.start.format(),name:C.name,authId:o.authId}});F(t=>({...t,conferenceLink:null==e?void 0:e.join_url}))}else eN(!0)},[C.start,C.name,o.authId]),eD=(0,d.useCallback)(()=>{var e,t;let n=null!==ep.VT&&void 0!==ep.VT?ep.VT:"",a=new URLSearchParams({redirect_uri:"".concat(n.replace("http://","https://"),"/api/oauth2/zoomAuth/callback"),client_id:null!==ep.w1&&void 0!==ep.w1?ep.w1:"",scope:"",state:null!==(t=null==j?void 0:null===(e=j.data)||void 0===e?void 0:e.id)&&void 0!==t?t:"",response_type:"code",prompt:"consent",access_type:"offline"}),l=new URL("https://zoom.us/oauth/authorize");l.search=a.toString();let i=l.toString();eK(window.open(i))},[null===(t=j.data)||void 0===t?void 0:t.id]),eE=(0,d.useCallback)(e=>{e===eL&&E?F(e=>({...e,conferenceType:E.type,conferenceLink:E.url})):"zoom"===e?(eC(),F(t=>({...t,conferenceType:e}))):(ey(!0),F(t=>({...t,conferenceType:e,conferenceLink:null==o?void 0:o.conferenceLink})))},[null==o?void 0:o.conferenceLink,E,eC]),[eM,eK]=(0,d.useState)({});(0,d.useEffect)(()=>{(null==eM?void 0:eM.closed)&&!C.conferenceLink&&"zoom"===C.conferenceType&&(eC(),eN(!1))},[null==eM?void 0:eM.closed,eC,C.conferenceType,C.conferenceLink]);let eR=(0,d.useMemo)(()=>C.start.format("YYYY-MM-DD"),[C.start]),eP=(0,d.useMemo)(()=>C.end.format("YYYY-MM-DD"),[C.end]),eO=(0,d.useCallback)(e=>{e&&(F(t=>{let[n,a,l]=e.split("-").map(Number);return{...t,start:t.start.clone().year(n).month(a-1).date(l)}}),P(!0))},[]),eq=(0,d.useCallback)(e=>{e&&(F(t=>{let[n,a,l]=e.split("-").map(Number);return{...t,end:t.end.clone().year(n).month(a-1).date(l)}}),P(!0))},[]),eB=(0,d.useMemo)(()=>C.start.format("HH:mm"),[C.start]),eQ=(0,d.useMemo)(()=>C.end.format("HH:mm"),[C.end]),eV=(0,d.useCallback)(e=>{e&&(F(t=>{let[n,a]=e.split(":").map(Number);return{...t,start:t.start.clone().hours(n).minutes(a)}}),P(!0))},[]),eU=(0,d.useCallback)(e=>{e&&(F(t=>{let[n,a]=e.split(":").map(Number);return{...t,end:t.end.clone().hours(n).minutes(a)}}),P(!0))},[]),eH=!C.start.isSame(C.end,"day"),[eG,eY]=(0,d.useState)(eH);(0,d.useEffect)(()=>{eH&&eY(!0)},[eH]);let eW=(0,d.useCallback)(()=>{eG?(eY(!1),eq(eR)):eY(!0)},[eq,eG,eR]),{submitState:e$,disabled:eZ,submitForm:eJ,cancelForm:eX,cancelPendingSubmit:e0,fieldErrorMessage:e1,setFieldErrorMessage:e2,computeFormDeltas:e5}=T({conversationId:s,sourceAction:u,disableInteraction:c,customStatus:f,cancelIntervalMs:D?5e3:void 0}),e4=o.conflictingEvent,e9=(0,d.useMemo)(()=>{let e=ej()();return C.start.isBefore(e)},[C.start]);(0,d.useEffect)(()=>{C.conferenceType&&F(e=>({...e,conferenceLink:null==C?void 0:C.conferenceLink}))},[C.conferenceType,null==C?void 0:C.conferenceLink,null==o?void 0:o.conferenceLink]);let e3=(0,d.useMemo)(()=>{if(e4&&!R){let e=eS(eT(e4.start),eT(e4.end),e4.allDay);return'Conflicts with the event "'.concat(e4.name,'" (').concat(e,")")}return e9?"Event being scheduled is in the past":e1},[e9,e4,e1,R]),e7=C.name.length>0,e6=(0,d.useMemo)(()=>{if(!C.allDay)return C.start.isBefore(C.end);{let e=C.start.clone().startOf("day"),t=C.end.clone().startOf("day");return e.isSameOrBefore(t)}},[C.allDay,C.end,C.start]),e8=(0,d.useMemo)(()=>C.attendees.every(e=>q(e.email)),[C.attendees]),te=(0,d.useCallback)(async e=>{if(e.preventDefault(),e7){if(e6&&e8){let e=(e,t)=>{var n;let a=new Set(t.attendees.map(e=>e.email)),l=t.attendees,i=null===(n=e.existingAttendees)||void 0===n?void 0:n.filter(e=>!a.has(e.email));return{existingEvent:e.existingEvent,name:t.name,description:t.description,location:t.location,start:eF(t.start),end:eF(t.end),allDay:t.allDay,attendeesToInvite:l,attendeesToRemove:i,ownAttendance:t.ownAttendance,conferenceType:t.conferenceType,conferenceLink:null==t?void 0:t.conferenceLink,recurrence:t.recurrence,authId:e.authId,silenceEventConflictError:!0}},t=e(o,N),n=e(o,C),a=e5(t,n);await eJ(n,a)}else e2("Please fix the form errors")}else e2("Please specify an event name")},[e8,o,C,e7,e2,e6,eJ,N,e5]),[tt,tn]=(0,d.useState)(0),ta=(0,d.useCallback)(()=>{tn(e=>e+1)},[]),tl=(0,d.useRef)(null);(0,h.Q)(tl,[C.description,tt]);let{subtitle:ti,hideSubtitleWhenOpen:tr}=(0,d.useMemo)(()=>(function(e,t,n,a,l,i,r,s){let o=s.length>0,d=s.map(e=>e.email).join(", ");switch(e){case"success":return{subtitle:o?"Invited ".concat(d):r?"Event created":"Event updated"};case"canceled":return{subtitle:r?"Event not created":"Event not updated"};case"error":return{subtitle:r?"Error creating event":"Error updating event"};default:if("collecting-input"===t&&n)return{subtitle:n}}if(o)switch(t){case"collecting-input":return{subtitle:"Invite: ".concat(d),hideSubtitleWhenOpen:!0};case"submit-pending":case"submitting":case"submitted":return{subtitle:"Inviting ".concat(d)};case"canceled":return{subtitle:r?"Event creation canceled":"Event update canceled"}}else switch(t){case"collecting-input":return{subtitle:eS(a,l,i),hideSubtitleWhenOpen:!0};case"submit-pending":case"submitting":case"submitted":return{subtitle:r?"Creating event":"Updating event"};case"canceled":return{subtitle:r?"Event creation canceled":"Event update canceled"}}})(f,e$,e3,C.start,C.end,C.allDay,w,A),[f,e$,e3,C.start,C.end,C.allDay,w,A]),ts=!!e3,to="text-sm px-2 py-2",td=b?"":"bg-transparent border-transparent shadow-none",tu=(0,d.useMemo)(()=>{let e=(0,a.jsx)("label",{htmlFor:"startDate",className:"mt-2",children:(0,a.jsx)(V.A,{className:"size-5 text-slate-12"})}),t=(0,a.jsx)(U.A,{className:"size-5 text-slate-9"}),n=(0,a.jsx)(ef.pd,{id:"startDate",type:"date",className:(0,z.QP)(to,td,"w-32 bg-slate-1 border-slate-4 shadow-none h-10"),disabled:eZ,value:eR,onChange:eO}),l=(0,a.jsx)(ef.pd,{type:"date",className:(0,z.QP)(to,td,"w-32 bg-slate-1 border-slate-4 shadow-none h-10"),disabled:eZ,value:eP,onChange:eq}),i=(0,a.jsx)(ef.pd,{type:"time",className:(0,z.QP)(to,td,"w-min bg-slate-1 border-slate-4 shadow-none h-10"),disabled:eZ,value:eB,onChange:eV}),r=(0,a.jsx)(ef.pd,{type:"time",className:(0,z.QP)(to,td,"w-min bg-slate-1 border-slate-4 shadow-none h-10"),disabled:eZ,value:eQ,onChange:eU});return C.allDay?eG?(0,a.jsxs)(a.Fragment,{children:[e,(0,a.jsxs)("div",{className:"flex-wrap items-center gap-1",children:[n,t,l]})]}):(0,a.jsxs)(a.Fragment,{children:[e,n]}):eG?(0,a.jsxs)(a.Fragment,{children:[e,(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[n,i,(0,a.jsx)("p",{className:"ml-2 text-xs text-slate-12",children:"From"})]}),(0,a.jsx)("div",{}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[l,r,(0,a.jsx)("p",{className:"ml-2 text-xs text-slate-12",children:"To"})]})]}):(0,a.jsxs)(a.Fragment,{children:[e,(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[n,(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[i,t,r]})]})]})},[eZ,eP,eQ,C.allDay,eq,eU,eO,eV,td,eG,eR,eB]),tc=(0,d.useMemo)(()=>{var e;return eb?(0,a.jsxs)("div",{className:"my-2 ml-2 flex items-start text-sm",children:[(0,a.jsxs)("span",{className:"pr-3 text-slate-12",children:["Creating ","zoom"===C.conferenceType?"Zoom":"GMeet"," meeting..."]}),(0,a.jsx)(ev.y,{className:"mr-2 size-4"})]}):(0,a.jsxs)("div",{className:"my-2 ml-2 flex items-start",children:[(0,a.jsx)("div",{className:"flex flex-1 text-sm",children:(0,a.jsx)(ec.N,{href:null!==(e=null==C?void 0:C.conferenceLink)&&void 0!==e?e:"",external:!0,children:C.conferenceLink})}),!eZ&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(H.A,{onClick:es,className:"mr-3 size-5 cursor-pointer text-slate-12"}),(0,a.jsx)(G.A,{onClick:ei,className:"size-5 cursor-pointer text-slate-12"})]})]})},[ei,C.conferenceType,eb,eZ,C.conferenceLink,es]),tm=(0,d.useMemo)(()=>C.attendees.map((e,t)=>({value:e.email,actions:[{icon:e.optional?(0,a.jsx)(Y.A,{className:"w-3"}):(0,a.jsx)(et.A,{className:"w-3"}),tooltip:e.optional?"Mark Required":"Mark Optional",onClick:()=>{F(n=>{let a=[...n.attendees];return a[t]={email:e.email,optional:!e.optional},{...n,attendees:a}})}}]})),[C.attendees]);return(0,a.jsx)(r.L,{title:C.name,subtitle:ti,icon:(0,a.jsx)(I.si,{tool:_.h6.Calendar,className:"size-5"}),status:K(f,e$,e3),titleIsEditable:!eZ,titlePlaceholder:"Event Name",onTitleChange:O,hideSubtitleWhenOpen:tr,showCancelButton:D&&"submit-pending"===e$,cancelIntervalMs:5e3,onCancel:e0,onOpen:ta,autoToggleOnStatusChange:v,hasSideEffects:!0,hasUserInput:!0,children:(0,a.jsxs)("form",{className:"mt-2 space-y-5",onSubmit:te,children:[(0,a.jsxs)("div",{className:"grid grid-cols-[auto,1fr] items-start gap-x-3 gap-y-2",children:[tu,(0,a.jsx)("div",{}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-2 ml-2.5 flex items-center gap-2",children:[(0,a.jsx)(em.d,{disabled:eZ,checked:C.allDay,onChange:en}),(0,a.jsx)("p",{className:"mr-4 text-sm text-slate-11",children:"All day"}),(0,a.jsx)(em.d,{disabled:eZ,checked:eG,onChange:eW}),(0,a.jsx)("p",{className:"text-sm text-slate-11",children:"Multi day"})]}),ts&&!e6&&(0,a.jsx)("p",{className:"ml-2 mt-1 text-xs text-danger-11",children:"End date must be after start date"})]}),(0,a.jsx)("label",{className:"mt-2",children:(0,a.jsx)(W.A,{className:"size-5 text-slate-12"})}),(0,a.jsx)("div",{children:(0,a.jsx)(L.m,{menuPosition:"bottom",options:ed,disabled:eZ,value:null!==(l=null===(n=C.recurrence)||void 0===n?void 0:n.at(0))&&void 0!==l?l:"",onChange:ex,className:"h-10 border-slate-4 shadow-none hover:border-slate-8 hover:bg-slate-1"})}),(0,a.jsx)("label",{htmlFor:"attendeesToInviteEmails",className:"self-center",children:(0,a.jsx)($.A,{className:"size-5 text-slate-12"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(m.g,{id:"attendeesToInviteEmails",className:(0,z.QP)(td,"h-auto min-h-[2.5rem] bg-slate-1 border-slate-4 shadow-none"),validator:q,placeholder:"Attendees",disabled:eZ,items:tm,onChange:el}),ts&&!e8&&(0,a.jsx)("p",{className:"ml-2 mt-1 text-xs text-danger-11",children:"Please specify one or more valid email addresses"})]}),(0,a.jsx)("label",{htmlFor:"location",className:"self-center",children:(0,a.jsx)(Z.A,{className:"size-5 text-slate-12"})}),(0,a.jsx)("div",{children:(0,a.jsx)(ef.pd,{id:"location",className:(0,z.QP)(to,td,"h-10 bg-slate-1 border-slate-4 shadow-none"),disabled:eZ,placeholder:"Location",value:C.location,onChange:Q})}),!!C.ownAttendance&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("label",{className:"mt-2",children:(0,a.jsx)(J.A,{className:"size-5 text-slate-12"})}),(0,a.jsx)("div",{children:(0,a.jsx)(L.m,{menuPosition:"top",className:"h-10 border-slate-4 shadow-none hover:border-slate-8 hover:bg-slate-1",options:eI,disabled:eZ,value:C.ownAttendance,onChange:eo})})]}),(0,a.jsx)("label",{htmlFor:"conferenceLinkId",className:"self-center",children:(0,a.jsx)(X.A,{className:"size-5 text-slate-12"})}),eb||C.conferenceLink?(0,a.jsxs)(a.Fragment,{children:[" ",tc," "]}):(0,a.jsx)("div",{children:(0,a.jsx)(L.m,{menuPosition:"bottom",options:M,disabled:eZ,placeholder:"Add video conferencing",placeholderClassName:"text-slate-12 text-sm font-medium",className:"h-10 border-slate-4 shadow-none hover:border-slate-8 hover:bg-slate-1",value:null!==(i=C.conferenceType)&&void 0!==i?i:null,onChange:eE})}),ek&&"zoom"===C.conferenceType&&!eb&&!x&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"pr-3 text-sm",children:"Please connect your Zoom account"}),(0,a.jsx)(S.$,{className:"mr-2 mt-2",level:"primary",size:"sm",disabled:eZ,onClick:eD,children:"Connect Zoom"}),(0,a.jsx)(S.$,{level:"outline",size:"sm",disabled:eZ,className:"mt-2",onClick:ei,children:"Cancel"})]})]}),(0,a.jsx)("label",{htmlFor:"description",className:"self-center",children:(0,a.jsx)(ee.A,{className:"size-5 text-slate-12"})}),(0,a.jsx)("div",{children:(0,a.jsx)(p.f,{ref:tl,id:"description",className:(0,z.QP)(to,td,"resize-none bg-slate-1 border-slate-4 shadow-none"),disabled:eZ,placeholder:"Description",value:C.description,onChange:B})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(S.$,{type:"submit",level:"primary",size:"sm",disabled:eZ,children:D?"Send invite":w?"Create event":"Update event"}),(0,a.jsx)(S.$,{level:"outline",size:"sm",disabled:eZ,onClick:eX,children:"Cancel"})]})]})})}),eE={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"FormBuilder_Identity",selections:[{args:null,kind:"FragmentSpread",name:"FormBuilderElement_Identity"}],type:"Identity",abstractKey:null};eE.hash="6463619f5f4575732b469f6a800c9997";let eM={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"FormBuilder_AgentDefinition",selections:[{args:null,kind:"FragmentSpread",name:"FormBuilderElement_AgentDefinition"}],type:"AgentDefinition",abstractKey:null};eM.hash="9f36d44b2642a72fbb75a94e8bf5629c";var eK=n(26248),eR=n(23913),eP=n(98354),eO=n(35774),eq=n(81778);let eB={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"FormBuilderElement_Identity",selections:[{args:null,kind:"FragmentSpread",name:"FormBuilderAuthInput_Identity"}],type:"Identity",abstractKey:null};eB.hash="e318c0e8e966f31785f93978245edeb7";let eQ={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"FormBuilderElement_AgentDefinition",selections:[{args:null,kind:"FragmentSpread",name:"FormBuilderStateGraphNodeField_AgentDefinition"}],type:"AgentDefinition",abstractKey:null};eQ.hash="2f0f4cefc4a3b30d6092d7ec5f0e08ec";var eV=n(84370);let eU={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"FormBuilderAuthInput_Identity",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Identity",abstractKey:null};eU.hash="29982b68294b617b8aaba8ac987db382";let eH=function(){var e={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"fields",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"isConnected",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"method",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"provider",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"scopes",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"nodeId",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"FormBuilderAuthInputQuery",selections:[{alias:null,args:null,concreteType:"Identity",kind:"LinkedField",name:"me",plural:!1,selections:[{alias:null,args:null,concreteType:"Auth",kind:"LinkedField",name:"auth",plural:!0,selections:[e,t,n,a,l,i,r,s],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"FormBuilderAuthInputQuery",selections:[{alias:null,args:null,concreteType:"Identity",kind:"LinkedField",name:"me",plural:!1,selections:[{alias:null,args:null,concreteType:"Auth",kind:"LinkedField",name:"auth",plural:!0,selections:[e,t,n,a,l,i,r,s,o],storageKey:null},o],storageKey:null}]},params:{cacheID:"db01ef125cb800b3572a69071c630ed6",id:null,metadata:{},name:"FormBuilderAuthInputQuery",operationKind:"query",text:"query FormBuilderAuthInputQuery {\n  me {\n    auth {\n      __typename\n      fields\n      id\n      isConnected\n      label\n      method\n      provider\n      scopes\n      nodeId\n    }\n    nodeId\n  }\n}\n"}}}();eH.hash="f247c1ed6a59742a6b73d22b56905e7a";var eG=n(72672),eY=n(11607),eW=n(3673),e$=n(84814);function eZ(e){var t,n,l,i;let r=(0,u.useFragment)(eU,e.identityFragmentRef),s=(0,d.useMemo)(()=>{try{return JSON.parse(e.auth)}catch(e){return null}},[e.auth]),[o,c]=(0,d.useState)(0),m=(0,u.useLazyLoadQuery)(eH,{},{fetchPolicy:"network-only",fetchKey:"".concat(null!==(n=null==s?void 0:s.provider)&&void 0!==n?n:"","-").concat(o)}),p=(0,d.useMemo)(()=>{var e,t;return(0,e$.c)(null!==(t=null===(e=m.me)||void 0===e?void 0:e.auth)&&void 0!==t?t:[],s)},[s,null===(t=m.me)||void 0===t?void 0:t.auth]),g=(0,d.useMemo)(()=>{var t;return null!==(t=p.find(t=>t.id===e.value))&&void 0!==t?t:null},[p,e.value]);(0,d.useEffect)(()=>{if(!g&&p.length>0){var t,n;e.onChange(null!==(n=null===(t=p.at(0))||void 0===t?void 0:t.id)&&void 0!==n?n:"")}},[g,p,e]);let h=(0,d.useMemo)(()=>{var e;return!(0,eY.Dq)({availableScopes:null!==(e=null==g?void 0:g.scopes)&&void 0!==e?e:[],requiredScopes:(0,eW.a)(s)}).hasAllScopes},[g,s]),f=(0,d.useCallback)(t=>{var n,a;let{hasAllScopes:l}=(0,eY.Dq)({availableScopes:null!==(n=null==t?void 0:t.scopes)&&void 0!==n?n:[],requiredScopes:(0,eW.a)(s)});if(!l){e.onChange("");return}e.onChange(null!==(a=null==t?void 0:t.id)&&void 0!==a?a:""),c(e=>e+1)},[e,s]);return s?(0,a.jsx)(eG.a,{authConfig:s,displayName:s.displayName,tool:null!==(l=s.icon)&&void 0!==l?l:_.h6.Lindy,onChange:f,auth:g,identityId:null!==(i=null==r?void 0:r.id)&&void 0!==i?i:"",authList:p,isMissingScopes:h,disabled:e.disabled,hideComplianceInfo:!0}):null}var eJ=n(53549);function eX(e){return(0,a.jsx)("div",{className:"flex items-center justify-end",children:(0,a.jsx)(S.$,{size:"xl",level:e.variant,disabled:e.disabled,onClick:e.onClick,className:"w-full lg:w-auto",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[e.label," ","skip"!==e.action&&(0,a.jsx)("div",{className:e.disabled?"text-slate-9":"text-white",children:(0,a.jsx)(eJ.f,{})})]})})})}var e0=n(95158),e1=n(91871),e2=n(33025),e5=n(33762);function e4(e){let[,t]=(0,e5.Cj)(),[n,l]=(0,d.useState)(!1),i=(0,d.useRef)(null),r=(0,d.useCallback)(async n=>{n.preventDefault(),n.stopPropagation(),i.current&&clearTimeout(i.current),await t(e.text),l(!0),i.current=window.setTimeout(()=>{l(!1)},2e3)},[t,e.text]);return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{readOnly:!0,value:e.text,className:(0,z.QP)(ef.jp,"w-full rounded-md border border-slate-4 bg-panel p-[14px] text-sm text-slate-12")}),(0,a.jsx)("div",{className:(0,z.QP)("absolute inset-y-0 right-0 flex items-center justify-center pr-[14px] opacity-0 transition-opacity",n&&"opacity-100"),children:(0,a.jsxs)("div",{className:"flex items-center gap-x-2 text-xs text-slate-10",children:["Copied!",(0,a.jsx)("div",{className:"flex size-4 items-center justify-center rounded-full bg-success-9",children:(0,a.jsx)(e0.A,{className:"size-3 text-success-4"})})]})}),(0,a.jsx)("div",{className:(0,z.QP)("absolute inset-y-0 right-0 flex items-center justify-center pr-[14px] transition-opacity",n&&"opacity-0"),children:(0,a.jsx)("button",{onClick:r,className:(0,z.QP)(e1.Y,"rounded-md p-1 transition-colors hover:bg-slate-3"),children:(0,a.jsx)(e2.T,{className:"right-5 size-4 text-slate-11"})})})]})}var e9=n(44691);function e3(e){return(0,a.jsx)(e9.Y,{children:e.content})}function e7(e){let t=e.required?"Required. ":"";return e.minLength&&e.maxLength?(0,a.jsxs)("p",{className:"mb-2 text-xs italic text-slate-10",children:[t,"Must be between ",e.minLength," and ",e.maxLength," characters"]}):e.minLength?(0,a.jsxs)("p",{className:"mb-2 text-xs italic text-slate-10",children:[t,"Must be at least ",e.minLength," character",1===e.minLength?"":"s"," long"]}):e.maxLength?(0,a.jsxs)("p",{className:"mb-2 text-xs italic text-slate-10",children:[t,"Must be at most ",e.maxLength," characters long"]}):e.min&&e.max?(0,a.jsxs)("p",{className:"mb-2 text-xs italic text-slate-10",children:[t,"Must be between ",e.min," and ",e.max]}):e.min?(0,a.jsxs)("p",{className:"mb-2 text-xs italic text-slate-10",children:[t,"Must be at least ",e.min]}):e.max?(0,a.jsxs)("p",{className:"mb-2 text-xs italic text-slate-10",children:[t,"Must be at most ",e.max]}):t?(0,a.jsx)("p",{className:"sr-only mb-2 text-xs italic text-slate-10",children:t}):null}function e6(e){var t,n,l,i,r,s,o,u;let c=(0,d.useCallback)(t=>{e.onChange(Number(t))},[e]),m=null!==(s=null!==(r=null===(t=e.value)||void 0===t?void 0:t.toString())&&void 0!==r?r:null===(n=e.defaultValue)||void 0===n?void 0:n.toString())&&void 0!==s?s:"",p=null!==(o=null===(l=e.validation)||void 0===l?void 0:l.min)&&void 0!==o?o:void 0,g=null!==(u=null===(i=e.validation)||void 0===i?void 0:i.max)&&void 0!==u?u:void 0;return(0,a.jsxs)("div",{children:[(0,a.jsx)(E.J,{className:"sr-only",htmlFor:e.id,children:e.label}),e.description&&(0,a.jsx)("p",{className:"sr-only my-2 text-xs text-slate-10",children:e.description}),(0,a.jsx)(e7,{min:p,max:g,required:e.required}),(0,a.jsx)(ef.pd,{id:e.id,type:"number",min:p,max:g,value:m,onChange:c,disabled:e.disabled,required:e.required})]})}var e8=n(85307);function te(e){return(0,a.jsx)(e8.v,{className:"text-slate-11 [&_a]:text-slate-12 [&_a]:underline [&_a]:hover:text-slate-11",children:e.content})}function tt(e){let t=(0,d.useCallback)(t=>n=>{n.stopPropagation(),n.preventDefault(),e.disabled||e.onChange(t,!0)},[e]),n=(0,d.useMemo)(()=>new Set(e.options.map(e=>e.value)),[e.options]),l=(0,d.useCallback)(t=>{"Enter"===t.key&&(t.preventDefault(),e.onChange(t.currentTarget.value,!0))},[e]);return(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)(E.J,{className:"sr-only",htmlFor:e.id,children:e.label}),e.description&&(0,a.jsx)("p",{className:"sr-only my-2 text-xs text-slate-10",children:e.description}),(0,a.jsx)(e7,{required:e.required}),(0,a.jsxs)("div",{className:"flex flex-col gap-y-3",children:[e.options.map(n=>(0,a.jsx)("button",{type:"submit",onClick:t(n.value),className:(0,z.QP)("h-12 w-full rounded-md border border-slate-5 transition hover:bg-slate-3","text-slate-12 font-medium outline-none","focus-visible:ring-2 focus:ring-primary-8 focus:outline-none focus:ring-offset-2",e.value===n.value&&"bg-slate-4 text-slate-12 border-slate-8",e.disabled&&"opacity-50 pointer-events-none"),children:n.label},n.value)),e.addOtherOption&&(0,a.jsx)(ef.pd,{id:e.id,type:"text",value:e.value?n.has(e.value)?"":e.value:"",minLength:1,maxLength:1e3,placeholder:"Something else",onChange:e.onChange,onKeyDown:l,disabled:e.disabled,required:e.required})]})]})}function tn(e){var t;let n=(0,d.useCallback)(t=>n=>{if(n.stopPropagation(),n.preventDefault(),!e.disabled){var a;e.onChange((a=e.value).includes(t)?a.filter(e=>e!==t):[...a,t])}},[e]),l=(0,d.useMemo)(()=>new Set(e.options.map(e=>e.value)),[e.options]),i=(0,d.useCallback)((t,n)=>{let a=e.value.filter(e=>l.has(e));t.trim().length>0?e.onChange([...a,t],n):e.onChange(a,n)},[l,e]),r=(0,d.useCallback)(e=>{"Enter"===e.key&&(e.preventDefault(),i(e.currentTarget.value,!0))},[i]);return(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)(E.J,{className:"sr-only",htmlFor:e.id,children:e.label}),e.description&&(0,a.jsx)("p",{className:"sr-only my-2 text-xs text-slate-10",children:e.description}),(0,a.jsx)(e7,{required:e.required}),(0,a.jsxs)("div",{className:"flex flex-col gap-y-3",children:[e.options.map(t=>(0,a.jsx)("button",{type:"button",onClick:n(t.value),className:(0,z.QP)("h-12 w-full rounded-md border border-slate-5 transition hover:bg-slate-3","text-slate-12 font-medium outline-none","focus-visible:ring-2 focus:ring-primary-8 focus:outline-none focus:ring-offset-2",e.value.includes(t.value)&&"bg-slate-4 text-slate-12 border-slate-8",e.disabled&&"opacity-50 pointer-events-none"),children:t.label},t.value)),e.addOtherOption&&(0,a.jsx)(ef.pd,{id:e.id,type:"text",value:null!==(t=e.value.find(e=>!l.has(e)))&&void 0!==t?t:"",minLength:1,maxLength:1e3,placeholder:"Something else",onChange:i,onKeyDown:r,disabled:e.disabled,required:e.required})]})]})}let ta=function(){var e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},a={alias:null,args:null,concreteType:"Auth",kind:"LinkedField",name:"auth",plural:!1,selections:[e],storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"FormBuilderStateGraphNodeField_AgentDefinition",selections:[{alias:null,args:null,concreteType:"StateGraph",kind:"LinkedField",name:"stateGraph",plural:!1,selections:[e,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"nodes",plural:!0,selections:[{kind:"InlineFragment",selections:[t,e,{alias:null,args:null,concreteType:"StateGraphAction",kind:"LinkedField",name:"actionDefinition",plural:!1,selections:[{alias:null,args:null,concreteType:"ActionDetails",kind:"LinkedField",name:"action",plural:!1,selections:[{alias:null,args:null,concreteType:"DynamicLoaders",kind:"LinkedField",name:"dynamicLoaders",plural:!1,selections:[{alias:null,args:null,concreteType:"DynamicLoaderDetails",kind:"LinkedField",name:"loaders",plural:!0,selections:[{alias:null,args:null,concreteType:"DynamicLoaderDefaultValue",kind:"LinkedField",name:"defaultValue",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"field",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"icon",storageKey:null},n,{alias:null,args:null,kind:"ScalarField",name:"placeholder",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},a,{args:null,kind:"FragmentSpread",name:"FormBuilderActionField_ActionNode"}],type:"ActionNode",abstractKey:null},{kind:"InlineFragment",selections:[t,e,a,{alias:null,args:null,concreteType:"TriggerDefinition",kind:"LinkedField",name:"triggerDefinition",plural:!1,selections:[e,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"fields",plural:!0,selections:[t,n],storageKey:null}],storageKey:null}],type:"EntryPointTriggerNode",abstractKey:null}],storageKey:null}],storageKey:null}],type:"AgentDefinition",abstractKey:null}}();ta.hash="8de770f4898669870c085a18174c02a2";var tl=n(39548),ti=n(98448),tr=n(56989);let ts={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"FormBuilderActionField_ActionNode",selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,concreteType:"StateGraphAction",kind:"LinkedField",name:"actionDefinition",plural:!1,selections:[{alias:null,args:null,concreteType:"ActionDetails",kind:"LinkedField",name:"action",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"inputSchema",storageKey:null}],storageKey:null}],storageKey:null}],type:"ActionNode",abstractKey:null};function to(e){return(0,a.jsxs)("div",{children:[(0,a.jsx)(E.J,{className:"sr-only",htmlFor:e.id,children:e.label}),e.description&&(0,a.jsx)("p",{className:"sr-only my-2 text-xs text-slate-10",children:e.description}),(0,a.jsx)(e7,{required:e.required}),(0,a.jsx)(em.d,{id:e.id,checked:e.value,onChange:e.onChange,disabled:e.disabled})]})}function td(e){return(0,a.jsxs)("div",{children:[(0,a.jsx)(E.J,{className:"sr-only",htmlFor:e.id,children:e.label}),e.description&&(0,a.jsx)("p",{className:"sr-only my-2 text-xs text-slate-10",children:e.description}),(0,a.jsx)(e7,{required:e.required}),(0,a.jsx)(ef.pd,{id:e.id,type:"datetime-local",value:e.value,placeholder:e.placeholder,onChange:e.onChange,disabled:e.disabled,required:e.required})]})}function tu(e){var t,n,l,i;let r=null!==(l=null===(t=e.validation)||void 0===t?void 0:t.minLength)&&void 0!==l?l:void 0,s=null!==(i=null===(n=e.validation)||void 0===n?void 0:n.maxLength)&&void 0!==i?i:void 0;return(0,a.jsxs)("div",{children:[(0,a.jsx)(E.J,{className:"sr-only",htmlFor:e.id,children:e.label}),e.description&&(0,a.jsx)("p",{className:"sr-only my-2 text-xs text-slate-10",children:e.description}),(0,a.jsx)(e7,{minLength:r,maxLength:s,required:e.required}),e.multiline?(0,a.jsx)(p.f,{id:e.id,value:e.value,minLength:r,maxLength:s,placeholder:e.placeholder,onChange:e.onChange,disabled:e.disabled,required:e.required}):(0,a.jsx)(ef.pd,{id:e.id,type:"text",value:e.value,minLength:r,maxLength:s,placeholder:e.placeholder,onChange:e.onChange,disabled:e.disabled,required:e.required})]})}ts.hash="a6d75e14a1852f36208e11e15db977c2";var tc=n(88991),tm=n(95654);function tp(e){var t,n,l,i,r;let s=(0,u.useFragment)(ts,e.actionNodeFragmentRef),o=null===(l=s.actionDefinition)||void 0===l?void 0:null===(n=l.action.inputSchema)||void 0===n?void 0:null===(t=n.properties)||void 0===t?void 0:t[e.fieldKey];if(!o)return(0,a.jsx)("pre",{className:"whitespace-pre-wrap",children:JSON.stringify(s,null,2)});let d=null!==(i=(0,tm.ub)(o,e.fieldKey))&&void 0!==i?i:"",c=null!==(r=(0,tm.l$)(o))&&void 0!==r?r:"";return tm.KQ.isString(o)?(0,a.jsx)(tu,{id:e.fieldKey,label:d,description:c,value:"string"==typeof e.value?e.value:"",onChange:e.onChange,disabled:e.disabled}):tm.KQ.isNumber(o)?(0,a.jsx)(e6,{id:e.fieldKey,label:d,description:c,value:"number"==typeof e.value?e.value:void 0,onChange:e.onChange,disabled:e.disabled}):tm.KQ.isDate(o)?(0,a.jsx)(td,{id:e.fieldKey,label:d,description:c,value:"string"==typeof e.value?e.value:"",onChange:e.onChange,disabled:e.disabled}):tm.KQ.isEnum(o)?(0,a.jsx)(tt,{id:e.fieldKey,label:d,description:c,value:"string"==typeof e.value||"number"==typeof e.value?e.value.toString():"",options:o.enum.map(e=>({label:(0,tc.l)(e).toString(),value:e.toString()})),onChange:e.onChange,disabled:e.disabled}):tm.KQ.isBoolean(o)?(0,a.jsx)(to,{id:e.fieldKey,label:d,description:c,value:"boolean"==typeof e.value&&e.value,onChange:e.onChange,disabled:e.disabled}):(0,a.jsx)("pre",{className:"whitespace-pre-wrap",children:JSON.stringify(s,null,2)})}var tg=n(91318),th=n(1676),tf=n(51588);let tv=(0,n(8678).PA)(function(e){let t=(0,e5.DK)(t=>e.onChange(t.value)),n=(0,tg.q2)(()=>new tf.F({rawDynamicLoaders:e.dynamicLoaders,hydrationObject:{},loaderChangeCallback:t,authId:e.authId}),[e.dynamicLoaders,e.authId,t]);return(0,a.jsx)("div",{className:"flex flex-col gap-7",children:n.visibleLoaders.map(e=>(0,a.jsx)(th.X,{loaderField:e,loadersStore:n,autoFocusIfNextOne:!0},e))})}),tx=function(){var e={defaultValue:null,kind:"LocalArgument",name:"authId"},t={defaultValue:null,kind:"LocalArgument",name:"id"},n=[{kind:"Variable",name:"id",variableName:"id"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{kind:"Variable",name:"authId",variableName:"authId"}],i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},s=[i,r],o={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"isRequired",storageKey:null},c={alias:null,args:l,concreteType:"TriggerFieldOption",kind:"LinkedField",name:"options",plural:!0,selections:[o,{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"placeholder",storageKey:null},p=[r,o,d,u],g=[r];return{fragment:{argumentDefinitions:[e,t],kind:"Fragment",metadata:null,name:"FormBuilderTriggerFieldTriggerDefinitionQuery",selections:[{alias:null,args:n,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[a,{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"fields",plural:!0,selections:[{kind:"InlineFragment",selections:[i,r,{args:l,kind:"FragmentSpread",name:"FormBuilderTriggerFieldSelect_TriggerFieldSelect"}],type:"TriggerFieldSelect",abstractKey:null},{kind:"InlineFragment",selections:[i,r,{args:l,kind:"FragmentSpread",name:"FormBuilderTriggerFieldMultiSelect_TriggerFieldMultiSelect"}],type:"TriggerFieldMultiSelect",abstractKey:null},{kind:"InlineFragment",selections:[i,r,{args:null,kind:"FragmentSpread",name:"FormBuilderTriggerFieldText_TriggerFieldText"}],type:"TriggerFieldText",abstractKey:null},{kind:"InlineFragment",selections:[i,r,{args:null,kind:"FragmentSpread",name:"FormBuilderTriggerFieldNumber_TriggerFieldNumber"}],type:"TriggerFieldNumber",abstractKey:null},{kind:"InlineFragment",selections:[i,r,{args:null,kind:"FragmentSpread",name:"FormBuilderTriggerFieldDateTime_TriggerFieldDateTime"}],type:"TriggerFieldDateTime",abstractKey:null},{kind:"InlineFragment",selections:[i,r,{args:null,kind:"FragmentSpread",name:"FormBuilderTriggerFieldRecurringSchedule_TriggerFieldRecurringSchedule"}],type:"TriggerFieldRecurringSchedule",abstractKey:null},{kind:"InlineFragment",selections:[i,r,{args:null,kind:"FragmentSpread",name:"FormBuilderTriggerFieldCheckbox_TriggerFieldCheckbox"}],type:"TriggerFieldCheckbox",abstractKey:null},{kind:"InlineFragment",selections:s,type:"TriggerFieldLindyEmbedConfig",abstractKey:null},{kind:"InlineFragment",selections:s,type:"TriggerFieldAutoObserve",abstractKey:null},{kind:"InlineFragment",selections:s,type:"TriggerFieldLindyMail",abstractKey:null},{kind:"InlineFragment",selections:s,type:"TriggerFieldLindyWebhook",abstractKey:null},{kind:"InlineFragment",selections:s,type:"TriggerFieldLindyPhoneNumber",abstractKey:null},{kind:"InlineFragment",selections:s,type:"TriggerFieldElevenLabsVoice",abstractKey:null},{kind:"InlineFragment",selections:s,type:"TriggerFieldLabel",abstractKey:null},{kind:"InlineFragment",selections:s,type:"TriggerFieldComparableText",abstractKey:null},{kind:"InlineFragment",selections:s,type:"TriggerFieldDynamicLoader",abstractKey:null}],storageKey:null}],type:"TriggerDefinition",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,e],kind:"Operation",name:"FormBuilderTriggerFieldTriggerDefinitionQuery",selections:[{alias:null,args:n,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"nodeId",storageKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"fields",plural:!0,selections:[i,{kind:"InlineFragment",selections:[r,o,d,u,{alias:"defaultItem",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},c],type:"TriggerFieldSelect",abstractKey:null},{kind:"InlineFragment",selections:[r,o,d,u,{alias:"defaultItems",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},c],type:"TriggerFieldMultiSelect",abstractKey:null},{kind:"InlineFragment",selections:[r,o,d,m,u],type:"TriggerFieldText",abstractKey:null},{kind:"InlineFragment",selections:[r,o,d,u,{alias:null,args:null,kind:"ScalarField",name:"min",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max",storageKey:null}],type:"TriggerFieldNumber",abstractKey:null},{kind:"InlineFragment",selections:p,type:"TriggerFieldDateTime",abstractKey:null},{kind:"InlineFragment",selections:[r,o,m,d,u],type:"TriggerFieldRecurringSchedule",abstractKey:null},{kind:"InlineFragment",selections:p,type:"TriggerFieldCheckbox",abstractKey:null},{kind:"InlineFragment",selections:g,type:"TriggerFieldLindyEmbedConfig",abstractKey:null},{kind:"InlineFragment",selections:g,type:"TriggerFieldAutoObserve",abstractKey:null},{kind:"InlineFragment",selections:g,type:"TriggerFieldLindyMail",abstractKey:null},{kind:"InlineFragment",selections:g,type:"TriggerFieldLindyWebhook",abstractKey:null},{kind:"InlineFragment",selections:g,type:"TriggerFieldLindyPhoneNumber",abstractKey:null},{kind:"InlineFragment",selections:g,type:"TriggerFieldElevenLabsVoice",abstractKey:null},{kind:"InlineFragment",selections:g,type:"TriggerFieldLabel",abstractKey:null},{kind:"InlineFragment",selections:g,type:"TriggerFieldComparableText",abstractKey:null},{kind:"InlineFragment",selections:g,type:"TriggerFieldDynamicLoader",abstractKey:null}],storageKey:null}],type:"TriggerDefinition",abstractKey:null}],storageKey:null}]},params:{cacheID:"06f215b9c12c63e920e7749f25a15863",id:null,metadata:{},name:"FormBuilderTriggerFieldTriggerDefinitionQuery",operationKind:"query",text:"query FormBuilderTriggerFieldTriggerDefinitionQuery(\n  $id: ID!\n  $authId: ID\n) {\n  node(id: $id) {\n    __typename\n    ... on TriggerDefinition {\n      id\n      fields(authId: $authId) {\n        __typename\n        ... on TriggerFieldSelect {\n          __typename\n          key\n          ...FormBuilderTriggerFieldSelect_TriggerFieldSelect_2lEkG3\n        }\n        ... on TriggerFieldMultiSelect {\n          __typename\n          key\n          ...FormBuilderTriggerFieldMultiSelect_TriggerFieldMultiSelect_2lEkG3\n        }\n        ... on TriggerFieldText {\n          __typename\n          key\n          ...FormBuilderTriggerFieldText_TriggerFieldText\n        }\n        ... on TriggerFieldNumber {\n          __typename\n          key\n          ...FormBuilderTriggerFieldNumber_TriggerFieldNumber\n        }\n        ... on TriggerFieldDateTime {\n          __typename\n          key\n          ...FormBuilderTriggerFieldDateTime_TriggerFieldDateTime\n        }\n        ... on TriggerFieldRecurringSchedule {\n          __typename\n          key\n          ...FormBuilderTriggerFieldRecurringSchedule_TriggerFieldRecurringSchedule\n        }\n        ... on TriggerFieldCheckbox {\n          __typename\n          key\n          ...FormBuilderTriggerFieldCheckbox_TriggerFieldCheckbox\n        }\n        ... on TriggerFieldLindyEmbedConfig {\n          __typename\n          key\n        }\n        ... on TriggerFieldAutoObserve {\n          __typename\n          key\n        }\n        ... on TriggerFieldLindyMail {\n          __typename\n          key\n        }\n        ... on TriggerFieldLindyWebhook {\n          __typename\n          key\n        }\n        ... on TriggerFieldLindyPhoneNumber {\n          __typename\n          key\n        }\n        ... on TriggerFieldElevenLabsVoice {\n          __typename\n          key\n        }\n        ... on TriggerFieldLabel {\n          __typename\n          key\n        }\n        ... on TriggerFieldComparableText {\n          __typename\n          key\n        }\n        ... on TriggerFieldDynamicLoader {\n          __typename\n          key\n        }\n      }\n    }\n    nodeId\n  }\n}\n\nfragment FormBuilderTriggerFieldCheckbox_TriggerFieldCheckbox on TriggerFieldCheckbox {\n  __typename\n  key\n  label\n  description\n  isRequired\n}\n\nfragment FormBuilderTriggerFieldDateTime_TriggerFieldDateTime on TriggerFieldDateTime {\n  __typename\n  key\n  label\n  description\n  isRequired\n}\n\nfragment FormBuilderTriggerFieldMultiSelect_TriggerFieldMultiSelect_2lEkG3 on TriggerFieldMultiSelect {\n  __typename\n  key\n  label\n  description\n  isRequired\n  defaultItems: defaultValue\n  options(authId: $authId) {\n    label\n    value\n  }\n}\n\nfragment FormBuilderTriggerFieldNumber_TriggerFieldNumber on TriggerFieldNumber {\n  __typename\n  key\n  label\n  description\n  isRequired\n  min\n  max\n}\n\nfragment FormBuilderTriggerFieldRecurringSchedule_TriggerFieldRecurringSchedule on TriggerFieldRecurringSchedule {\n  __typename\n  key\n  label\n  placeholder\n  description\n  isRequired\n}\n\nfragment FormBuilderTriggerFieldSelect_TriggerFieldSelect_2lEkG3 on TriggerFieldSelect {\n  __typename\n  key\n  label\n  description\n  isRequired\n  defaultItem: defaultValue\n  options(authId: $authId) {\n    label\n    value\n  }\n}\n\nfragment FormBuilderTriggerFieldText_TriggerFieldText on TriggerFieldText {\n  __typename\n  key\n  label\n  description\n  placeholder\n  isRequired\n}\n"}}}();tx.hash="666d5cfe97092928328e506062b5e56c";let tb={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"FormBuilderTriggerFieldCheckbox_TriggerFieldCheckbox",selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isRequired",storageKey:null}],type:"TriggerFieldCheckbox",abstractKey:null};function ty(e){var t;let n=(0,u.useFragment)(tb,e.triggerFieldCheckboxFragmentRef);return(0,a.jsx)(to,{id:n.key,label:n.label,description:null!==(t=n.description)&&void 0!==t?t:void 0,value:"boolean"==typeof e.value&&e.value,onChange:e.onChange,disabled:e.disabled,required:n.isRequired})}tb.hash="83a7c0f57d7e2f7805622a4d5af666a0";var tj=n(20923);let tk={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"FormBuilderTriggerFieldDateTime_TriggerFieldDateTime",selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isRequired",storageKey:null}],type:"TriggerFieldDateTime",abstractKey:null};function tN(e){var t;let n=(0,u.useFragment)(tk,e.triggerFieldDateTimeFragmentRef);return(0,a.jsx)(td,{id:n.key,label:n.label,description:null!==(t=n.description)&&void 0!==t?t:void 0,value:"string"==typeof e.value?e.value:"",onChange:e.onChange,disabled:e.disabled,required:n.isRequired})}tk.hash="38b0be44712c43ca8ba59941101b7ab4";let tC=function(){var e={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"authId"}],kind:"Fragment",metadata:null,name:"FormBuilderTriggerFieldMultiSelect_TriggerFieldMultiSelect",selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},e,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isRequired",storageKey:null},{alias:"defaultItems",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},{alias:null,args:[{kind:"Variable",name:"authId",variableName:"authId"}],concreteType:"TriggerFieldOption",kind:"LinkedField",name:"options",plural:!0,selections:[e,{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],type:"TriggerFieldMultiSelect",abstractKey:null}}();function tF(e){var t,n;let l=(0,u.useFragment)(tC,e.triggerFieldMultiSelectFragmentRef),i=Array.isArray(e.value)?e.value:[...null!==(t=l.defaultItems)&&void 0!==t?t:[]];return(0,a.jsx)(tn,{id:l.key,label:l.label,description:null!==(n=l.description)&&void 0!==n?n:void 0,options:l.options.map(e=>({label:e.label,value:e.value})),value:i,onChange:e.onChange,disabled:e.disabled,required:l.isRequired})}tC.hash="868474107d2179909b12429d15fc5d4e";let tw={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"FormBuilderTriggerFieldNumber_TriggerFieldNumber",selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isRequired",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"min",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max",storageKey:null}],type:"TriggerFieldNumber",abstractKey:null};function tT(e){var t;let n=(0,u.useFragment)(tw,e.triggerFieldNumberFragmentRef),l=(0,d.useMemo)(()=>{var e,t;return{min:null!==(e=n.min)&&void 0!==e?e:null,max:null!==(t=n.max)&&void 0!==t?t:null}},[n]);return(0,a.jsx)(e6,{id:n.key,label:n.label,description:null!==(t=n.description)&&void 0!==t?t:void 0,value:"number"==typeof e.value?e.value:void 0,onChange:e.onChange,disabled:e.disabled,required:n.isRequired,validation:l})}tw.hash="20c45679639b9dc768320f4720a3921e";let tS={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"FormBuilderTriggerFieldRecurringSchedule_TriggerFieldRecurringSchedule",selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"placeholder",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isRequired",storageKey:null}],type:"TriggerFieldRecurringSchedule",abstractKey:null};tS.hash="b8b4eceaf12ef468237069848813751b";var tI=n(37473);function t_(e){var t;let n=(0,u.useFragment)(tS,e.triggerFieldRecurringScheduleFragmentRef);return(0,a.jsxs)("div",{children:[(0,a.jsx)(E.J,{className:"sr-only",htmlFor:n.key,children:n.label}),n.description&&(0,a.jsx)("p",{className:"sr-only my-2 text-xs text-slate-10",children:n.description}),(0,a.jsx)(e7,{required:n.isRequired}),(0,a.jsx)(tI.I,{placeholder:null!==(t=n.placeholder)&&void 0!==t?t:"",value:"string"==typeof e.value?e.value:"",onChange:e.onChange,isFromModal:!1},n.key)]})}let tz=function(){var e={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"authId"}],kind:"Fragment",metadata:null,name:"FormBuilderTriggerFieldSelect_TriggerFieldSelect",selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},e,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isRequired",storageKey:null},{alias:"defaultItem",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},{alias:null,args:[{kind:"Variable",name:"authId",variableName:"authId"}],concreteType:"TriggerFieldOption",kind:"LinkedField",name:"options",plural:!0,selections:[e,{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],type:"TriggerFieldSelect",abstractKey:null}}();function tL(e){var t,n;let l=(0,u.useFragment)(tz,e.triggerFieldSelectFragmentRef),i="string"==typeof e.value?e.value:null!==(t=l.defaultItem)&&void 0!==t?t:"";return(0,a.jsx)(tt,{id:l.key,label:l.label,description:null!==(n=l.description)&&void 0!==n?n:void 0,options:l.options.map(e=>({label:e.label,value:e.value})),value:null!=i?i:"",onChange:e.onChange,disabled:e.disabled,required:l.isRequired})}tz.hash="4b1483b426b436ca47f8a04151decca8";let tA={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"FormBuilderTriggerFieldText_TriggerFieldText",selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"placeholder",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isRequired",storageKey:null}],type:"TriggerFieldText",abstractKey:null};function tD(e){var t,n;let l=(0,u.useFragment)(tA,e.triggerFieldTextFragmentRef);return(0,a.jsx)(tu,{id:l.key,label:l.label,description:null!==(t=l.description)&&void 0!==t?t:void 0,value:"string"==typeof e.value?e.value:"",onChange:e.onChange,disabled:e.disabled,required:l.isRequired,validation:void 0,placeholder:null!==(n=l.placeholder)&&void 0!==n?n:void 0})}function tE(e){var t,n;let l=null===(n=(0,u.useLazyLoadQuery)(tx,{id:(0,tj.F)("TriggerDefinition",e.id),authId:e.authId}).node)||void 0===n?void 0:null===(t=n.fields)||void 0===t?void 0:t.find(t=>"%other"!==t.__typename&&t.key===e.fieldKey);return(null==l?void 0:l.__typename)==="TriggerFieldSelect"?(0,a.jsx)(tL,{triggerFieldSelectFragmentRef:l,value:e.value,onChange:e.onChange,disabled:e.disabled}):(null==l?void 0:l.__typename)==="TriggerFieldMultiSelect"?(0,a.jsx)(tF,{triggerFieldMultiSelectFragmentRef:l,value:e.value,onChange:e.onChange,disabled:e.disabled}):(null==l?void 0:l.__typename)==="TriggerFieldText"?(0,a.jsx)(tD,{triggerFieldTextFragmentRef:l,value:e.value,onChange:e.onChange,disabled:e.disabled}):(null==l?void 0:l.__typename)==="TriggerFieldNumber"?(0,a.jsx)(tT,{triggerFieldNumberFragmentRef:l,value:e.value,onChange:e.onChange,disabled:e.disabled}):(null==l?void 0:l.__typename)==="TriggerFieldDateTime"?(0,a.jsx)(tN,{triggerFieldDateTimeFragmentRef:l,value:e.value,onChange:e.onChange,disabled:e.disabled}):(null==l?void 0:l.__typename)==="TriggerFieldRecurringSchedule"?(0,a.jsx)(t_,{triggerFieldRecurringScheduleFragmentRef:l,value:e.value,onChange:e.onChange,disabled:e.disabled}):(null==l?void 0:l.__typename)==="TriggerFieldCheckbox"?(0,a.jsx)(ty,{triggerFieldCheckboxFragmentRef:l,value:e.value,onChange:e.onChange,disabled:e.disabled}):(0,a.jsx)("pre",{className:"whitespace-pre-wrap",children:JSON.stringify(l,null,2)})}tA.hash="49218d76fb7780ba0ba3c904cf3e81e5";let tM=(0,d.memo)(function(e){var t,n,l,i,r,s,o;let c=(0,u.useFragment)(ta,e.agentDefinitionFragmentRef),m=(0,d.useMemo)(()=>(0,tl.Zx)(e.field),[e.field]),p=(0,d.useMemo)(()=>{var e;return null==c?void 0:null===(e=c.stateGraph)||void 0===e?void 0:e.nodes.find(e=>"%other"!==e.__typename&&e.id===(null==m?void 0:m.nodeId))},[null==c?void 0:null===(t=c.stateGraph)||void 0===t?void 0:t.nodes,null==m?void 0:m.nodeId]),g=(0,d.useMemo)(()=>{var e;return p&&"ActionNode"===p.__typename&&(null===(e=p.actionDefinition)||void 0===e?void 0:e.action.dynamicLoaders)?p.actionDefinition.action.dynamicLoaders.loaders.map(e=>{var t,n;return{key:e.key,field:e.field,dependencies:[...e.dependencies],displayName:e.displayName,description:null!==(t=e.description)&&void 0!==t?t:void 0,placeholder:null!==(n=e.placeholder)&&void 0!==n?n:void 0,defaultValue:e.defaultValue?{name:e.defaultValue.name,value:e.defaultValue.value}:void 0,icon:(0,ti.LF)(e.icon,tr.YN)}}):[]},[p]);if(!p||!(null==m?void 0:m.fieldKey))return null;if("EntryPointTriggerNode"===p.__typename&&p.triggerDefinition){let t=p.triggerDefinition.fields.find(e=>"%other"!==e.__typename&&e.key===m.fieldKey);if(t&&"%other"!==t.__typename)return(0,a.jsx)(tE,{id:p.triggerDefinition.id,fieldKey:t.key,value:e.value,onChange:e.onChange,authId:null!==(l=e.authId)&&void 0!==l?l:null===(n=p.auth)||void 0===n?void 0:n.id,disabled:e.disabled})}return"ActionNode"===p.__typename&&p.actionDefinition?g.find(e=>e.key===m.fieldKey)?(0,a.jsx)(tv,{dynamicLoaders:g,value:e.value,onChange:e.onChange,authId:null!==(s=e.authId)&&void 0!==s?s:null===(r=p.auth)||void 0===r?void 0:r.id}):(0,a.jsx)(tp,{actionNodeFragmentRef:p,fieldKey:m.fieldKey,value:e.value,onChange:e.onChange,disabled:e.disabled,authId:null!==(o=e.authId)&&void 0!==o?o:null===(i=p.auth)||void 0===i?void 0:i.id}):(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-11",children:e.field}),(0,a.jsx)("pre",{className:"whitespace-pre-wrap",children:JSON.stringify(p,null,2)})]})});function tK(e){let t=(0,u.useFragment)(eB,e.identityFragmentRef),n=(0,u.useFragment)(eQ,e.agentDefinitionFragmentRef);if("Header"===e.element.type)return(0,a.jsx)(e3,{...e.element});if("Paragraph"===e.element.type)return(0,a.jsx)(te,{...e.element},e.element.id);if("Button"===e.element.type)return(0,a.jsx)("div",{className:"flex h-full flex-col justify-end",children:(0,a.jsx)(eX,{...e.element,label:e.element.label||"Submit",disabled:e.disabled,onClick:e.onClick})});if("CopyText"===e.element.type)return(0,a.jsx)(e4,{text:e.element.content},e.element.id);if("TextInput"===e.element.type)return(0,a.jsx)(tu,{...e.element,value:"string"==typeof e.value?e.value:"",disabled:e.disabled,onChange:e.onChange},e.element.id);if("NumberInput"===e.element.type)return(0,a.jsx)(e6,{...e.element,value:"number"==typeof e.value?e.value:void 0,onChange:e.onChange,disabled:e.disabled,required:e.element.required},e.element.id);if("SelectInput"===e.element.type&&e.element.submits)return(0,a.jsx)(tt,{...e.element,value:"string"==typeof e.value?e.value:void 0,disabled:e.disabled,onChange:e.onChange,required:e.element.required,addOtherOption:e.element.addOtherOption},e.element.id);if("SelectInput"===e.element.type&&!e.element.submits){let t=Array.isArray(e.value)?e.value:[];return(0,a.jsx)(tn,{...e.element,value:t,disabled:e.disabled,onChange:e.onChange,required:e.element.required,addOtherOption:e.element.addOtherOption},e.element.id)}return"AuthInput"===e.element.type?(0,a.jsx)(eZ,{identityFragmentRef:t,...e.element,value:"string"==typeof e.value?e.value:"",disabled:e.disabled,onChange:e.onChange}):"StateGraphNodeField"===e.element.type?(0,a.jsx)(eV.mF,{children:(0,a.jsx)(tM,{agentDefinitionFragmentRef:n,...e.element,disabled:e.disabled,value:e.value,onChange:e.onChange})}):null}var tR=n(88748);let tP={hidden:{opacity:0,translateY:"3%"},visible:{opacity:1,translateY:"0%",transition:{duration:.6,ease:"easeInOut",staggerChildren:.2}},exit:{opacity:0,translateY:"3%",transition:{duration:.4,ease:"easeInOut"}}},tO={hidden:{opacity:0,translateY:"3%"},visible:{opacity:1,translateY:"0%"},exit:{opacity:0,translateY:"3%"}};function tq(e){var t;let n=(0,u.useFragment)(eE,e.identityFragmentRef),l=(0,u.useFragment)(eM,e.agentDefinitionFragmentRef),i=(0,eh.aV)(),[r,s]=(0,d.useState)(()=>{var t,n;return t=e.data.elements,n=e.data.values,t.reduce((e,t)=>{if((0,tR.Rj)(t)){var a,l;e[t.id]=null!==(a=n[t.id])&&void 0!==a?a:"defaultValue"in t&&void 0!==t.defaultValue?t.defaultValue:"SelectInput"===t.type?void 0:(0,tR.Rj)(t)&&"defaultValue"in t?"number"==typeof t.defaultValue?String(t.defaultValue):null!==(l=t.defaultValue)&&void 0!==l?l:"":""}return e},{})}),o=(null===(t=e.data.illustration)||void 0===t?void 0:t.file)||null,{data:c}=(0,eP.I)({queryKey:["form-builder-image",o],queryFn:()=>o?fetch(o,{mode:"cors"}).then(e=>e.json()):null,enabled:!!o}),m=(0,d.useMemo)(()=>tB(e.data.elements,r),[r,e.data.elements]),[p,g]=(0,d.useState)(!1),h=(0,d.useCallback)(async t=>{let n=tB(e.data.elements,t);if(!n.isFormValid){console.error("Form validation failed",n.validationErrors),i({id:"form-validation-error",level:"danger",label:"Form Validation Error",message:"Please make sure that all fields are filled out correctly."});return}if(!e.sourceAction)return;g(!0);let a=await (0,v.F)({body:{conversationId:e.conversationId,actionExecutionId:e.sourceAction.executionId,actionTraceId:e.sourceAction.traceId,actionName:e.sourceAction.actionName,invocationIndex:e.sourceAction.invocationIndex,inputSubmission:{values:t,elements:e.data.elements},modifiedFields:[],toolCallId:e.sourceAction.toolCallId,codeBlockId:e.sourceAction.codeBlockId}});g(!1),a.error&&i({id:"form-submission-error",level:"danger",label:"Form Submission Error",message:a.error.message||"An error occurred while submitting the form."})},[e.conversationId,e.sourceAction,e.data.elements,i]),f=(0,d.useCallback)(async e=>{null==e||e.preventDefault(),await h(r)},[r,h]),x=(0,eq.useRouter)(),b=(0,d.useCallback)(()=>x.push("/home",void 0,{shallow:!0}),[x]),y=e=>(t,n)=>{let a={...r,[e]:t};s(a),n&&h(a)},j=e=>function(){"Button"===e.type&&("submit"===e.action&&f(),"skip"===e.action&&b())};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eK.p.Image,{imageData:c}),(0,a.jsx)("form",{className:"h-full",onSubmit:f,children:(0,a.jsx)(eO.P.div,{initial:"hidden",animate:"visible",exit:"exit",variants:tP,className:"relative flex h-full flex-col",children:e.data.elements.map((t,i)=>{var s;let o=r[t.id],d=i>0&&"Paragraph"===t.type&&(null===(s=e.data.elements.at(i-1))||void 0===s?void 0:s.type)==="Header",u="Button"===t.type&&"skip"===t.action,c=e.disableInteraction||p||"Button"===t.type&&"submit"===t.action&&!m.isFormValid;return(0,a.jsx)(eO.P.div,{variants:tO,className:(0,z.QP)("mt-10 first:mt-0 last:grow",d&&"mt-3",u&&"absolute -left-6 bottom-0 mt-0"),children:(0,a.jsx)(tK,{identityFragmentRef:n,agentDefinitionFragmentRef:l,element:t,elementIndex:i,disabled:c,value:o,onChange:y(t.id),onClick:j(t)},t.id)},t.id)})},"form")})]})}function tB(e,t){var n;let a=(function(e){let t={};for(let r of e){var n,a,l,i;switch(r.type){case"Header":case"Paragraph":case"Button":case"CopyText":case"Info":continue;case"TextInput":{let e=N.z.string();(null===(n=r.validation)||void 0===n?void 0:n.minLength)!=null?e=e.min(r.validation.minLength):r.required&&(e=e.min(1,"Please enter a value")),(null===(a=r.validation)||void 0===a?void 0:a.maxLength)!=null&&(e=e.max(r.validation.maxLength)),t[r.id]=r.required?e:e.optional();break}case"NumberInput":{let e=N.z.number();(null===(l=r.validation)||void 0===l?void 0:l.min)!=null&&(e=e.min(r.validation.min)),(null===(i=r.validation)||void 0===i?void 0:i.max)!=null&&(e=e.max(r.validation.max)),t[r.id]=r.required?e:e.optional();break}case"SelectInput":{let e=r.submits?N.z.string():N.z.array(N.z.string());t[r.id]=r.required?e:e.optional();break}case"AuthInput":t[r.id]=k.k.objectIdString();break;case"StateGraphNodeField":t[r.id]=N.z.string().or(N.z.array(N.z.string())).or(N.z.number()).or(N.z.boolean());break;default:throw new eR.j(r)}}return N.z.object(t)})(e).safeParse(t);return{isFormValid:a.success,validationErrors:null===(n=a.error)||void 0===n?void 0:n.flatten().fieldErrors}}var tQ=n(83664),tV=n(31634),tU=n(31024),tH=n(39274),tG=n(90508);let tY=(0,d.memo)(function(e){var t,n,l,i,s,o,u,c,m,p,g,h,f;let{conversationId:v,data:x,sourceAction:b,disableInteraction:y,customStatus:j,autoToggleOnStatusChange:k,customError:N}=e,C=(0,eq.useRouter)(),{submitState:F,disabled:w,submitForm:_,cancelForm:z,fieldErrorMessage:L}=T({conversationId:v,sourceAction:b,disableInteraction:y,customStatus:j}),A=(0,tQ.QT)({params:{id:null!==(h=x.template.ownerId)&&void 0!==h?h:""}}),D=(0,d.useCallback)(async e=>{e.preventDefault(),await _({templateId:x.template._id,alreadyInstalled:x.alreadyInstalled})},[_,x]),E=(0,d.useCallback)(e=>{var t;e.preventDefault(),C.push("/marketplace/author/".concat(null===(t=A.data)||void 0===t?void 0:t.id))},[C,null===(t=A.data)||void 0===t?void 0:t.id]),M=null===(n=x.template.icon)||void 0===n?void 0:n.color,R=(0,tG.hq)(null===(l=x.template.icon)||void 0===l?void 0:l.name);return(0,a.jsx)(r.L,{title:"Add ".concat(x.template.name),subtitle:function(e,t,n){switch(e){case"success":return"Lindy added successfully";case"error":return null!=n?n:"Error adding Lindy";case"canceled":return"Adding canceled"}if("canceled"===t)return"Form canceled"}(j,F,N),icon:(0,a.jsx)(tH.l,{icon:R,color:M,size:"sm"}),status:K(j,F,L),autoToggleOnStatusChange:k,hasUserInput:!0,children:(0,a.jsxs)("form",{className:"space-y-6",onSubmit:D,children:[(0,a.jsx)(tV.f,{top:!0,className:"pl-0.5",children:(0,a.jsxs)(tU.V,{left:!0,className:"gap-0",children:[(null===(i=x.template)||void 0===i?void 0:i.subTitle)&&(0,a.jsx)("div",{className:"-mt-1 text-sm font-normal text-slate-11",children:null===(s=x.template)||void 0===s?void 0:s.subTitle}),(null===(o=A.data)||void 0===o?void 0:o.id)&&(null===(u=A.data)||void 0===u?void 0:u.name)&&(0,a.jsxs)("button",{className:"text-sm font-normal text-primary-9 underline-offset-2 hover:underline ",tabIndex:-1,onClick:E,children:["by ",null!==(f=null===(c=A.data)||void 0===c?void 0:c.name)&&void 0!==f?f:"Lindy"]}),(0,a.jsx)("div",{className:"mt-4 text-sm font-medium text-slate-11",children:"Description"}),(0,a.jsx)("div",{className:"text-sm font-normal text-slate-12",children:null===(m=x.template)||void 0===m?void 0:m.description}),(0,a.jsx)("div",{className:"mt-4 text-sm font-medium text-slate-11",children:"Tools"}),(0,a.jsx)(tV.f,{className:"flex-wrap gap-8",children:null===(g=x.template)||void 0===g?void 0:null===(p=g.tools)||void 0===p?void 0:p.map((e,t)=>(0,a.jsxs)("span",{className:"flex items-center text-sm text-slate-12",children:[(0,a.jsx)(I.si,{tool:e.tool,className:"mr-2 h-4 w-4"}),e.tool]},t))})]})}),x.alreadyInstalled&&(0,a.jsx)("div",{className:"text-sm text-slate-12",children:"This Lindy is already added."}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(S.$,{size:"sm",type:"submit",level:"primary",disabled:w,children:x.alreadyInstalled?"Continue":"Add"}),(0,a.jsx)(S.$,{size:"sm",level:"outline",disabled:w,className:"text-slate-11",onClick:z,children:"Cancel"})]})]})})});var tW=n(10293),t$=n(90769),tZ=function(e){return e.ADD="add",e.REMOVE="remove",e.MODIFY="modify",e.LIST="list",e.NONE="none",e}({});let tJ=N.z.object({id:N.z.string(),label:N.z.string()}).and(N.z.discriminatedUnion("type",[N.z.object({type:N.z.enum(["text","textarea"]),initialValue:N.z.string().optional()}),N.z.object({type:N.z.literal("number"),initialValue:N.z.number().optional()}),N.z.object({type:N.z.literal("dropdown").describe("A dropdown menu. A single dropdown field can be used to display arbitrarily many options."),options:N.z.array(N.z.object({label:N.z.string(),value:N.z.string()})),initialValue:N.z.string().optional()})]));N.z.object({title:N.z.string(),tool:N.z.nativeEnum(_.h6).optional().describe("The name of the tool for which this form is built. It is used to display the correct tool icon in the UI."),formFields:N.z.array(tJ),submitButtonLabel:N.z.string().describe('The label of the submit button at the bottom of the form. E.g., "Send Email".')}),N.z.object({from:N.z.string(),to:N.z.array(N.z.string()),cc:N.z.array(N.z.string()).optional(),bcc:N.z.array(N.z.string()).optional(),subject:N.z.string(),body:N.z.string()}),N.z.object({type:N.z.nativeEnum(tZ),old:N.z.object({value:N.z.string(),_id:k.k.objectIdString()}).optional(),new:N.z.string().optional()}),N.z.object({title:N.z.string(),columns:N.z.array(N.z.object({key:N.z.string(),label:N.z.string().describe("Displayed to the user as the column's header"),type:N.z.enum(["text","link","date"])})),entries:N.z.array(N.z.record(N.z.unknown())).describe("Each entry is a row in the table, with keys corresponding to column keys")}),N.z.object({title:N.z.string()}),N.z.unknown().superBrand("UI_HANDLE").describe("Return this value to the system to render the built UI. It must be returned directly, with no other variables.\nEx: `return await ".concat(_.h6.UI,".buildTable(...)`")),N.z.record(N.z.any()).and(N.z.object({submissionId:N.z.string()})),t$.uk.pick({name:!0,instructions:!0,greetingMessage:!0,icon:!0}).extend({tools:N.z.array(t$.wl.omit({userAuthorized:!0}))}).partial();var tX=n(85739),t0=n(58522);let t1=(0,d.memo)(function(e){return(0,a.jsx)(t0.a,{...e,children:(0,a.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 12 13",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M6.875 3L8.09171 1.78329C8.54732 1.32768 9.28601 1.32768 9.74162 1.78329L10.7167 2.75838C11.1723 3.21399 11.1723 3.95268 10.7167 4.40829L9.5 5.625M6.875 3L0.920854 8.95415C0.811458 9.06355 0.75 9.21192 0.75 9.36663V11.75H3.13338C3.28809 11.75 3.43646 11.6885 3.54585 11.5792L9.5 5.625M6.875 3L9.5 5.625",stroke:"#687076",strokeWidth:"1.16667",strokeLinecap:"round",strokeLinejoin:"round"})})})});function t2(e){let{memory:t,type:n,handleSubmit:l,index:i,numMemories:r,setChangelog:s,disabled:o=!1}=e,[u,c]=(0,d.useState)(t.value),m=(0,d.useRef)(null),p=(0,d.useCallback)(()=>{m.current&&m.current.focus()},[m]),g=(0,d.useCallback)(e=>{s&&s(n=>{let a=[...n];return t.value!==e.target.value&&(n.some(e=>e._id===t._id)?a.find(e=>e._id===t._id).value=e.target.value:a.push({...t,value:e.target.value})),a}),c(e.target.value)},[s,c,t]),h=(0,d.useCallback)(()=>{l&&l(u)},[l,u]);return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:(0,z.QP)("flex items-center justify-between gap-2 odd:bg-slate-1 even:bg-transparent",0===i&&"rounded-t-md",r?i===r-1&&"rounded-b-md":0===i&&"rounded-b-md"),children:[(0,a.jsx)("input",{id:"memories",ref:m,className:(0,z.QP)("flex-1 border-none resize-none bg-transparent py-3 pl-4 w-full text-slate-12 border-slate-4 hover:border-slate-8 focus-within:border-primary-9 disabled:pointer-events-none text-xs",(n===tZ.REMOVE||n===tZ.NONE)&&"line-through"),onChange:g,value:u,disabled:o},"memories"),"none"!==n&&(0,a.jsx)("div",{className:"-mr-2 flex w-6 min-w-max pr-3",children:"remove"!==n&&(0,a.jsx)(tX.K,{tooltip:"Edit",disabled:o,className:"size-5 border border-transparent bg-none hover:border-slate-8",onClick:p,children:(0,a.jsx)(t1,{className:"size-[14px] rounded-none text-slate-9 shadow-none group-hover:text-slate-12"})})}),(n===tZ.REMOVE||n===tZ.MODIFY||n===tZ.ADD)&&(0,a.jsx)(S.$,{size:"sm",level:"primary",disabled:o,className:"rounded-md px-3 py-2 text-xs font-semibold text-white",onClick:h,children:"Save"})]})})}function t5(e){let{memoryDiff:t,handleSubmit:n,disabled:l}=e,i=(0,d.useMemo)(()=>t.new?{value:t.new}:null,[t.new]);return i?(0,a.jsx)(t2,{memory:i,type:tZ.ADD,handleSubmit:n,disabled:l}):null}function t4(e){var t;let{memoryDiff:n,handleSubmit:l,disabled:i}=e;return(null===(t=n.old)||void 0===t?void 0:t._id)?(0,a.jsx)(t2,{memory:n.old,type:tZ.REMOVE,handleSubmit:l,disabled:i}):null}function t9(e){var t;let{memoryDiff:n,handleSubmit:l,disabled:i}=e,r=(0,d.useMemo)(()=>{var e,t;return(null===(e=n.old)||void 0===e?void 0:e._id)&&n.new&&(null===(t=n.old)||void 0===t?void 0:t.value)?{...n.old,value:n.new}:null},[n.new,n.old]);return r&&(null===(t=n.old)||void 0===t?void 0:t._id)?(0,a.jsxs)("div",{children:[(0,a.jsx)(t2,{memory:n.old,type:tZ.NONE}),(0,a.jsx)(t2,{memory:r,type:tZ.MODIFY,handleSubmit:l,disabled:i})]}):null}let t3=(0,d.memo)(function(e){var t,n,l,i,s,o;let{conversationId:u,data:c,sourceAction:m,disableInteraction:p,customStatus:g}=e,{submitForm:h,disabled:f}=T({conversationId:u,sourceAction:m,disableInteraction:p,customStatus:g}),v=(0,d.useCallback)(e=>{h({memory:{value:"",type:tZ.NONE},data:{...c,new:e}})},[h,c]),x=(0,tW.f)();return(null===(t=x.data)||void 0===t?void 0:t._id)?(0,a.jsx)(r.L,{title:"".concat((null===(n=c.type[0])||void 0===n?void 0:n.toUpperCase())+c.type.slice(1)," a Memory"),icon:(0,a.jsx)(tH.l,{icon:(0,tG.hq)(null===(i=x.data)||void 0===i?void 0:null===(l=i.icon)||void 0===l?void 0:l.name),color:null===(o=x.data)||void 0===o?void 0:null===(s=o.icon)||void 0===s?void 0:s.color,size:"sm"}),hideSubtitleWhenOpen:!1,autoToggleOnStatusChange:!0,status:g,hasUserInput:!0,children:"modify"===c.type?(0,a.jsx)(t9,{memoryDiff:c,handleSubmit:v,disabled:f}):"remove"===c.type?(0,a.jsx)(t4,{memoryDiff:c,handleSubmit:v,disabled:f}):(0,a.jsx)(t5,{memoryDiff:c,handleSubmit:v,disabled:f})}):null}),t7=(0,d.memo)(function(e){var t,n,l,i,s;let{conversationId:o,data:u,sourceAction:c,disableInteraction:m,customStatus:p,autoToggleOnStatusChange:g}=e,h=(0,tW.f)(),f=null===(t=h.data)||void 0===t?void 0:t._id,{submitState:v,submitForm:x,disabled:b,fieldErrorMessage:y}=T({conversationId:o,sourceAction:c,disableInteraction:m,customStatus:p}),[j,k]=(0,d.useState)([]),N=(0,d.useCallback)(()=>{x({data:j})},[x,j]);return f&&u?(0,a.jsxs)(r.L,{title:"Things I have remembered",icon:(0,a.jsx)(tH.l,{icon:(0,tG.hq)(null===(l=h.data)||void 0===l?void 0:null===(n=l.icon)||void 0===n?void 0:n.name),color:null===(s=h.data)||void 0===s?void 0:null===(i=s.icon)||void 0===i?void 0:i.color,size:"sm"}),titleIsEditable:!1,hideSubtitleWhenOpen:!1,autoToggleOnStatusChange:g,status:K(p,v,y),hasUserInput:!0,children:[0===u.length&&(0,a.jsx)("p",{className:"text-sm text-slate-11",children:"No preferences found."}),u.map((e,t)=>e._id?(0,a.jsx)(t2,{memory:e,index:t,type:tZ.LIST,numMemories:u.length,setChangelog:k,disabled:b},e._id):null),j.length>0&&(0,a.jsx)("div",{className:"mt-2 flex justify-start",children:(0,a.jsx)(S.$,{level:"primary",onClick:N,children:"Save"})})]}):null});var t6=n(65832);let t8=(0,d.memo)(function(e){var t;let{conversationId:n,data:l,sourceAction:i,disableInteraction:s,customStatus:o,autoToggleOnStatusChange:u,customError:c,output:m,error:p,showSkipButton:g,isSkipping:h,onSkip:f}=e,{submitState:v,disabled:x,submitForm:b,cancelForm:y,fieldErrorMessage:j}=T({conversationId:n,sourceAction:i,disableInteraction:s,customStatus:o}),[k,N]=(0,d.useState)(l),C=(0,d.useCallback)(async e=>{e.preventDefault(),await b(k)},[b,k]),{actionName:F,actionDisplayName:w,tool:L}=null!=i?i:{};return(0,a.jsx)(r.L,{title:"".concat(null!==(t=null!=w?w:F)&&void 0!==t?t:"Confirm Action"),subtitle:function(e,t,n){switch(e){case"error":return null!=n?n:"Error performing action";case"canceled":return"Action canceled"}if("canceled"===t)return"Action canceled"}(o,v,c),icon:(0,a.jsx)(I.si,{tool:null!=L?L:_.h6.Lindy,className:"h-5 w-5"}),status:K(o,v,j),autoToggleOnStatusChange:u,hasSideEffects:!0,hasUserInput:!0,showSkipButton:g,isSkipping:h,onSkip:f,children:(0,a.jsxs)("form",{className:(0,z.QP)("space-y-6"),onSubmit:C,children:[(0,a.jsx)(t6.G,{input:k,onInputChange:N,disabled:x,output:m,error:p}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(S.$,{type:"submit",level:"primary",disabled:x,children:"Confirm"}),(0,a.jsx)(S.$,{level:"outline",disabled:x,onClick:y,children:"Cancel"})]})]})})});var ne=n(24194),nt=n(31928),nn=n(85397),na=n(78629);let nl=(0,d.memo)(function(e){return(0,a.jsxs)("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,a.jsx)("rect",{width:"20",height:"20",fill:"white"}),(0,a.jsx)("rect",{width:"20",height:"20",fill:"url(#paint0_linear_340_5119)"}),(0,a.jsx)("path",{d:"M9.30556 3.75H13.3601C13.7262 3.74999 14.042 3.74998 14.3021 3.77123C14.5767 3.79366 14.8497 3.84319 15.1125 3.97707C15.5045 4.17681 15.8232 4.49552 16.0229 4.88752C16.1568 5.15029 16.2063 5.42335 16.2288 5.6979C16.25 5.95802 16.25 6.27382 16.25 6.63989L16.25 7.91667H9.30556V3.75Z",fill:"url(#paint1_linear_340_5119)"}),(0,a.jsx)("path",{d:"M7.91667 3.75H6.6399C6.27385 3.74999 5.95801 3.74998 5.6979 3.77123C5.42335 3.79366 5.15029 3.84319 4.88752 3.97707C4.49552 4.17681 4.17681 4.49552 3.97707 4.88752C3.84319 5.15029 3.79366 5.42335 3.77123 5.6979C3.74998 5.95801 3.74999 6.2738 3.75 6.63985V7.91667H7.91667V3.75Z",fill:"url(#paint2_linear_340_5119)"}),(0,a.jsx)("path",{d:"M3.75 9.30556V13.3601C3.74999 13.7262 3.74998 14.042 3.77123 14.3021C3.79366 14.5766 3.84319 14.8497 3.97707 15.1125C4.17681 15.5045 4.49552 15.8232 4.88752 16.0229C5.15029 16.1568 5.42335 16.2063 5.6979 16.2288C5.95802 16.25 6.27382 16.25 6.63989 16.25L7.91667 16.25V9.30556H3.75Z",fill:"url(#paint3_linear_340_5119)"}),(0,a.jsx)("path",{d:"M9.30556 16.25L13.3601 16.25C13.7262 16.25 14.042 16.25 14.3021 16.2288C14.5767 16.2063 14.8497 16.1568 15.1125 16.0229C15.5045 15.8232 15.8232 15.5045 16.0229 15.1125C16.1568 14.8497 16.2063 14.5766 16.2288 14.3021C16.25 14.042 16.25 13.7262 16.25 13.3601L16.25 9.30556H9.30556V16.25Z",fill:"url(#paint4_linear_340_5119)"}),(0,a.jsxs)("defs",{children:[(0,a.jsxs)("linearGradient",{id:"paint0_linear_340_5119",x1:"20",y1:"-0.833333",x2:"-0.833335",y2:"22.5",gradientUnits:"userSpaceOnUse",children:[(0,a.jsx)("stop",{stopColor:"#A79EB1"}),(0,a.jsx)("stop",{offset:"1",stopColor:"#615F65"})]}),(0,a.jsxs)("linearGradient",{id:"paint1_linear_340_5119",x1:"15.8594",y1:"3.75",x2:"3.75",y2:"17.4219",gradientUnits:"userSpaceOnUse",children:[(0,a.jsx)("stop",{stopColor:"white"}),(0,a.jsx)("stop",{offset:"1",stopColor:"white",stopOpacity:"0.75"})]}),(0,a.jsxs)("linearGradient",{id:"paint2_linear_340_5119",x1:"15.8594",y1:"3.75",x2:"3.75",y2:"17.4219",gradientUnits:"userSpaceOnUse",children:[(0,a.jsx)("stop",{stopColor:"white"}),(0,a.jsx)("stop",{offset:"1",stopColor:"white",stopOpacity:"0.75"})]}),(0,a.jsxs)("linearGradient",{id:"paint3_linear_340_5119",x1:"15.8594",y1:"3.75",x2:"3.75",y2:"17.4219",gradientUnits:"userSpaceOnUse",children:[(0,a.jsx)("stop",{stopColor:"white"}),(0,a.jsx)("stop",{offset:"1",stopColor:"white",stopOpacity:"0.75"})]}),(0,a.jsxs)("linearGradient",{id:"paint4_linear_340_5119",x1:"15.8594",y1:"3.75",x2:"3.75",y2:"17.4219",gradientUnits:"userSpaceOnUse",children:[(0,a.jsx)("stop",{stopColor:"white"}),(0,a.jsx)("stop",{offset:"1",stopColor:"white",stopOpacity:"0.75"})]})]})]})});function ni(e){let{children:t}=e;return(0,a.jsx)(na.cq,{isInput:!0,children:t})}function nr(e){let{displayStacked:t,type:n,strValue:l}=e;switch(n){case"link":{let e=l.startsWith("http://")||l.startsWith("https://")?l:"https://".concat(l);return(0,a.jsxs)(ec.N,{className:"flex items-center",href:e,external:!0,children:[!t&&(0,a.jsx)(ne.A,{className:"mr-1 h-4 w-4 shrink-0 stroke-primary-9"}),(0,a.jsx)("p",{className:"truncate",children:l})]})}case"date":return(0,a.jsx)(ni,{children:new Date(l).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"numeric"})});case"text":return(0,a.jsx)(ni,{children:l})}}function ns(e){let{displayStacked:t,columns:n,row:l}=e;return(0,a.jsx)("tr",{className:t?"flex flex-col gap-1.5 py-2 first:pt-0 last:pb-0":"",children:n.map(e=>{var n;let i=null==(n=l[e.key])?"":String(n),r=(0,a.jsx)(nr,{displayStacked:t,type:e.type,strValue:i});return t?i?(0,a.jsxs)("td",{children:[(0,a.jsx)("p",{className:"truncate text-xs font-medium text-slate-11",children:e.label}),(0,a.jsx)("p",{className:"line-clamp-2 break-words text-slate-12",children:r})]},e.key):null:(0,a.jsx)("td",{className:"py-2.5 pr-2.5 last:pr-0",children:(0,a.jsx)("p",{className:"line-clamp-3 break-words text-slate-12",children:r})},e.key)})})}let no=(0,d.memo)(function(e){let{data:{title:t,columns:n,entries:l}}=e,i=n.length>3,s=i?2:5,[o,u]=(0,d.useState)(0),c=(0,d.useMemo)(()=>l.slice(o*s,(o+1)*s),[l,s,o]),m=l.length>s,p=Math.ceil(l.length/s);(0,d.useEffect)(()=>{o>=p&&u(Math.max(p-1,0))},[o,p]);let g=(0,d.useCallback)(()=>{o>=p-1||u(e=>e+1)},[o,p]),h=(0,d.useCallback)(()=>{o<=0||u(e=>e-1)},[o]);return(0,a.jsxs)(r.L,{title:t,icon:(0,a.jsx)(nl,{className:"h-5 w-5"}),children:[(0,a.jsxs)("table",{className:"w-full table-fixed border-collapse overflow-hidden",children:[(0,a.jsx)("thead",{className:i?"hidden":"",children:(0,a.jsx)("tr",{className:"w-full",children:n.map(e=>(0,a.jsx)("td",{className:"truncate pb-1 text-xs font-medium text-slate-12",children:e.label},e.key))})}),(0,a.jsx)("tbody",{className:"divide-y",children:c.map((e,t)=>(0,a.jsx)(ns,{displayStacked:i,columns:n,row:e},"row-".concat(t)))})]}),m&&(0,a.jsxs)("div",{className:"mt-6 flex items-center justify-end gap-2",children:[(0,a.jsxs)("p",{className:"text-sm text-slate-12",children:["Page ",o+1," of ",p]}),(0,a.jsx)(S.$,{level:"text",className:"p-1",disabled:0===o,onClick:h,children:(0,a.jsx)(nt.A,{className:"h-5 w-5 text-slate-12"})}),(0,a.jsx)(S.$,{level:"text",className:"p-1",disabled:o+1>=p,onClick:g,children:(0,a.jsx)(nn.A,{className:"h-5 w-5 text-slate-12"})})]})]})}),nd=(0,d.memo)(function(e){let{identityFragmentRef:t,agentDefinitionFragmentRef:n,ui:l,...i}=e,r=(0,u.useFragment)(s,t),d=(0,u.useFragment)(o,n);switch(l.type){case"form":return(0,a.jsx)(O,{data:l.data,...i});case"email-form":return(0,a.jsx)(Q,{data:l.data,...i});case"event-form":return(0,a.jsx)(eD,{data:l.data,...i});case"install-lindy":return(0,a.jsx)(tY,{data:l.data,...i});case"table":return(0,a.jsx)(no,{data:l.data});case"chart":return(0,a.jsx)(c,{data:l.data});case"memory":return(0,a.jsx)(t3,{data:l.data,...i});case"memory-list":return(0,a.jsx)(t7,{data:l.data,...i});case"non-custom":return(0,a.jsx)(t8,{data:l.data,...i});case"form-builder":return(0,a.jsx)(tq,{data:l.data,identityFragmentRef:r,agentDefinitionFragmentRef:d,...i});default:return(0,a.jsx)(a.Fragment,{})}}),nu=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{kind:"Variable",name:"input",variableName:"input"}],n={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"Error",abstractKey:"__isError"},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"SkipWakeUpTaskTriggerMutation",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"skipWakeUpTaskTrigger",plural:!1,selections:[n,a,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"SkipWakeUpTaskTriggerOutput",kind:"LinkedField",name:"data",plural:!1,selections:[{alias:null,args:null,concreteType:"Trigger",kind:"LinkedField",name:"trigger",plural:!1,selections:[l],storageKey:null}],storageKey:null}],type:"MutationSkipWakeUpTaskTriggerSuccess",abstractKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"SkipWakeUpTaskTriggerMutation",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"skipWakeUpTaskTrigger",plural:!1,selections:[n,a,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"SkipWakeUpTaskTriggerOutput",kind:"LinkedField",name:"data",plural:!1,selections:[{alias:null,args:null,concreteType:"Trigger",kind:"LinkedField",name:"trigger",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"nodeId",storageKey:null}],storageKey:null}],storageKey:null}],type:"MutationSkipWakeUpTaskTriggerSuccess",abstractKey:null}],storageKey:null}]},params:{cacheID:"c990f42ae107c70a5f3ef1911468e789",id:null,metadata:{},name:"SkipWakeUpTaskTriggerMutation",operationKind:"mutation",text:"mutation SkipWakeUpTaskTriggerMutation(\n  $input: SkipWakeUpTaskTriggerInput!\n) {\n  skipWakeUpTaskTrigger(input: $input) {\n    __typename\n    ... on Error {\n      __isError: __typename\n      message\n    }\n    ... on MutationSkipWakeUpTaskTriggerSuccess {\n      data {\n        trigger {\n          id\n          nodeId\n        }\n      }\n    }\n  }\n}\n"}}}();nu.hash="58dd3c7ae87030cce207187b13a21e8d";var nc=n(38001),nm=n(94559);let np=(0,b.In)("GET","/api/executionDetails/:id/trace/:traceid",C.get.data);var ng=n(51580),nh=n(76971),nf=n(89073);let nv=(0,d.createContext)(null);function nx(e){var t,n;let l=(0,nf.jE)(),i=null!==(t=e.executionId)&&void 0!==t?t:"",r=null!==(n=e.traceId)&&void 0!==n?n:"",s=function(e){let t=(0,d.useMemo)(()=>["executionDetails/[id]/trace/[traceid]","get",e.params.id,e.params.traceid],[e.params.id,e.params.traceid]),n=(0,nm.lB)(()=>null==e?void 0:e.options,[null==e?void 0:e.options]),a=(0,eP.I)({queryKey:t,queryFn:async()=>{let{data:t,error:n}=await np(e);if(n)throw n;return t},...null==e?void 0:e.options}),l=(0,nm.lB)(()=>a,[a]);return(0,ei.R)(t,l,n)}({params:{id:i,traceid:r},options:{enabled:null!=i&&null!=r,refetchOnMount:"always"}});return(0,ng.S)(nh.B.executionDetails,"updateTrace",i,e=>{var t;if(e._id!==r)return;let n=["executionDetails/[id]/trace/[traceid]","get",(t={params:{id:i,traceid:e._id}}).params.id,t.params.traceid];l.setQueryData(n,e)}),(0,a.jsx)(nv.Provider,{value:s,children:e.children})}var nb=n(72679),ny=n(81211),nj=n(2932),nk=n(40453);function nN(e){var t,n;let{identityFragmentRef:s,agentDefinitionFragmentRef:o,disableInteraction:c,executionId:m=""}=e,p=(0,u.useFragment)(l,s),g=(0,u.useFragment)(i,o),h=(0,d.useContext)(nv),{data:f}=(0,nc.LM)(),v=(0,ny.b)(),x=(0,eh.aV)(),b=(null==h?void 0:null===(t=h.data)||void 0===t?void 0:t.type)===j.UA.ActionExecution?h.data:void 0,y=(0,d.useMemo)(()=>{var e,t;return null===(t=v.data)||void 0===t?void 0:null===(e=t.nodes.find(e=>e._id==(null==b?void 0:b.stateGraphNodeId)))||void 0===e?void 0:e.displayName},[v.data,b]),k=(0,d.useMemo)(()=>{var e,t,n;return b?{executionId:m,traceId:b._id,actionName:b.actionName,actionDisplayName:null!==(e=null!=y?y:b.actionDisplayName)&&void 0!==e?e:b.actionName,tool:null!==(t=b.toolName)&&void 0!==t?t:_.h6.Lindy,invocationIndex:null!==(n=b.invocationIndex)&&void 0!==n?n:0,codeBlockId:b.codeBlockId,toolCallId:b.toolCallId}:void 0},[m,b,y]),N=(0,d.useMemo)(()=>{if(b){if(b.error)return"error";if(b.showLoading)return"loading";if(b.success)return"success";if(b.canceled)return"canceled";if(b.startTime&&!b.endTime)return(null==f?void 0:f.status)===nj.Y.Blocked?void 0:"loading"}},[b,null==f?void 0:f.status]),C=(null==b?void 0:b.error)?(0,nk.V4)(b.error):void 0,F=(0,d.useMemo)(()=>{if(!(null==b?void 0:b.actionCardUI))return;let e={...b.actionCardUI};return b.revisedActionCardFormData&&("object"==typeof e.data?e.data={...e.data,...b.revisedActionCardFormData}:e.data=b.revisedActionCardFormData),e},[b]),[w,T]=(0,nb.d)(nu),S=(0,d.useCallback)(async()=>{var e,t,n;let a=null==b?void 0:null===(e=b.createdWakeUpTaskTriggers)||void 0===e?void 0:e[0];if(!h||!a||a.disabled||!a.supportsEmptyPayload)return;let l=await w({variables:{input:{triggerId:a.id,payload:null}}});if(!l.skipWakeUpTaskTrigger.data){x({level:"danger",label:"Cannot skip trigger",message:null!==(n=l.skipWakeUpTaskTrigger.message)&&void 0!==n?n:"Cannot Skip the trigger",duration:5e3});return}h.setQueryData({...b,createdWakeUpTaskTriggers:null===(t=b.createdWakeUpTaskTriggers)||void 0===t?void 0:t.map(e=>e.id===a.id?{...e,disabled:!0}:e)})},[w,h,x,b]),z=(0,d.useMemo)(()=>{var e;let[t]=null!==(e=null==b?void 0:b.createdWakeUpTaskTriggers)&&void 0!==e?e:[];return t&&t.supportsEmptyPayload&&!t.disabled},[b]);if(!b||!f)return null;if(F)return(0,a.jsx)(nd,{identityFragmentRef:p,agentDefinitionFragmentRef:g,conversationId:f._id,ui:F,autoToggleOnStatusChange:!0,disableInteraction:c,sourceAction:k,customStatus:N,customError:C,output:b.output,error:b.error,showSkipButton:z,isSkipping:T,onSkip:S});{let{toolName:e,actionDisplayName:t,input:l,output:i,error:s,hasSideEffects:o}=b,d=Array.isArray(l)&&l.length>0||!!i||!!s;return(0,a.jsx)(r.L,{title:null!==(n=null!=y?y:t)&&void 0!==n?n:"Action",icon:(0,a.jsx)(I.si,{tool:null!=e?e:_.h6.Lindy,className:"size-5"}),startExpanded:!!o,autoToggleOnStatusChange:!1,expandable:d,subtitle:function(e){if("savePreference"===e.actionName){var t;return e.success&&e.input&&Array.isArray(e.input)&&(null===(t=e.input[0])||void 0===t?void 0:t.name)?e.input[0].name:void 0}}(b),status:N,hasSideEffects:!!o,showSkipButton:z,isSkipping:T,onSkip:S,children:(0,a.jsx)(t6.G,{input:l,output:i,error:s})})}}function nC(e){return(0,a.jsx)(nx,{executionId:e.executionId,traceId:e.traceId,children:(0,a.jsx)(nN,{...e})})}},99772:(e,t,n)=>{"use strict";n.d(t,{$:()=>o});var a=n(77253),l=n(59664),i=n(43606),r=new WeakMap,s=new WeakMap;class o{addHandler(e){return(0,a._)(this,r).push(e),this}match(e){var t;let n=(0,a._)(this,r).find(t=>e.type===t.type&&(!t.match||t.match(e)));return null!==(t=null==n?void 0:n.components)&&void 0!==t?t:(0,a._)(this,s)}canHandle(e){return null!=(0,a._)(this,s)||null!=this.match(e)}addFallback(e){return(0,i._)(this,s,e),this}clone(){let e=new o;return(0,i._)(e,r,[...(0,a._)(this,r)]),e}constructor(){(0,l._)(this,r,{writable:!0,value:[]}),(0,l._)(this,s,{writable:!0,value:null})}}},20292:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var a=n(50612),l=n(35774),i=n(25919);let r={opacity:0,scale:.9},s={opacity:1,scale:1},o={type:"tween",duration:.15,ease:"easeOut"};function d(e){let{className:t,onClick:n,children:d}=e;return(0,a.jsx)(l.P.div,{className:(0,i.QP)("select-none rounded-xl bg-white p-3 border-slate-5 border-1 dark:bg-slate-3 overflow-hidden",t),initial:r,animate:s,transition:o,onClick:n,children:d})}},33296:(e,t,n)=>{"use strict";n.d(t,{xd:()=>v,A8:()=>f,l3:()=>b,RD:()=>y});var a=n(50612),l=n(94344),i=n(25919),r=n(47565),s=n.n(r);let o=(0,l.memo)(function(e){let{isLatestToken:t,children:n}=e,[r,o]=(0,l.useState)(!1);(0,l.useEffect)(()=>{if(o(!1),t){let e=setTimeout(()=>{o(!0)},500);return()=>clearTimeout(e)}},[t]);let d=t&&!r,u=/^\s*$/.test(n);return(0,a.jsx)("span",{className:(0,i.QP)("bg-clip-text bg-gradient-to-r transition ease-out","from-[hsl(234,100%,69%)] via-[hsl(216,87%,49%)] to-[hsl(191,100%,56%)]","dark:to-[hsl(234,100%,69%)] dark:via-[hsl(216,87%,49%)] dark:from-[hsl(191,100%,56%)]",u?"inline":"inline-block",s().enter,r?"duration-[1500ms]":"duration-150",d?"text-transparent":"text-inherit"),children:n})});var d=n(958),u=n(71304),c=n(65455),m=n(76263);let p=(0,l.memo)(function(e){let{children:t}=e,n=Array.isArray(t)?t:[t];return(0,a.jsx)(a.Fragment,{children:n.map((e,t)=>"string"==typeof e?(0,a.jsx)(g,{isLatestChunk:t===n.length-1,children:e},t):e)})}),g=(0,l.memo)(function(e){let{isLatestChunk:t,children:n}=e,i=n.split(" ").map(e=>{if(e.length<=30)return e;let t=[];for(let n=0;n<e.length;n+=30)t.push(e.slice(n,n+30));return t});return(0,a.jsx)(a.Fragment,{children:i.map((e,n)=>{let r=t&&n===i.length-1;return(0,a.jsxs)(l.Fragment,{children:[n>0&&" ","string"==typeof e?(0,a.jsx)(o,{isLatestToken:r,children:e}):e.map((e,t)=>(0,a.jsx)(o,{isLatestToken:r,children:e},t))]},n)})})}),h=e=>e.stopPropagation(),f=function(e){let{node:t,href:n,target:l,children:i}=e;return(0,a.jsx)("a",{className:"dark:text-white",href:n,target:l,onClick:h,children:i})},v=function(e){var t;let{node:n,className:l,children:i}=e,{isDark:r}=(0,d.G)();if(null==n?void 0:null===(t=n.properties)||void 0===t?void 0:t.inline)return(0,a.jsx)("code",{className:"!m-0 !overflow-hidden !rounded-none",children:i});{let e=/language-(\w+)/.exec(null!=l?l:"");return(0,a.jsx)(u.A,{language:null==e?void 0:e[1],PreTag:"div",style:r?c.A:m.A,className:"!m-0 !overflow-hidden !rounded-none",wrapLongLines:!0,children:String(i).trimEnd()})}};function x(e){let t={a:f,code:v};return["p","h1","h2","h3","h4","h5","h6","li","em","strong","del","th","td"].forEach(n=>{t[n]=function(t){let{children:i}=t;return i=function e(t){return"string"==typeof t?t.split("\n").map((e,t)=>(0,a.jsxs)(l.Fragment,{children:[t>0&&(0,a.jsx)("br",{}),e]},t)):Array.isArray(t)?t.map(e):t}(i),(0,a.jsx)(n,{children:e?(0,a.jsx)(p,{children:i}):(0,a.jsx)("span",{children:i})})}}),t}let b=x(!0),y=x(!1)},54345:(e,t,n)=>{"use strict";n.d(t,{l:()=>i});var a=n(36441),l=n(94344);function i(e,t){let n=(0,l.useRef)(void 0);(0,l.useEffect)(()=>{let t=(0,a.fm)(t=>{var a;null===(a=n.current)||void 0===a||a.call(n);let l=e(t);n.current=()=>{null==l||l()}});return()=>{var e;t(),null===(e=n.current)||void 0===e||e.call(n),n.current=void 0}},t)}},55663:(e,t,n)=>{"use strict";n.d(t,{B:()=>o});var a=n(52105),l=n(22830);let i=(0,a.In)("PATCH","/api/identity",l.w.patch.data);var r=n(94344),s=n(77576);let o=()=>{let e=(0,s.U)();return(0,r.useEffect)(()=>{if(e.data){let t=Intl.DateTimeFormat().resolvedOptions().timeZone;t!==e.data.timeZone&&i({body:{timeZone:t}})}},[e.data]),Intl.DateTimeFormat().resolvedOptions().timeZone}},88991:(e,t,n)=>{"use strict";n.d(t,{A:()=>g,l:()=>p});var a=n(50612),l=n(44737),i=n(33649),r=n(25441),s=n(89339),o=n(86937),d=n(8678),u=n(94344),c=n(11636),m=n(18867);function p(e){return"number"==typeof e?e:/^[A-Za-z-]+$/.test(e)?(0,o.De)(e):e}let g=(0,d.PA)(function(e){var t;let n=(0,u.useRef)(null);(0,l._M)(()=>{var e;null===(e=n.current)||void 0===e||e.focus({preventScroll:!0})});let o=(0,u.useCallback)(t=>{if(t.target.value===r.D){e.member.setManualValue(void 0);return}e.member.setManualValue(t.target.value)},[e.member]),d=null!==(t=e.member.value)&&void 0!==t?t:r.D;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.R,{member:e.member}),(0,a.jsx)(c.K,{member:e.member,children:(0,a.jsxs)(i.l,{id:(0,s.g7)(e.member.path),ref:n,value:d,onChange:o,children:[e.member.context.isNullish&&(0,a.jsx)("option",{value:r.D,children:"Select an option"}),e.member.options.map(e=>(0,a.jsx)("option",{value:e,children:p(e)},e))]})})]})})},11636:(e,t,n)=>{"use strict";n.d(t,{K:()=>h});var a=n(50612),l=n(44737),i=n(8678),r=n(58762),s=n(20335),o=n(66679),d=n(90076),u=n(89339),c=n(94344),m=n(25919);let p=(0,i.PA)(function(e){let t=(0,l.uQ)(),[n,i]=(0,c.useState)(!1),[p,g]=(0,c.useState)(!1),h=(0,c.useCallback)(()=>{i(!0)},[]),f=(0,c.useCallback)(()=>{i(!1),g(!1)},[]),v=(0,c.useCallback)(n=>{if("Tab"===n.key){p||n.shiftKey?p&&n.shiftKey&&(g(!1),n.preventDefault()):(g(!0),n.preventDefault());return}if("Delete"===n.key||"Backspace"===n.key||"Enter"===n.key){t(""),e.member.setType(p?"ai":"manual"),n.preventDefault();return}},[p,e.member,t]),x=(0,c.useCallback)(n=>{t(n),e.member.setType(p?"ai":"manual")},[p,e.member,t]),b=(0,c.useCallback)(()=>{t(""),e.member.setType("manual")},[e.member,t]),y=(0,c.useCallback)(()=>{t(""),e.member.setType("ai")},[e.member,t]);return(0,a.jsxs)("div",{className:"group relative","data-testid":"action-config-input","data-field-type":"auto","data-label":(0,d.C)(e.member),"data-path":(0,u.Fd)(e.member.path),children:[(0,a.jsx)(s.pd,{className:(0,m.QP)("cursor-pointer",r.G8,n&&(p?r.VU:r._y)),onFocus:h,onBlur:f,onKeyDown:v,onChange:x}),(0,a.jsxs)("div",{className:"pointer-events-none absolute inset-0 flex items-center gap-2 pl-2",children:[(0,a.jsx)("div",{className:(0,m.QP)("rounded px-2 py-0.5 text-xs transition","block group-focus-within:hidden","bg-slate-3 text-slate-10","group-hover:bg-slate-4"),children:"AI will automatically fill this field"}),(0,a.jsxs)(o.m_,{children:[(0,a.jsx)(o.ZI,{children:"Enter the value for this field manually"}),(0,a.jsx)(o.k$,{asChild:!0,children:(0,a.jsx)("button",{tabIndex:-1,onClick:b,className:(0,m.QP)("rounded px-2 py-0.5 text-xs transition pointer-events-auto","hidden group-focus-within:block","bg-slate-4 text-slate-11 hover:bg-blue-5 hover:text-blue-11","focus:outline-none",!p&&"bg-blue-4 text-blue-11 ring-2 ring-blue-8"),children:"Set manually"})})]}),(0,a.jsxs)(o.m_,{children:[(0,a.jsx)(o.ZI,{children:"Let AI fill out this field using the prompt and context of the previous steps"}),(0,a.jsx)(o.k$,{asChild:!0,children:(0,a.jsx)("button",{tabIndex:-1,onClick:y,className:(0,m.QP)("rounded px-2 py-0.5 text-xs transition pointer-events-auto","hidden group-focus-within:block","bg-slate-4 text-slate-11 hover:bg-purple-5 hover:text-purple-11","focus:outline-none",p&&"bg-purple-4 text-purple-11 ring-2 ring-purple-8"),children:"Prompt AI"})})]})]})]})});var g=n(91166);let h=(0,i.PA)(function(e){return"ai"===e.member.controlType?(0,a.jsx)(l.is,{children:(0,a.jsx)(g.Z,{member:e.member})}):"auto"===e.member.controlType?(0,a.jsx)(l.is,{children:(0,a.jsx)(p,{member:e.member})}):(0,a.jsx)(l.is,{children:e.children})})},91166:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var a=n(50612),l=n(89339),i=n(8678),r=n(83466);let s=(0,i.PA)(function(e){return(0,a.jsx)(r.JH,{node:e.member.context.node,onChange:e.member.setPrompt,value:e.member.prompt,placeholder:"Write a prompt",pathDot:(0,l.Fd)(e.member.path),labelledBy:(0,l.g7)(e.member.path),letAiDecide:!0},"ai")})},18867:(e,t,n)=>{"use strict";n.d(t,{R:()=>T,t:()=>S});var a=n(50612),l=n(86278),i=n(57577),r=n(85739),s=n(22283),o=n(41285),d=n(99100),u=n(38959),c=n(96004),m=n(90076),p=n(89339),g=n(8678),h=n(94344),f=n(91141),v=n(42009),x=n(14662),b=n(64145),y=n(13965),j=n(35853),k=n(25919);function N(e){return(0,a.jsx)("div",{className:(0,k.QP)("auto"===e.type&&"text-[#46A758] bg-green-2 hover:bg-green-3","ai"===e.type&&"text-[#8E4EC6] bg-purple-2 hover:bg-purple-3","manual"===e.type&&"text-blue-9 bg-blue-3 hover:bg-blue-4","flex h-[20px] items-center justify-center gap-x-0.5 rounded-full px-2 text-xs transition","focus-visible:ring-2 ring-primary-2 focus:outline-none","whitespace-nowrap"),children:e.children})}let C=(0,h.memo)(function(e){return(0,a.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",...e,children:[(0,a.jsx)("path",{d:"M6.20981 6.60005C6.09143 6.72786 6.09143 6.92527 6.20981 7.05307L6.22572 7.07025C6.35755 7.21258 6.58259 7.2127 6.71457 7.07052L7.7557 5.94894C7.88758 5.80687 8.11242 5.80687 8.2443 5.94894L9.28543 7.07052C9.41741 7.2127 9.64245 7.21258 9.77428 7.07025L9.79019 7.05307C9.90857 6.92527 9.90857 6.72786 9.79019 6.60005L8.24455 4.93134C8.11262 4.78891 7.88738 4.78891 7.75545 4.93134L6.20981 6.60005Z"}),(0,a.jsx)("path",{d:"M9.79019 9.39995C9.90857 9.27214 9.90857 9.07473 9.79019 8.94693L9.77428 8.92975C9.64245 8.78742 9.41741 8.7873 9.28543 8.92948L8.2443 10.0511C8.11242 10.1931 7.88758 10.1931 7.7557 10.0511L6.71457 8.92948C6.58259 8.7873 6.35755 8.78742 6.22572 8.92975L6.20981 8.94693C6.09143 9.07473 6.09143 9.27214 6.20981 9.39995L7.75545 11.0687C7.88738 11.2111 8.11262 11.2111 8.24455 11.0687L9.79019 9.39995Z"})]})}),F={auto:{icon:(0,a.jsx)(b.h,{className:"mr-0.5 size-3",fill:"#46A758"}),label:"Auto",description:"AI will fill out the field using the context of the previous steps"},ai:{icon:(0,a.jsx)(x.m,{className:"mr-0.5 size-3",fill:"#8E4EC6"}),label:"Prompt AI",description:"AI will fill out the field using the prompt and context of the previous steps"},manual:{icon:(0,a.jsx)(y.h,{className:"mr-0.5 size-3",fill:"#007AFF"}),label:"Set Manually",description:"Enter the value for this field manually"}},w=(0,g.PA)(function(e){let t=(0,h.useCallback)(t=>()=>{e.onChange(t)},[e]);return(0,a.jsx)(f.W1,{as:"div",children:n=>{let{open:l}=n;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"relative inline-block",children:(0,a.jsx)(f.IU,{"aria-label":"Input type selection",children:(0,a.jsxs)(N,{type:e.type,children:[F[e.type].icon,F[e.type].label,(0,a.jsx)(C,{className:"-mr-1"})]})})}),(0,a.jsxs)(v.$b,{anchor:"bottom end",className:"w-56",open:l,children:[(0,a.jsxs)(j.bF,{onClick:t("manual"),className:"flex flex-col items-start gap-y-1 px-3 py-2",children:[(0,a.jsxs)(N,{type:"manual",children:[F.manual.icon,F.manual.label]}),(0,a.jsx)("p",{className:"mt-2 whitespace-normal text-left text-xs text-slate-9",children:F.manual.description})]}),(0,a.jsxs)(j.bF,{onClick:t("ai"),className:"flex flex-col items-start gap-y-1 px-3 py-2",children:[(0,a.jsxs)(N,{type:"ai",children:[F.ai.icon,F.ai.label]}),(0,a.jsx)("p",{className:"mt-2 whitespace-normal text-left text-xs text-slate-9",children:F.ai.description})]}),(0,a.jsxs)(j.bF,{onClick:t("auto"),className:"flex flex-col items-start gap-y-1 px-3 py-2",children:[(0,a.jsxs)(N,{type:"auto",children:[F.auto.icon,F.auto.label]}),(0,a.jsx)("p",{className:"mt-2 whitespace-normal text-left text-xs text-slate-9",children:F.auto.description})]})]})]})}})}),T=(0,g.PA)(function(e){var t;let n=(0,h.useCallback)(()=>{var t;null===(t=e.member.context.array)||void 0===t||t.deleteItem(e.member.path)},[e.member.path,e.member.context.array]),u=(0,h.useCallback)(t=>{e.member.setType(t)},[e.member]),[g,f]=(0,h.useMemo)(()=>{let t=(0,p.g7)(e.member.path);return e.member instanceof c.x||"type"in e.member&&"ai"===e.member.type?[void 0,t]:[t,void 0]},[e.member]),v=(0,m.C)(e.member),x=(0,m.i)(e.member);return(0,a.jsx)("div",{className:"flex w-full flex-col",children:(0,a.jsxs)("div",{className:"mb-1.5",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)(o.J,{id:f,htmlFor:g,className:"mb-0 flex justify-between text-slate-11",children:v}),(0,a.jsxs)("div",{className:"flex gap-2",onClick:d.d,children:[!(t=e.member).context.isArrayMember&&!t.context.isUnionMember&&null!=t.controlType&&(0,a.jsx)(w,{type:e.member.controlType,onChange:u}),S(e.member)&&(0,a.jsx)(r.K,{tooltip:"Remove",className:"mr-0 size-6 border border-transparent bg-none hover:border-slate-7",onClick:n,"aria-label":"Remove item",role:"button",children:(0,a.jsx)(l.A,{className:"size-4 text-slate-9 group-hover:text-slate-12"})})]})]}),!!x&&(0,a.jsx)("div",{onClick:d.d,children:(0,a.jsx)(i.a,{className:"text-xs font-medium text-slate-9",children:(0,a.jsx)(s.o,{className:"[&_a:hover]:no-underline [&_a]:underline",allowHTML:!1,disableCopyUI:!0,isInput:!1,children:x})})})]})})});function S(e){return e.context.parent instanceof u.P}},83466:(e,t,n)=>{"use strict";n.d(t,{JH:()=>J});var a=n(50612),l=n(24704),i=n(19265),r=n(77057),s=n(37816),o=n(8505),d=n(26768),u=n(1796),c=n(54345),m=n(91318),p=n(94724),g=n(44737),h=n(20335),f=n(56993),v=n(39704),x=n(8678),b=n(94344),y=n(25919),j=n(33762),k=n(21690),N=n(97036),C=n(96929);let F={boxShadow:"0px 4px 12px 0px #0000001F"};function w(e){let{refs:t,floatingStyles:n,context:l}=(0,k.we)({placement:"left-start",open:e.isOpen,whileElementsMounted:N.ll,middleware:[(0,C.cY)(9),(0,C.BN)({padding:50})]}),i=(0,k.Mk)(l),{getReferenceProps:r,getFloatingProps:s}=(0,k.bv)([i]),o=(0,b.useMemo)(()=>({...F,...n}),[n]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{ref:t.setReference,...r(),children:e.trigger}),e.isOpen&&(0,a.jsx)(k.XF,{children:(0,a.jsx)("div",{"data-testid":"action-output-menu-popover",ref:t.setFloating,...s(),style:o,className:"z-10 rounded-lg bg-white shadow-lg dark:bg-slate-1",children:e.menu})})]})}var T=n(8178),S=n(45801),I=n(71792);let _=(0,x.PA)(function(e){let{item:t,onClick:n}=e,l=(0,b.useCallback)(()=>{n(t)},[n,t]);return(0,a.jsx)("li",{children:(0,a.jsx)("button",{onClick:l,className:(0,y.QP)("rounded bg-indigo-4 px-1.5 py-0.5 text-sm text-indigo-9 transition hover:bg-indigo-5","focus:outline-none focus:border-primary-9 focus:ring-2 focus:ring-primary-9"),children:t.displayName||t.path})})});var z=n(84785);let L=(0,x.PA)(function(e){let{value:t,onChange:n}=e,l=(0,b.useCallback)(e=>{n(e.target.value)},[n]);return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{className:(0,y.QP)(h.dp,"h-8 w-full rounded-md border border-slate-4 pl-7 pr-2 py-1.5 text-sm text-slate-12 transition"),value:t,onChange:l}),(0,a.jsx)(z.A,{className:"absolute left-2 top-2 size-4 text-slate-10"})]})});var A=n(25054),D=n(26042),E=n(5808),M=n(7461),K=n(46251);let R=(0,x.PA)(function(e){let{searchValue:t,nodeId:n,children:l}=e,i=(0,A.JL)(n),[r,s]=(0,b.useState)(!!t),o=null==i?void 0:i.tool,d=(0,I.HY)(i)?i.occurrence:null,u=!!(0,I.HY)(i)&&i.isRepeatedAction,c=null==i?void 0:i.displayNamePrimary,m=null==i?void 0:i.displayNameSecondary,p=null!=c?c:m,g=(0,b.useCallback)(()=>{s(e=>!e)},[]);return i&&((0,M.c_)(i.data)||(0,M.gj)(i.data))&&p&&(!u||d)&&o?(0,a.jsx)(E.N,{isOpen:r,onToggle:g,header:(0,a.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 overflow-x-hidden",children:[(0,a.jsx)(K.si,{tool:o,className:"size-5 shrink-0"}),(0,a.jsx)("span",{className:"truncate text-nowrap text-sm text-slate-10",title:p,children:p})]}),u&&d&&(0,a.jsx)(D.u,{occurrence:d})]}),children:(0,a.jsx)("ul",{className:"flex w-full flex-col gap-y-2 py-4",children:l})}):null}),P=(0,x.PA)((0,b.forwardRef)(function(e,t){let{onClickItem:n,outputReferences:l}=e,i=(0,T.H)(),r=null==i?void 0:i.selectedEntity,[s,o]=(0,b.useState)(""),d=(0,m.q2)(()=>{let e={};for(let n of l){var t;if(!n.path.toLowerCase().replace(".","").includes(s.toLowerCase()))continue;let a=null!==(t=e[n.nodeId])&&void 0!==t?t:[];a.push(n),e[n.nodeId]=a}return e},[l,s]);return 0!==Object.keys(d).length&&(0,I.HY)(r)?(0,a.jsxs)("div",{ref:t,className:(0,y.QP)("grid max-h-[620px] min-h-[480px] w-80 grid-rows-[auto,1fr]",S.Oc),children:[(0,a.jsx)("div",{className:"border-b border-b-slate-4 p-4",children:(0,a.jsx)(L,{value:s,onChange:o})}),(0,a.jsx)("div",{className:(0,y.QP)("overflow-y-auto overflow-x-hidden p-4 flex flex-col w-full gap-y-2",S.Oc),children:Object.entries(d).map(e=>{let[t,l]=e;return(0,a.jsx)(R,{nodeId:t,searchValue:s,children:l.map(e=>(0,a.jsx)(_,{item:e,onClick:n},t+e.path))},t+s)})})]}):null}));var O=n(14952),q=n(94783),B=n(66679);let Q=(0,b.createContext)(null),V=(0,x.PA)(function(e){let{nodeId:t,path:n,displayName:l}=e,i=(0,b.useContext)(Q);if(!i)throw Error("Node store not provided via context");let r=(0,m.q2)(()=>new Set(i.upstreamNodes.map(e=>e.id)).has(t),[i,t]),s=(0,A.JL)(t),o=null==s?void 0:s.tool,d=(0,I.HY)(s)?s.occurrence:null,u=!!(0,I.HY)(s)&&s.isRepeatedAction,c=o?r?void 0:"Referencing a detached node":"Referencing a deleted node";return c?(0,a.jsxs)(B.m_,{children:[(0,a.jsx)(B.ZI,{children:c}),(0,a.jsx)(B.k$,{children:(0,a.jsxs)("span",{className:(0,y.QP)("relative inline-flex text-sm items-center gap-x-1 whitespace-nowrap p-0.5 align-baseline leading-[21px]","border border-solid border-danger-6 bg-danger-4 transition-colors rounded-md pl-6 text-danger-10 select-none"),children:[(0,a.jsx)("span",{className:"absolute inset-y-0 left-0 flex w-7 items-center justify-center",children:(0,a.jsx)(q.A,{className:"mr-1 inline-flex size-4 shrink-0 items-center justify-center fill-danger-10"})}),"Error"]})})]}):(0,a.jsxs)("span",{className:(0,y.QP)("relative inline-flex text-sm items-center gap-x-1 whitespace-nowrap p-0.5 align-baseline leading-[21px]","border border-solid bg-indigo-4 text-indigo-9 transition-colors rounded-md mx-0.5 border-indigo-6",o&&"pl-8 pr-1"),children:[o&&(0,a.jsx)("span",{className:"absolute inset-y-0 left-0 flex w-7 items-center justify-center",children:(0,a.jsx)(K.si,{className:"size-5",tool:o})}),null!=l?l:n,null!=d&&u&&(0,a.jsx)(D.u,{occurrence:d})]})});class U extends f.Kp{static getType(){return"ActionOutputReferenceDecoratorNode"}static clone(e){return new U({...e.__valueReference})}createDOM(){return document.createElement("span")}updateDOM(){return!1}exportJSON(){return{type:U.getType(),version:1,valueReference:this.__valueReference}}static importJSON(e){return new U(e.valueReference)}exportDOM(){let e=document.createElement("span");return e.dataset.valueReference=JSON.stringify(this.__valueReference),{element:e}}static importDOM(){return{span:e=>e.dataset.valueReference?{conversion:e=>{if(!e.dataset.valueReference)throw Error("Missing value reference data");return{node:new U(JSON.parse(e.dataset.valueReference))}}}:null}}decorate(){let e=this.getLatest();return(0,a.jsx)(V,{...e.__valueReference})}getTextContent(){var e;return null!==(e=this.__valueReference.displayName)&&void 0!==e?e:this.__valueReference.path}getReferenceData(){return this.__valueReference}constructor(e,t){super(t),(0,O._)(this,"__valueReference",void 0),this.__valueReference=e}}let H={namespace:"ActionConfigEditor",onError(e){throw e},nodes:[U],theme:{text:{bold:"font-base",italic:"font-base"}}},G={...H,editable:!0},Y={...H,editable:!1},W="text-sm leading-5",$=(0,y.QP)(W,"text-purple-11 bg-purple-2 border-purple-5 hover:border-purple-8 focus-within:border-purple-9 focus-within:ring-purple-9 focus-within:hover:border-purple-9 placeholder-purple-8"),Z=(0,y.QP)(W,"text-blue-11 bg-blue-2 border-blue-5 hover:border-blue-8 focus-within:border-blue-9 focus-within:ring-blue-9 focus-within:hover:border-blue-9"),J=(0,x.PA)(function(e){let{node:t,value:n,onChange:x,placeholder:k=null,letAiDecide:N=!1,labelledBy:C,pathDot:F}=e,T=(0,b.useRef)(null),S=(0,b.useRef)(null),I=(0,b.useRef)(null),_=(0,p.x8)(t),[z,L]=(0,b.useState)(!1);(0,c.l)(()=>{if(T.current)return T.current.registerCommand(f.$7,()=>(L(!0),!1),f.Ac)},[]),(0,c.l)(()=>{if(T.current)return T.current.registerCommand(f.R1,e=>("Tab"===e.key&&L(!1),!1),f.Ac)},[]);let A=(0,b.useRef)([]),D=(0,b.useCallback)(e=>{var t;null===(t=T.current)||void 0===t||t.update(()=>void function(e){let{value:t}=e,n=(0,f.Ni)();n.clear();let a=new f.fD;for(let e of t){if("string"==typeof e){for(let[t,n]of e.split("\n").entries())0!==t&&a.append(new f.GR),a.append(new f.Ey(n));continue}a.append(new U(e))}n.append(a),n.selectEnd()}({value:e}))},[]),E=(0,m.q2)(()=>n.some(e=>"string"!=typeof e),[n]),M=(0,b.useCallback)(e=>{!function(e,t){t.read(()=>{let t=(0,f.Ni)(),n=[],a="",l=t.getChildren();for(let e=0;e<l.length;e++){let t=l[e];if(t instanceof f.fD){for(let e of t.getChildren()){if(e instanceof f.Ey){a+=e.getTextContent();continue}if(e instanceof f.GR){a+="\n";continue}e instanceof U&&(a&&(n.push(a),a=""),n.push(e.getReferenceData()))}e!==l.length-1&&(a+="\n")}}a&&n.push(a),e(n)})}(e=>{(0,v.A)(A.current,e)||(A.current=e,x(e))},e)},[x]),K=(0,b.useCallback)(e=>{var t;null!==(t=I.current)&&void 0!==t&&t.contains(e.target)||L(!1)},[]);(0,j.Wr)(S,K);let R=(0,b.useCallback)(e=>{var t;null===(t=T.current)||void 0===t||t.update(()=>{let t=(0,f.vJ)(),n=new U(e);null==t||t.insertNodes([n])})},[]);(0,c.l)(()=>{(0,v.A)(A.current,n)||D(n)},[n,D]),(0,c.l)(()=>{requestAnimationFrame(()=>{var e;null===(e=T.current)||void 0===e||e.setEditable(!0)})},[]);let O=(0,g._M)(e=>{var t;null===(t=T.current)||void 0===t||t.update(()=>{let t=(0,f.sT)(e),n=(0,f.lJ)().append(t);(0,f.Ni)().clear().append(n).selectEnd()})});return(0,a.jsx)(w,{isOpen:z,trigger:(0,a.jsx)("div",{ref:S,className:"relative",children:(0,a.jsx)(Q.Provider,{value:t,children:(0,a.jsxs)(l.n,{initialConfig:O?G:Y,children:[(0,a.jsx)(d.D,{onChange:M}),(0,a.jsx)(r.G,{editorRef:T}),(0,a.jsx)(o.G,{}),(0,a.jsx)(u.$,{contentEditable:(0,a.jsx)(i.a,{"data-testid":"action-config-input","data-field-type":"manual",ariaLabelledBy:C,"data-path":F,className:(0,y.QP)(h.jp,N?$:Z,E&&"leading-[30px] py-1.5")}),placeholder:k?(0,a.jsx)("div",{className:(0,y.QP)("pointer-events-none absolute inset-0 flex items-center pl-[13px] text-sm text-slate-400",N&&"text-purple-8"),children:k}):null,ErrorBoundary:s.A})]})})}),menu:(0,a.jsx)(P,{outputReferences:_,ref:I,onClickItem:R})})})},44737:(e,t,n)=>{"use strict";n.d(t,{_M:()=>d,is:()=>s,uQ:()=>o});var a=n(50612),l=n(94344),i=n(33762);let r=(0,l.createContext)({pendingValue:null,setPendingValue:()=>{}});function s(e){let{children:t}=e,[n,i]=(0,l.useState)(null),s=(0,l.useMemo)(()=>({pendingValue:n,setPendingValue:i}),[n,i]);return(0,a.jsx)(r.Provider,{value:s,children:t})}function o(){let{setPendingValue:e}=(0,l.useContext)(r);return e}function d(e){let{pendingValue:t,setPendingValue:n}=(0,l.useContext)(r),a=(0,i.DK)(t=>{e(t)}),[s]=(0,l.useState)(null!=t);return(0,l.useEffect)(()=>{null!=t&&(a(t),n(null))},[t,n,a]),s}},5808:(e,t,n)=>{"use strict";n.d(t,{N:()=>d});var a=n(50612),l=n(35774),i=n(94344),r=n(25919);let s={initial:!1,animate:{height:0},transition:{duration:.1,ease:"easeOut"}},o={initial:!1,animate:{height:"auto"},transition:{duration:.1,ease:"easeOut"}};function d(e){let{children:t,header:n,disabled:d,defaultClosed:c,isOpen:m,onToggle:p}=e,[g,h]=(0,i.useState)(null!=c&&c),f=!d&&(null!=m?!m:g),v=(0,i.useCallback)(()=>{if(!d){if(p)return p();h(e=>!e)}},[d,p]);return(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("div",{className:"flex w-full items-center gap-2",children:[!d&&(0,a.jsx)(u,{onClick:v,isCollapsed:f}),(0,a.jsx)("div",{className:(0,r.QP)(d?"cursor-auto":"cursor-pointer","w-full overflow-x-hidden select-none"),onClick:v,children:n})]}),(0,a.jsx)(l.P.div,{...f?s:o,className:(0,r.QP)("flex w-full items-stretch",f&&"overflow-hidden"),children:t})]})}function u(e){let{onClick:t,isCollapsed:n}=e;return(0,a.jsx)("button",{onClick:t,"aria-label":"Toggle collapse",className:(0,r.QP)("w-4 h-4 rounded bg-slate-3 transition","focus:outline-none focus:border-primary-9 focus:ring-2 focus:ring-primary-9"),children:(0,a.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:(0,r.QP)("transform transition-transform duration-100",n?"-rotate-90":""),children:(0,a.jsx)("path",{d:"M11.7643 7.17571C11.8945 7.04553 11.8945 6.83448 11.7643 6.7043L11.2954 6.23545C11.1654 6.10537 10.9545 6.10526 10.8243 6.23519L8.23544 8.8184C8.10533 8.94824 7.89467 8.94824 7.76455 8.8184L5.1757 6.23519C5.04549 6.10526 4.83463 6.10537 4.70455 6.23545L4.2357 6.7043C4.10553 6.83448 4.10553 7.04553 4.2357 7.17571L7.7643 10.7043C7.89447 10.8345 8.10553 10.8345 8.2357 10.7043L11.7643 7.17571Z",className:"fill-current text-slate-10"})})})}},58762:(e,t,n)=>{"use strict";n.d(t,{n0:()=>J,G8:()=>W,VU:()=>$,_y:()=>Z});var a=n(50612),l=n(24704),i=n(19265),r=n(77057),s=n(37816),o=n(8505),d=n(26768),u=n(1796),c=n(54345),m=n(91318),p=n(94724),g=n(44737),h=n(20335),f=n(56993),v=n(39704),x=n(8678),b=n(94344),y=n(25919),j=n(33762),k=n(8178),N=n(45801),C=n(71792);let F=(0,x.PA)(function(e){let{item:t,onClick:n}=e,l=(0,b.useCallback)(()=>{n(t)},[n,t]);return(0,a.jsx)("li",{children:(0,a.jsx)("button",{onClick:l,className:(0,y.QP)("rounded bg-indigo-4 px-1.5 py-0.5 text-sm text-indigo-9 transition hover:bg-indigo-5","focus:outline-none focus:border-primary-9 focus:ring-2 focus:ring-primary-9"),children:t.displayName||t.path})})});var w=n(84785);let T=(0,x.PA)(function(e){let{value:t,onChange:n}=e,l=(0,b.useCallback)(e=>{n(e.target.value)},[n]);return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{className:(0,y.QP)(h.dp,"h-8 w-full rounded-md border border-slate-4 pl-7 pr-2 py-1.5 text-sm text-slate-12 transition"),value:t,onChange:l}),(0,a.jsx)(w.A,{className:"absolute left-2 top-2 h-4 w-4 text-slate-10"})]})});var S=n(25054),I=n(26042),_=n(5808),z=n(7461),L=n(46251);let A=(0,x.PA)(function(e){let{searchValue:t,nodeId:n,children:l}=e,i=(0,S.JL)(n),[r,s]=(0,b.useState)(!!t),o=null==i?void 0:i.tool,d=(0,C.HY)(i)?i.occurrence:null,u=!!(0,C.HY)(i)&&i.isRepeatedAction,c=null==i?void 0:i.displayNamePrimary,m=null==i?void 0:i.displayNameSecondary,p=null!=c?c:m,g=(0,b.useCallback)(()=>{s(e=>!e)},[]);return i&&((0,z.c_)(i.data)||(0,z.gj)(i.data))&&p&&(!u||d)&&o?(0,a.jsx)(_.N,{isOpen:r,onToggle:g,header:(0,a.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 overflow-x-hidden",children:[(0,a.jsx)(L.si,{tool:o,className:"size-5 shrink-0"}),(0,a.jsx)("span",{className:"truncate text-nowrap text-sm text-slate-10",title:p,children:p})]}),u&&d&&(0,a.jsx)(I.u,{occurrence:d})]}),children:(0,a.jsx)("ul",{className:"flex w-full flex-col gap-y-2 py-4",children:l})}):null}),D=(0,x.PA)((0,b.forwardRef)(function(e,t){let{onClickItem:n,outputReferences:l}=e,{selectedEntity:i}=(0,k.Z)(),[r,s]=(0,b.useState)(""),o=(0,m.q2)(()=>{let e={};for(let n of l){var t;if(!n.path.toLowerCase().replace(".","").includes(r.toLowerCase()))continue;let a=null!==(t=e[n.nodeId])&&void 0!==t?t:[];a.push(n),e[n.nodeId]=a}return e},[l,r]);return 0!==Object.keys(o).length&&(0,C.HY)(i)?(0,a.jsxs)("div",{ref:t,className:(0,y.QP)("grid max-h-[620px] min-h-[480px] w-80 grid-rows-[auto,1fr]",N.Oc),children:[(0,a.jsx)("div",{className:"border-b border-b-slate-4 p-4",children:(0,a.jsx)(T,{value:r,onChange:s})}),(0,a.jsx)("div",{className:(0,y.QP)("overflow-y-auto overflow-x-hidden p-4 flex flex-col w-full gap-y-2",N.Oc),children:Object.entries(o).map(e=>{let[t,l]=e;return(0,a.jsx)(A,{nodeId:t,searchValue:r,children:l.map(e=>(0,a.jsx)(F,{item:e,onClick:n},t+e.path))},t+r)})})]}):null}));var E=n(21690),M=n(97036),K=n(96929);let R={boxShadow:"0px 4px 12px 0px #0000001F"};function P(e){let{refs:t,floatingStyles:n,context:l}=(0,E.we)({placement:"left-start",open:e.isOpen,whileElementsMounted:M.ll,middleware:[(0,K.cY)(9),(0,K.BN)({padding:50})]}),i=(0,E.Mk)(l),{getReferenceProps:r,getFloatingProps:s}=(0,E.bv)([i]),o=(0,b.useMemo)(()=>({...R,...n}),[n]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{ref:t.setReference,...r(),children:e.trigger}),e.isOpen&&(0,a.jsx)(E.XF,{children:(0,a.jsx)("div",{"data-testid":"action-output-menu-popover",ref:t.setFloating,...s(),style:o,className:"z-10 rounded-lg bg-white shadow-lg dark:bg-slate-1",children:e.menu})})]})}var O=n(94783),q=n(66679);let B=(0,b.createContext)(null),Q=(0,x.PA)(function(e){let{nodeId:t,path:n,displayName:l}=e,i=(0,b.useContext)(B);if(!i)throw Error("Action config member not provided via context");let r=(0,m.q2)(()=>new Set(i.node.upstreamNodes.map(e=>e.id)).has(t),[i,t]),s=(0,S.JL)(t),o=null==s?void 0:s.tool,d=(0,C.HY)(s)?s.occurrence:null,u=!!(0,C.HY)(s)&&s.isRepeatedAction,c=o?r?void 0:"Referencing a detached node":"Referencing a deleted node";return c?(0,a.jsxs)(q.m_,{children:[(0,a.jsx)(q.ZI,{children:c}),(0,a.jsx)(q.k$,{children:(0,a.jsxs)("span",{className:(0,y.QP)("relative inline-flex text-sm items-center gap-x-1 whitespace-nowrap p-0.5 align-baseline leading-[21px]","border border-solid border-danger-6 bg-danger-4 transition-colors rounded-md pl-6 text-danger-10 select-none"),children:[(0,a.jsx)("span",{className:"absolute inset-y-0 left-0 flex w-7 items-center justify-center",children:(0,a.jsx)(O.A,{className:"mr-1 inline-flex size-4 shrink-0 items-center justify-center fill-danger-10"})}),"Error"]})})]}):(0,a.jsxs)("span",{className:(0,y.QP)("relative inline-flex text-sm items-center gap-x-1 whitespace-nowrap p-0.5 align-baseline leading-[21px]","border border-solid bg-indigo-4 text-indigo-9 transition-colors rounded-md mx-0.5 border-indigo-6",o&&"pl-8 pr-1"),children:[o&&(0,a.jsx)("span",{className:"absolute inset-y-0 left-0 flex w-7 items-center justify-center",children:(0,a.jsx)(L.si,{className:"size-5",tool:o})}),null!=l?l:n,null!=d&&u&&(0,a.jsx)(I.u,{occurrence:d})]})});var V=n(14952);class U extends f.Kp{static getType(){return"ActionOutputReferenceDecoratorNode"}static clone(e){return new U({...e.__valueReference})}createDOM(){return document.createElement("span")}updateDOM(){return!1}exportJSON(){return{type:U.getType(),version:1,valueReference:this.__valueReference}}static importJSON(e){return new U(e.valueReference)}exportDOM(){let e=document.createElement("span");return e.dataset.valueReference=JSON.stringify(this.__valueReference),{element:e}}static importDOM(){return{span:e=>e.dataset.valueReference?{conversion:e=>{if(!e.dataset.valueReference)throw Error("Missing value reference data");return{node:new U(JSON.parse(e.dataset.valueReference))}}}:null}}decorate(){let e=this.getLatest();return(0,a.jsx)(Q,{...e.__valueReference})}getTextContent(){var e;return null!==(e=this.__valueReference.displayName)&&void 0!==e?e:this.__valueReference.path}getReferenceData(){return this.__valueReference}constructor(e,t){super(t),(0,V._)(this,"__valueReference",void 0),this.__valueReference=e}}let H={namespace:"ActionConfigEditor",onError(e){throw e},nodes:[U],theme:{text:{bold:"font-base",italic:"font-base"}}},G={...H,editable:!0},Y={...H,editable:!1},W="text-sm leading-5",$=(0,y.QP)(W,"text-purple-11 bg-purple-2 border-purple-5 hover:border-purple-8 focus-within:border-purple-9 focus-within:ring-purple-9 focus-within:hover:border-purple-9 placeholder-purple-8"),Z=(0,y.QP)(W,"text-blue-11 bg-blue-2 border-blue-5 hover:border-blue-8 focus-within:border-blue-9 focus-within:ring-blue-9 focus-within:hover:border-blue-9"),J=(0,x.PA)(function(e){let{member:t,value:n,onChange:x,placeholder:k=null,letAiDecide:N=!1}=e,C=(0,b.useRef)(null),F=(0,b.useRef)(null),w=(0,b.useRef)(null),T=(0,p.x8)(t.node),[S,I]=(0,b.useState)(!1);(0,c.l)(()=>{if(C.current)return C.current.registerCommand(f.$7,()=>(I(!0),!1),f.Ac)},[]),(0,c.l)(()=>{if(C.current)return C.current.registerCommand(f.R1,e=>("Tab"===e.key&&I(!1),!1),f.Ac)},[]);let _=(0,b.useRef)([]),z=(0,b.useCallback)(e=>{var t;null===(t=C.current)||void 0===t||t.update(()=>void function(e){let{value:t}=e,n=(0,f.Ni)();n.clear();let a=new f.fD;for(let e of t){if("string"==typeof e){for(let[t,n]of e.split("\n").entries())0!==t&&a.append(new f.GR),a.append(new f.Ey(n));continue}a.append(new U(e))}n.append(a),n.selectEnd()}({value:e}))},[]),L=(0,m.q2)(()=>n.some(e=>"string"!=typeof e),[n]),A=(0,b.useCallback)(e=>{!function(e,t){t.read(()=>{let t=(0,f.Ni)(),n=[],a="",l=t.getChildren();for(let e=0;e<l.length;e++){let t=l[e];if(t instanceof f.fD){for(let e of t.getChildren()){if(e instanceof f.Ey){a+=e.getTextContent();continue}if(e instanceof f.GR){a+="\n";continue}e instanceof U&&(a&&(n.push(a),a=""),n.push(e.getReferenceData()))}e!==l.length-1&&(a+="\n")}}a&&n.push(a),e(n)})}(e=>{(0,v.A)(_.current,e)||(_.current=e,x(e))},e)},[x]),E=(0,b.useCallback)(e=>{var t;null!==(t=w.current)&&void 0!==t&&t.contains(e.target)||I(!1)},[]);(0,j.Wr)(F,E);let M=(0,b.useCallback)(e=>{var t;null===(t=C.current)||void 0===t||t.update(()=>{let t=(0,f.vJ)(),n=new U(e);null==t||t.insertNodes([n])})},[]);(0,c.l)(()=>{(0,v.A)(_.current,n)||z(n)},[n,z]),(0,c.l)(()=>{requestAnimationFrame(()=>{var e;null===(e=C.current)||void 0===e||e.setEditable(!0)})},[]);let K=(0,g._M)(e=>{var t;null===(t=C.current)||void 0===t||t.update(()=>{let t=(0,f.sT)(e),n=(0,f.lJ)().append(t);(0,f.Ni)().clear().append(n).selectEnd()})});return(0,a.jsx)(P,{isOpen:S,trigger:(0,a.jsx)("div",{ref:F,className:"relative",children:(0,a.jsx)(B.Provider,{value:t,children:(0,a.jsxs)(l.n,{initialConfig:K?G:Y,children:[(0,a.jsx)(d.D,{onChange:A}),(0,a.jsx)(r.G,{editorRef:C}),(0,a.jsx)(o.G,{}),(0,a.jsx)(u.$,{contentEditable:(0,a.jsx)(i.a,{"data-testid":"action-config-input","data-field-type":"manual","data-label":t.label,"data-path":t.pathDot,className:(0,y.QP)(h.jp,N?$:Z,L&&"leading-[30px] py-1.5")}),placeholder:k?(0,a.jsx)("div",{className:(0,y.QP)("pointer-events-none absolute inset-0 flex items-center pl-[13px] text-sm text-slate-400",N&&"text-purple-8"),children:k}):null,ErrorBoundary:s.A})]})})}),menu:(0,a.jsx)(D,{outputReferences:T,ref:w,onClickItem:M})})})},1676:(e,t,n)=>{"use strict";n.d(t,{X:()=>E});var a=n(14952),l=n(50612),i=n(52105),r=n(5862),s=n(56989);let o=(0,r._)({post:{body:s.ah,data:s.Z8}}),d=(0,i.In)("POST","/api/dynamicLoaders/fetch",o.post.data);var u=n(7094);let c=(0,r._)({post:{body:u.z.object({key:u.z.string(),value:u.z.string(),dependentValues:s.pe,authId:u.z.string().nullish()}),data:s.PZ}}),m=(0,i.In)("POST","/api/dynamicLoaders/validate",c.post.data);var p=n(30900),g=n(35940),h=n(91318),f=function(e){return e.AgentLoader="agents",e}({}),v=n(6573),x=n(40453),b=n(89073),y=n(13433),j=n(98354),k=n(24069),N=n(8678),C=n(94344),F=n(33762),w=n(90769),T=n(39274);let S=(0,N.PA)(function(e){let{name:t,meta:n}=e;return(0,l.jsxs)("div",{className:"flex items-center gap-x-2",children:[n&&"icon"in n&&(0,w.Ph)(n.icon)?(0,l.jsx)(T.l,{iconName:n.icon.name,color:n.icon.color,className:"shrink-0 border border-slate-4"}):null,t]})}),I={[s.YN.GoogleSheetRow]:v.H,[s.YN.UnknownIcon]:null};class _ extends Error{constructor(e,t,n){super(e),(0,a._)(this,"erroredFields",void 0),(0,a._)(this,"requiredAuth",void 0),(0,a._)(this,"name",void 0),this.erroredFields=t,this.requiredAuth=n,this.name="DynamicLoaderResult"}}let z="m-0 justify-start border-none bg-inherit p-0",L=[{name:"No results found",value:"[[empty]]"}],A=[{name:"Searching...",value:"[[searching]]"}],D=[{name:"Loading...",value:"[[loading]]"}],E=(0,N.PA)(function(e){let{loaderField:t,loadersStore:n,autoFocusIfNextOne:a}=e,r=n.loader(t),s=r.icon,o=n.authId,u=s&&s in I?I[s]:null,c=(0,b.jE)(),[v,N]=(0,F.Q3)("",300),w=(0,y.q)({queryKey:["dynamic-loader",r.dependentValues,r.key,v,o,25],queryFn:e=>{let{pageParam:t={offset:0,paginationToken:null}}=e;return(0,i.oA)(d({body:{key:r.key,query:v||void 0,limit:25,offset:t.offset,paginationToken:t.paginationToken,dependentValues:r.dependentValues,authId:o}})).then(e=>{if(!e.success)throw new _(e.error.message,e.error.erroredFields,e.error.requiredAuth);return e.data})},refetchOnWindowFocus:"always",getNextPageParam:(e,t)=>e.hasMore?{offset:25*t.length,paginationToken:e.paginationToken}:void 0,getPreviousPageParam:()=>void 0,onError(e){e instanceof _&&!e.requiredAuth&&r.setValue("")}}),T=(0,C.useCallback)(async()=>{w.hasNextPage&&!w.isFetchingNextPage&&await w.fetchNextPage()},[w]),E=(0,h.q2)(()=>{var e,t;return null!==(t=null===(e=w.data)||void 0===e?void 0:e.pages.flatMap(e=>e.results))&&void 0!==t?t:[]},[w.data]),K=(0,j.I)({queryKey:["dynamic-loader-validate",r.dependentValues,r.key,r.value,o],queryFn:()=>(0,i.oA)(m({body:{key:r.key,value:r.value,dependentValues:r.dependentValues,authId:o}})).then(e=>{if(!e.success)throw new _(e.error.message,e.error.erroredFields,e.error.requiredAuth);return e.data}),enabled:r.isSet}),R=(0,C.useCallback)(e=>{if(!e){n.setValue(t,"");return}n.setValue(t,e.value),c.setQueryData(["dynamic-loader-validate",r.dependentValues,r.key,e.value,o],{name:e.name,value:e.value})},[n,t,c,r.dependentValues,r.key,o]),P=(0,C.useCallback)(e=>{N(e)},[N]),O=(0,h.q2)(()=>{var e;return r.value&&K.data&&K.data.value===r.value?K.data:null!==(e=E.find(e=>e.value===r.value))&&void 0!==e?e:null},[r,E,K.data]);(0,C.useEffect)(()=>{if(!O&&!(0,k.A)(E)&&r.defaultValue){let e=E.find(e=>{var t;return e.value===(null===(t=r.defaultValue)||void 0===t?void 0:t.value)});e&&R(e)}},[O,R,E,r.defaultValue]);let q=(0,C.useCallback)(e=>{var t,n;return null!==(n=null!==(t=null==e?void 0:e.name)&&void 0!==t?t:r.placeholder)&&void 0!==n?n:"Select an option..."},[r]),B=(0,C.useCallback)(e=>r.key===f.AgentLoader?(0,l.jsx)(S,{...e}):(0,l.jsxs)("div",{className:"flex flex-row gap-x-3",children:[!!u&&(0,l.jsx)(u,{className:"size-5 rounded-none shadow-none"}),e.name]}),[u,r.key]),Q=(0,C.useCallback)(e=>e===L[0]||e===A[0]||e===D[0],[]),V=(0,h.q2)(()=>{if(w.error instanceof _)return w.error.requiredAuth?"Please connect your account first":w.error.message},[w.error]);return(0,l.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,l.jsx)(g.F,{autoFocus:a&&!v&&!r.value&&!w.error,title:V,label:r.displayName,description:r.description,value:O,onChange:R,onSearchChange:P,isOptionDisabled:Q,options:w.isFetching&&v?A:w.isFetching&&0===E.length?D:w.isFetching||0!==E.length?E:L,displayValue:q,renderOption:B,fetchMoreOptions:T,isFetchingMore:w.isFetching,hasMoreData:!!w.hasNextPage,labelClassName:"text-slate-11",by:"value"}),w.error?w.error instanceof _?(0,l.jsx)(M,{error:w.error,loader:r}):(0,l.jsx)(p.F,{type:"error",className:z,children:(0,x.SP)(w.error)}):null]})}),M=(0,N.PA)(function(e){let{error:t}=e;return t.requiredAuth?null:(0,l.jsx)(p.F,{type:"error",className:z,children:t.message})})},26042:(e,t,n)=>{"use strict";n.d(t,{u:()=>i});var a=n(50612),l=n(25919);function i(e){return(0,a.jsx)("div",{className:(0,l.QP)("flex h-[18px] w-[18px] shrink-0 items-center justify-center rounded border border-slate-4 bg-white text-xs text-slate-9 dark:bg-slate-2",e.className),children:e.occurrence})}},20936:(e,t,n)=>{"use strict";n.d(t,{l:()=>i});var a=n(1023),l=n(94344);let i=(0,l.memo)(function(e){let t=(0,l.useMemo)(()=>({animationData:e.animationData,loop:!1,className:"w-full"}),[e]),{View:n}=(0,a.useLottie)(t);return n})},26248:(e,t,n)=>{"use strict";n.d(t,{p:()=>p});var a=n(50612),l=n(20936),i=n(67371),r=n.n(i),s=n(89136),o=n.n(s),d=n(94344);let u={imageData:null,setImageData:()=>{}},c=(0,d.createContext)(u);function m(){return(0,d.useContext)(c)||u}let p={Provider:function(e){let[t,n]=(0,d.useState)(null),l=(0,d.useCallback)(e=>{r()(t,e)||n(e)},[t]),i=(0,d.useMemo)(()=>({imageData:t,setImageData:l}),[t,l]);return(0,a.jsx)(c.Provider,{value:i,children:e.children})},Slot:(0,d.memo)(function(){let e=m(),t=(0,d.useMemo)(()=>e.imageData?o()(e.imageData):null,[e.imageData]);return t?(0,a.jsx)(l.l,{animationData:t}):null}),Image:function(e){let t=m();return(0,d.useEffect)(()=>{e.imageData&&t.setImageData(e.imageData)},[e.imageData,t]),null}}},37473:(e,t,n)=>{"use strict";n.d(t,{I:()=>C});var a=n(50612),l=n(93369),i=n(52105),r=n(5862),s=n(7094);let o=(0,r._)({post:{body:s.z.object({input:s.z.string()}),data:s.z.object({cron:s.z.string(),description:s.z.string(),nextDate:s.z.string()})}}),d=(0,i.In)("POST","/api/tools/triggers/recurringSchedule/nlToCron",o.post.data);var u=n(22525),c=n(85680),m=n(91318),p=n(55663),g=n(76804),h=n(85341),f=n(77566),v=n(36760),x=n.n(v),b=n(86276),y=n(8678),j=n(95082),k=n.n(j),N=n(94344);let C=(0,y.PA)(function(e){let{placeholder:t,value:n,onChange:r,isFromModal:s=!0}=e,[o,v]=(0,N.useState)(""),x=(0,p.B)(),y=(0,m.q2)(()=>T(x),[x]),[j,k]=(0,N.useState)(n&&!y.some(e=>{let[,t]=e;return t===n})?[{cron:n,description:(0,h.Kp)(n),nextDate:F(n,x)}]:[]),C=(0,m.q2)(()=>[...j,...y.map(e=>{let[t,n]=e;return{cron:n,description:t,nextDate:F(n,x)}})].filter((e,t,n)=>n.findIndex(t=>t.cron===e.cron)===t),[y,j,x]),S=(0,m.q2)(()=>C.find(e=>e.cron===n),[C,n]),I=(0,c.aV)(),_=(0,c.hT)(),z=(0,N.useRef)(""),L=(0,N.useRef)(!1),A=(0,f.n)({mutationFn:async e=>await (0,i.oA)(d({body:{input:e}})),onError:e=>{if(L.current||(r(""),A.isLoading))return;z.current&&_(z.current);let{id:t}=I({level:"danger",message:e.message,duration:5e3});z.current=t},onSuccess:e=>{L.current||(k(t=>[e,...t]),r(e.cron))}}),D=(0,N.useRef)(A);D.current=A;let E=(0,N.useCallback)((0,b.A)(D.current.mutate,400),[]),M=(0,m.q2)(()=>{var e;return!!o.trim()&&(null===(e=C.at(0))||void 0===e?void 0:e.description.toLowerCase().startsWith(o.toLowerCase()))},[o,C]),K=(0,N.useCallback)(e=>{v(e),e.trim()||r(""),!M&&e.trim().length>10&&(L.current=!1,E(e))},[E,M,r]),R=(0,N.useCallback)(e=>{L.current=!0,r(e)},[r]);return(0,a.jsxs)("div",{className:"ml-0.5",children:[(0,a.jsx)(u.e,{placeholder:t,inputIcon:A.isLoading?(0,a.jsx)(g.y,{size:"sm"}):(0,a.jsx)(l.A,{className:"size-4 text-slate-12"}),onSelect:R,value:n,options:C.map(e=>({label:e.description,value:e.cron,postLabel:(0,a.jsx)("div",{className:"whitespace-nowrap",children:w(e.nextDate,x)})})),isFromModal:s,onInputChange:K}),S&&(0,a.jsxs)("div",{className:"mt-3 text-sm text-slate-12",children:["The trigger will run ",S.description.slice(0,1).toLowerCase(),S.description.slice(1)," starting ",w(S.nextDate,x)]})]})}),F=(e,t)=>x().parseExpression(e,{tz:t}).next().toDate().toISOString(),w=(e,t)=>k()(e).tz(t).format("ddd MMM D, h:mm A"),T=e=>[["Every hour","0 * * * *"],["Every hour on weekdays","0 * * * 1-5"],...[2,4,6,8,12].map(e=>["Every ".concat(e," hours"),"0 */".concat(e," * * *")]),...Array.from({length:12}).map((e,t)=>["Every day at ".concat(t+8,":00"),"0 ".concat(t+8," * * *")]),["Every week on Monday at 9:00","0 9 1 * *"],["Every month on the 1st at 9:00","0 9 1 * *"],["At 6pm on the last day of every month","0 12 L * *"],["Quarterly","0 0 1 */3 *"],...Array.from({length:7}).map((t,n)=>["Every ".concat(k().tz(e).day(n).format("dddd")," at 9:00"),"0 9 * * ".concat(n)])]},21429:(e,t,n)=>{"use strict";n.d(t,{K:()=>u,L:()=>c});var a=n(6028),l=n(91318),i=n(8178),r=n(7461),s=n(63193),o=n(71792);function d(e,t){return{...e,nodeId:t._id,occurrence:t.occurrence,statefulToolOccurrence:t.statefulToolOccurrence}}function u(e){let t=(0,l.q2)(()=>{if((0,o.N)(e)){let{tool:t,action:n}=e.action;return{tool:t,key:n}}return null},[e]),{data:n}=(0,a.T5)(t);return(0,l.q2)(()=>{if((0,r.c_)(null==e?void 0:e.data)&&n){let t=d(n,e.data);return(0,o.N)(e)&&e.setActionDetails(t),t}return null},[e,n])}function c(){let e=(0,i.H)(),t=(0,l.q2)(()=>{var t;return null!==(t=null==e?void 0:e.nodes)&&void 0!==t?t:[]},[e]),n=(0,l.q2)(()=>t.filter(o.N).map(e=>{let{tool:t,action:n}=e.action;return{tool:t,key:n}}),[t]),{data:r}=(0,a.$G)(n,{keepPreviousData:!0});return(0,l.q2)(()=>r?t.filter(o.N).map(e=>{let{tool:t,action:n}=e.action,a=r.find(e=>e.tool===t&&e.actionKey===n);return a?d(a,e.data):null}).filter(s.Pe):[],[t,r])}},81211:(e,t,n)=>{"use strict";n.d(t,{b:()=>g});var a=n(41459),l=n(52105),i=n(38400),r=n(98354),s=n(94344),o=n(94559),d=n(79879);let u=(0,l.In)("GET","/api/society/agentDefinition/:id/stateGraph/:stateGraphId",i.w.get.data);var c=n(72735),m=n(93300),p=n(81778);function g(){let{lindyId:e}=(0,m.P)(),t=(0,p.useRouter)(),n=Array.isArray(t.query[c.qi])?t.query[c.qi].at(0):t.query[c.qi],l=null!=e?e:n,i=Array.isArray(t.query[c.A4])?t.query[c.A4].at(0):t.query[c.A4],g=(0,a.gh)({params:{id:null!=l?l:""},options:{enabled:!!l&&!i}}),h=function(e){let t=(0,s.useMemo)(()=>["society/agentDefinition/[id]/stateGraph/[stateGraphId]","get",e.params.id,e.params.stateGraphId],[e.params.id,e.params.stateGraphId]),n=(0,o.lB)(()=>null==e?void 0:e.options,[null==e?void 0:e.options]),a=(0,r.I)({queryKey:t,queryFn:async()=>{let{data:t,error:n}=await u(e);if(n)throw n;return t},...null==e?void 0:e.options}),l=(0,o.lB)(()=>a,[a]);return(0,d.R)(t,l,n)}({params:{id:null!=n?n:"",stateGraphId:null!=i?i:""},options:{enabled:!!i&&!!n}});return i?h:g}},25054:(e,t,n)=>{"use strict";n.d(t,{JL:()=>i,ec:()=>s,ip:()=>r});var a=n(8178),l=n(36441);function i(e){let t=(0,a.Z)();return e?(0,l.EW)(()=>{var n;return null!==(n=t._nodesById.get(e))&&void 0!==n?n:null}).get():null}function r(e){let t=(0,a.Z)();return e?t.getEdgeById(e):null}function s(e){var t;let n=(0,a.Z)();return e&&null!==(t=n.getStickyNoteById(e))&&void 0!==t?t:null}},94724:(e,t,n)=>{"use strict";n.d(t,{x8:()=>f});var a=n(91318),l=n(7461),i=n(84318),r=n(89339),s=n(71792),o=n(31284),d=n(23913),u=n(23664),c=n(88748),m=n(36441),p=n(21429),g=n(61745),h=n(62898);function f(e){let t=(0,p.L)(),n=(0,h.N)(),f=(0,g.dF)(e),v=(0,a.q2)(()=>new Set(null==e?void 0:e.upstreamNodes.map(e=>e.id)),[e]),x=(0,a.q2)(()=>t.filter(e=>v.has(e.nodeId)).flatMap(e=>(function(e){if(e.tool===u.h6.Form&&e.key===l.Ig){var t,n;let a=null===(t=o.a.lindies.currentLindy)||void 0===t?void 0:t.stateGraph,l=null==a?void 0:a.getNodeById(e.nodeId);return(0,s.N)(l)?(function(e){let t=null==e?void 0:e.find(e=>"elements"===(0,r.Fd)(e.path));return Array.isArray(null==t?void 0:t.manual)?t.manual.filter(c.Rb).map(e=>({id:(0,m.HO)(e.value.id),displayName:function(e){try{var t;if(e.value.auth)return JSON.parse((0,m.HO)(e.value.auth.value)).displayName;if(e.value.field)return JSON.parse((0,m.HO)(e.value.field)).displayName;return(0,m.HO)(null===(t=e.value.label)||void 0===t?void 0:t.references.at(0))}catch(e){return"Unknown"}}(e)})):[]})(null===(n=l.actionConfigV2)||void 0===n?void 0:n.serialized).map(t=>({type:"output",path:t.id,tool:e.tool,nodeId:e.nodeId,displayName:t.displayName})):null}return null})(e)||e.outputProperties.map(t=>({type:"output",path:t.value,tool:e.tool,nodeId:e.nodeId,displayName:t.displayName}))),[t,v]),b=(0,a.q2)(()=>{var e;return null!==(e=null==f?void 0:f.flatMap(e=>e.createdByNodeId?e.instanceProperties.map(t=>{var n;return{type:"instance",path:t.value,tool:e.tool,nodeId:null!==(n=e.createdByNodeId)&&void 0!==n?n:"",displayName:t.displayName,statefulToolKey:e.statefulToolKey}}):[]))&&void 0!==e?e:[]},[f]),y=(0,a.q2)(()=>e?e.upstreamEdges.reverse().flatMap(e=>{var a,l,r;if(!e.isObserveEdge)return[];let s=t.find(t=>{var n;return t.nodeId===(null===(n=e.from)||void 0===n?void 0:n.id)}),o=n.find(t=>{var n;return t.nodeId===(null===(n=e.from)||void 0===n?void 0:n.id)}),d=null!=s?s:o,u=null!==(r=null==s?void 0:null===(a=s.observableChannel)||void 0===a?void 0:a.agentMessageReceivedSchema)&&void 0!==r?r:null==o?void 0:null===(l=o.otherObservableChannel)||void 0===l?void 0:l.agentMessageReceivedSchema;return u&&d?(0,i.w)(u).map(e=>({type:"message",path:e.value,tool:d.tool,nodeId:d.nodeId,displayName:e.displayName})):[]}):[],[t,n,e]),j=(0,a.q2)(()=>{var e;return null!==(e=null==n?void 0:n.filter(e=>v.has(e.nodeId)).flatMap(e=>e.eventProperties.map(t=>({type:"message",path:t.value,tool:e.tool,nodeId:e.nodeId,displayName:t.displayName}))))&&void 0!==e?e:[]},[n,v]);return(0,a.q2)(()=>{var e;return(e=[...x,...y,...j,...b]).filter(t=>{switch(t.type){case"message":if(e.some(e=>"instance"===e.type&&e.path===t.path&&e.path===t.path&&e.nodeId===t.nodeId))return!1;return!0;case"input":case"output":case"instance":return!0;default:throw new d.j(t.type)}})},[x,y,j,b])}},61745:(e,t,n)=>{"use strict";n.d(t,{ax:()=>w,dF:()=>T});var a=n(52105),l=n(5862),i=n(98279),r=n(7094);let s=(0,l._)({get:{query:r.z.object({statefulToolKeys:r.z.string()}),data:r.z.array(i.st)}});n(94344),n(79879);let o=(0,a.In)("GET","/api/tools/stateful",s.get.data);var d=n(11293),u=n(13268);let{useOne:c,useMany:m}=(0,d.U)({name:"stateful-tool-details",queryFn:async e=>{let t=await o({query:{statefulToolKeys:u.D.dedup(e).join(",")}}),n=new Map;return t.data&&t.data.forEach(e=>n.set(e.statefulToolKey,e)),e.map(e=>{var t;return null!==(t=n.get(e))&&void 0!==t?t:Error("Stateful tool details not found")})},keyFn:e=>e});var p=n(91318),g=n(21429),h=n(8178),f=n(7461),v=n(63193),x=n(95654),b=n(64434),y=n(84318),j=n(57802),k=n(39678),N=n(62898);function C(e,t){var n;let a=x.KQ.isObject(e.schema)?(0,y.w)(e.schema):[];return{...e,createdByNodeId:null!==(n=null==t?void 0:t._id)&&void 0!==n?n:null,occurrence:(null==t?void 0:t.type)===j.cs.Action?t.occurrence:1,instanceProperties:a}}function F(e,t){let n=[];if("Conversation"===e.entryType)n.push("userChannel");else if("Trigger"===e.entryType){var a,l,i;if((0,k.DC)(null===(a=e.triggerSetup)||void 0===a?void 0:a.onAutoObserve)&&"new-task"===(0,k.SS)(null===(l=e.triggerSetup)||void 0===l?void 0:l.onAutoObserve))return n;let s=t.find(t=>t.nodeId===e._id);if(s){(null===(i=s.channel)||void 0===i?void 0:i.statefulToolKey)&&n.push(s.channel.statefulToolKey);let e=function(e){let t=[],n=new Set;return(function(e){let t=[];return(0,b.fc)(e,(e,n)=>{var a,l;let{path:i}=n,s=e instanceof r.z.ZodType?null===(a=e._def.lindyMetadata)||void 0===a?void 0:a.statefulToolKey:null===(l=e.lindyMetadata)||void 0===l?void 0:l.statefulToolKey;s&&t.push([i,s])}),t})(e).forEach(e=>{let[a,l]=e;a.every(e=>"string"==typeof e)&&(t.includes(l)&&n.add(l),t.push(l))}),t.filter(e=>!n.has(e))}(s.eventSchema);n.push(...e)}}return n}function w(e,t){let n=(0,g.K)(e),a=(0,N._)(e),l=c((0,p.q2)(()=>{var l,i,r;return"userChannel"==t?t:e?(0,f.c_)(e.data)&&n?null!==(i=null===(l=n.outputSchema.lindyMetadata)||void 0===l?void 0:l.statefulToolKey)&&void 0!==i?i:null:(0,f.gj)(e.data)&&null!==(r=F(e.data,a?[a]:[]).find(e=>e===t))&&void 0!==r?r:null:null},[n,a,t,e])),i=(0,p.q2)(()=>{if(l.data&&((0,f.c_)(null==e?void 0:e.data)||(0,f.gj)(null==e?void 0:e.data)||"userChannel"===t))return C(l.data,null==e?void 0:e.data)},[l.data,e,t]);return{...l,data:i}}function T(e){let t=(0,p.q2)(()=>new Set(null==e?void 0:e.upstreamNodes.map(e=>e.id)),[e]),n=function(){let e=(0,h.H)(),t=(0,p.q2)(()=>{var t;return null!==(t=null==e?void 0:e.nodes)&&void 0!==t?t:[]},[e]),n=(0,g.L)(),a=(0,N.N)(),l=(0,p.wJ)(()=>t.map(e=>e.data).filter(f.gj),[t]),{data:i}=m((0,p.q2)(()=>{let e=new Set(["userChannel"]);return n.forEach(t=>{var n;let a=null===(n=t.outputSchema.lindyMetadata)||void 0===n?void 0:n.statefulToolKey;a&&e.add(a)}),null==l||l.forEach(t=>{F(t,a).forEach(t=>{e.add(t)})}),Array.from(e)},[n,l,a]));return(0,p.q2)(()=>{var e;if(!i)return[];let t=[...n.map(e=>{var t;let n=null===(t=e.outputSchema.lindyMetadata)||void 0===t?void 0:t.statefulToolKey;if(!n)return;let a=i.find(e=>e.statefulToolKey===n);if(!a)return;let l=x.KQ.isObject(a.schema)?(0,y.w)(a.schema):[];return{...a,createdByNodeId:e.nodeId,occurrence:e.occurrence,instanceProperties:l}}).filter(v.Vq),...null!==(e=null==l?void 0:l.flatMap(e=>F(e,a).map(t=>{let n=i.find(e=>e.statefulToolKey===t);if(!n)return;let a=x.KQ.isObject(n.schema)?(0,y.w)(n.schema):[];return{...n,createdByNodeId:e._id,occurrence:1,instanceProperties:a}})).filter(v.Vq))&&void 0!==e?e:[]];if(!t.some(e=>"userChannel"===e.statefulToolKey)){let e=i.find(e=>"userChannel"===e.statefulToolKey);e&&t.push(C(e))}return t},[n,l,a,i])}();return n&&n.filter(e=>{var n;return"userChannel"===e.statefulToolKey||t.has(null!==(n=e.createdByNodeId)&&void 0!==n?n:"")})}},62898:(e,t,n)=>{"use strict";n.d(t,{N:()=>j,_:()=>y});var a=n(52105),l=n(5862),i=n(39678),r=n(7094);let s=(0,l._)({get:{query:r.z.object({triggers:r.z.string()}),data:r.z.array(i.Gk)}});n(94344),n(79879);let o=(0,a.In)("GET","/api/tools/triggers/details",s.get.data);var d=n(11293),u=n(13268);let{useOne:c,useMany:m,loader:p}=(0,d.U)({name:"trigger-details",queryFn:async e=>{let t=u.D.dedup(e.map(e=>{let{tool:t,name:n}=e;return"".concat(t,".").concat(n)})).join(","),n=await o({query:{triggers:t}}),a=new Map;return n.data&&n.data.forEach(e=>{a.set("".concat(e.tool,".").concat(e.name),e)}),e.map(e=>{var t;let n="".concat(e.tool,".").concat(e.name);return null!==(t=a.get(n))&&void 0!==t?t:Error("Trigger details not found")})},keyFn:e=>{let{tool:t,name:n}=e;return"".concat(t,".").concat(n)}});var g=n(91318),h=n(8178),f=n(7461),v=n(63193),x=n(84318);function b(e,t){return{...e,nodeId:t,eventProperties:(0,x.w)(e.eventSchema)}}function y(e){let{data:t}=c((0,g.q2)(()=>(0,f.QF)(null==e?void 0:e.data)&&e.data.trigger?{tool:e.data.trigger.tool,name:e.data.trigger.name}:null,[e]));return(0,g.q2)(()=>e&&t?b(t,e.id):null,[e,t])}function j(){let e=(0,h.H)(),t=(0,g.q2)(()=>{var t;return null!==(t=null==e?void 0:e.nodes)&&void 0!==t?t:[]},[e]),{data:n}=m((0,g.q2)(()=>t.map(e=>{if((0,f.QF)(e.data)&&e.data.trigger){let{tool:t,name:n}=e.data.trigger;return{tool:t,name:n}}return null}).filter(v.Pe),[t]),{keepPreviousData:!0});return(0,g.q2)(()=>n?t.map(e=>{if((0,f.QF)(e.data)&&e.data.trigger){let{tool:t,name:a}=e.data.trigger,l=n.find(e=>e.tool===t&&e.name===a);return l?b(l,e.id):null}return null}).filter(v.Pe):[],[t,n])}},35853:(e,t,n)=>{"use strict";n.d(t,{ec:()=>r,bF:()=>o,R4:()=>c});var a=n(50612),l=n(91141),i=n(25919);let r=(0,i.QP)("flex w-60 origin-top flex-col gap-y-1 rounded-[10px] bg-white p-1 dark:bg-slate-1 mt-1 overflow-auto","ring-1 ring-slate-12 ring-opacity-5 focus:outline-none z-40"),s=(0,i.QP)("group flex w-full cursor-pointer items-center gap-3 rounded-md px-1.5 py-2 text-sm text-slate-12 hover:bg-slate-3 font-normal truncate","cursor-pointer transition","focus:ring-2 ring-offset-slate-1 focus:ring-primary-8 focus:outline-none focus:ring-offset-2 active:bg-slate-4");function o(e){let{className:t,children:n,...r}=e;return(0,a.jsx)(l.Dr,{children:(0,a.jsx)("button",{className:(0,i.QP)(s,t),...r,children:n})})}n(94344);var d=n(30035),u=n.n(d);function c(e){let{className:t,children:n,...r}=e;return(0,a.jsx)(l.Dr,{children:(0,a.jsx)(u(),{className:(0,i.QP)(s,t),...r,children:n})})}},51975:(e,t,n)=>{"use strict";n.d(t,{O:()=>o});var a=n(50612),l=n(94344),i=n(70608),r=n(66423),s=n(98221);let o=(0,l.forwardRef)(function(e,t){return(0,a.jsxs)(r.E,{className:e.className,children:[(0,a.jsx)(s.G,{ref:t,children:e.children}),(0,a.jsx)(i.Z,{})]})})},66423:(e,t,n)=>{"use strict";n.d(t,{E:()=>s});var a=n(50612),l=n(78176),i=n(94344),r=n(25919);let s=(0,i.forwardRef)(function(e,t){return(0,a.jsx)(l.bL,{ref:t,className:(0,r.QP)("h-full w-full overflow-hidden",e.className),children:e.children})})},98221:(e,t,n)=>{"use strict";n.d(t,{G:()=>s});var a=n(50612),l=n(78176),i=n(94344),r=n(25919);let s=(0,i.forwardRef)(function(e,t){let{className:n,fade:i,...s}=e;return(0,a.jsx)(l.LM,{...s,ref:t,className:(0,r.QP)("h-full w-full","top"===i&&"[mask-image:linear-gradient(to_bottom,transparent,black_2rem,black)]","bottom"===i&&"[mask-image:linear-gradient(to_top,transparent,black_2rem,black)]","both"===i&&"[mask-image:linear-gradient(to_bottom,transparent,black_2rem,black_calc(100%-2rem),transparent)]",n)})})},70608:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var a=n(50612),l=n(78176);function i(){return(0,a.jsx)(l.Ze,{orientation:"vertical",className:"flex w-3 touch-none select-none p-0.5",children:(0,a.jsx)(l.zi,{className:"-before:translate-x-1/2 relative flex-1 rounded-full bg-slate-7 before:absolute before:left-1/2 before:top-1/2 before:size-full before:min-h-11 before:min-w-11 before:content-[''] hover:bg-slate-8"})})}},85926:(e,t,n)=>{"use strict";n.d(t,{E5:()=>i.E,Gl:()=>r.G,OY:()=>a.O,Ze:()=>l.Z});var a=n(51975),l=n(70608),i=n(66423),r=n(98221)},33649:(e,t,n)=>{"use strict";n.d(t,{l:()=>s});var a=n(50612),l=n(35121),i=n(94344),r=n(25919);let s=(0,i.forwardRef)(function(e,t){let{className:n,...i}=e;return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("select",{ref:t,className:(0,r.QP)("block h-11 w-full rounded-md border border-slate-4 bg-slate-1 py-2 pl-4 pr-10","text-sm font-medium text-slate-12 placeholder-slate-9","focus:border-primary-9 focus:outline-none focus:ring-1 focus:ring-primary-9","appearance-none bg-none",n),...i}),(0,a.jsx)(l.z,{direction:"down",className:"pointer-events-none absolute right-4 top-1/2 size-5 -translate-y-1/2 text-slate-11"})]})})},44691:(e,t,n)=>{"use strict";n.d(t,{Y:()=>i});var a=n(50612),l=n(25919);function i(e){let{className:t,...n}=e;return(0,a.jsx)("h2",{className:(0,l.QP)("text-[1.75rem] font-medium leading-9 tracking-tight text-slate-12 xl:text-[2rem] xl:leading-10",t),...n})}},42009:(e,t,n)=>{"use strict";n.d(t,{$b:()=>p,x:()=>m});var a=n(50612),l=n(72260),i=n(91141),r=n(35853),s=n(16008),o=n(35774),d=n(94344),u=n(25919);let c={animate:{opacity:1,scale:1},initial:{opacity:0,scale:.9},exit:{opacity:0,scale:.95},transition:{type:"easeIn",duration:.08}};function m(e){let{children:t,open:n,className:i,anchor:m="bottom start"}=e;return(0,a.jsx)(s.N,{children:n&&(0,a.jsx)(l.QT,{static:!0,as:d.Fragment,anchor:m,children:(0,a.jsx)(o.P.div,{className:(0,u.QP)(r.ec,"shadow-lg",i),initial:c.initial,animate:c.animate,exit:c.exit,transition:c.transition,children:t})})})}function p(e){let{children:t,open:n,className:l,anchor:m="bottom start","data-testid":p}=e;return(0,a.jsx)(s.N,{children:n&&(0,a.jsx)(i.c,{static:!0,as:d.Fragment,anchor:m,children:(0,a.jsx)(o.P.div,{"data-testid":p,className:(0,u.QP)(r.ec,"shadow-lg",l),initial:c.initial,animate:c.animate,exit:c.exit,transition:c.transition,children:t})})})}},91871:(e,t,n)=>{"use strict";n.d(t,{Y:()=>a});let a="focus-visible:ring-2 focus:ring-primary-8 focus:outline-none focus:ring-offset-2 transition ring-offset-slate-1"},53549:(e,t,n)=>{"use strict";n.d(t,{f:()=>l});var a=n(50612);let l=n(94344).memo(function(){return(0,a.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M11.9435 4.86011L16.5626 9.47917C16.888 9.80461 16.888 10.3322 16.5626 10.6577L11.9435 15.2768M16.1102 10.0684H3.19349",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})},64145:(e,t,n)=>{"use strict";n.d(t,{h:()=>l});var a=n(50612);let l=e=>(0,a.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.5428 3.54289C17.6237 2.46201 19.3762 2.46201 20.4571 3.54289C21.5379 4.62377 21.5379 6.37623 20.4571 7.45711L7.45705 20.4571C6.37617 21.538 4.62372 21.538 3.54284 20.4571C2.46196 19.3762 2.46196 17.6238 3.54284 16.5429L16.5428 3.54289ZM19.0428 4.95711C18.743 4.65728 18.2569 4.65728 17.9571 4.95711L16.1642 6.75L17.2499 7.83579L19.0428 6.04289C19.3427 5.74306 19.3427 5.25694 19.0428 4.95711Z"}),(0,a.jsx)("path",{d:"M9.85003 2.07454C9.94679 2.02616 10.0253 1.9477 10.0736 1.85094L10.5519 0.894435C10.7361 0.525911 11.262 0.525911 11.4463 0.894435L11.9246 1.85094C11.9729 1.9477 12.0514 2.02616 12.1482 2.07454L13.1047 2.55279C13.4732 2.73706 13.4732 3.26296 13.1047 3.44722L12.1482 3.92547C12.0514 3.97385 11.9729 4.05232 11.9246 4.14908L11.4463 5.10558C11.262 5.47411 10.7361 5.47411 10.5519 5.10558L10.0736 4.14908C10.0253 4.05232 9.94679 3.97385 9.85003 3.92547L8.89353 3.44722C8.525 3.26296 8.525 2.73706 8.89353 2.55279L9.85003 2.07454Z"}),(0,a.jsx)("path",{d:"M18.85 13.0745C18.9468 13.0262 19.0253 12.9477 19.0736 12.8509L19.5519 11.8944C19.7361 11.5259 20.2621 11.5259 20.4463 11.8944L20.9246 12.8509C20.9729 12.9477 21.0514 13.0262 21.1482 13.0745L22.1047 13.5528C22.4732 13.7371 22.4732 14.263 22.1047 14.4472L21.1482 14.9255C21.0514 14.9739 20.9729 15.0523 20.9246 15.1491L20.4463 16.1056C20.2621 16.4741 19.7361 16.4741 19.5519 16.1056L19.0736 15.1491C19.0253 15.0523 18.9468 14.9739 18.85 14.9255L17.8935 14.4472C17.525 14.263 17.525 13.7371 17.8935 13.5528L18.85 13.0745Z"}),(0,a.jsx)("path",{d:"M4.85003 7.07454C4.94679 7.02616 5.02525 6.9477 5.07363 6.85094L5.55188 5.89443C5.73615 5.52591 6.26205 5.52591 6.44631 5.89444L6.92456 6.85094C6.97294 6.9477 7.05141 7.02616 7.14817 7.07454L8.10467 7.55279C8.4732 7.73706 8.4732 8.26296 8.10467 8.44722L7.14817 8.92547C7.05141 8.97385 6.97294 9.05232 6.92456 9.14908L6.44631 10.1056C6.26205 10.4741 5.73615 10.4741 5.55188 10.1056L5.07363 9.14908C5.02525 9.05232 4.94679 8.97385 4.85003 8.92547L3.89353 8.44722C3.525 8.26296 3.525 7.73706 3.89353 7.55279L4.85003 7.07454Z"})]});l.displayName="AutoMagicStickSparklesIcon"},13965:(e,t,n)=>{"use strict";n.d(t,{h:()=>l});var a=n(50612);let l=(0,n(94344).memo)(function(e){return(0,a.jsx)("svg",{width:"12",height:"10",viewBox:"0 0 12 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0.166504 0.916341C0.166504 0.594175 0.427671 0.333008 0.749837 0.333008H6.58317C6.90534 0.333008 7.1665 0.594175 7.1665 0.916341C7.1665 1.23851 6.90534 1.49967 6.58317 1.49967H0.749837C0.427671 1.49967 0.166504 1.23851 0.166504 0.916341ZM8.9165 0.916341C8.9165 0.594175 9.17767 0.333008 9.49984 0.333008H11.2498C11.572 0.333008 11.8332 0.594175 11.8332 0.916341C11.8332 1.23851 11.572 1.49967 11.2498 1.49967H9.49984C9.17767 1.49967 8.9165 1.23851 8.9165 0.916341ZM0.166504 4.99967C0.166504 4.67751 0.427671 4.41634 0.749837 4.41634H3.6665C3.98867 4.41634 4.24984 4.67751 4.24984 4.99967C4.24984 5.32184 3.98867 5.58301 3.6665 5.58301H0.749837C0.427671 5.58301 0.166504 5.32184 0.166504 4.99967ZM5.99984 4.99967C5.99984 4.67751 6.261 4.41634 6.58317 4.41634H11.2498C11.572 4.41634 11.8332 4.67751 11.8332 4.99967C11.8332 5.32184 11.572 5.58301 11.2498 5.58301H6.58317C6.261 5.58301 5.99984 5.32184 5.99984 4.99967ZM0.166504 9.08301C0.166504 8.76084 0.427671 8.49968 0.749837 8.49968H4.83317C5.15534 8.49968 5.4165 8.76084 5.4165 9.08301C5.4165 9.40517 5.15534 9.66634 4.83317 9.66634H0.749837C0.427671 9.66634 0.166504 9.40517 0.166504 9.08301ZM7.1665 9.08301C7.1665 8.76084 7.42767 8.49968 7.74984 8.49968H11.2498C11.572 8.49968 11.8332 8.76084 11.8332 9.08301C11.8332 9.40517 11.572 9.66634 11.2498 9.66634H7.74984C7.42767 9.66634 7.1665 9.40517 7.1665 9.08301Z"})})});l.displayName="ManuallySelectIcon"},15207:(e,t,n)=>{"use strict";n.d(t,{D:()=>r});var a=n(38928);let l=/(?:[\d!#$%&'*+/=?^_`a-z{|}~-]+(?:\.[\d!#$%&'*+/=?^_`a-z{|}~-]+)*|"(?:[\u0001-\u0008\u000B\u000C\u000E-\u001F!\u0023-\u005B\u005D-\u007F]|\\[\u0001-\u0009\u000B\u000C\u000E-\u007F])*")@(?:(?:[\da-z](?:[\da-z-]*[\da-z])?\.)+[\da-z](?:[\da-z-]*[\da-z])?|\[(?:(2(5[0-5]|[0-4]\d)|1\d\d|[1-9]?\d)\.){3}(?:(2(5[0-5]|[0-4]\d)|1\d\d|[1-9]?\d)|[\da-z-]*[\da-z]:(?:[\u0001-\u0008\u000B\u000C\u000E-\u001F\u0021-\u007F]|\\[\u0001-\u0009\u000B\u000C\u000E-\u007F])+)])/;function i(e){return"string"==typeof e&&l.test(e)}let r={validateArray:function(e){return Array.isArray(e)},validateNonEmptyArray:function(e){return Array.isArray(e)&&e.length>0},validateDateTimeISOString:function(e){return"string"==typeof e&&/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/.test(e)&&!isNaN(new Date(e).getTime())},validateDurationISOString:function(e){return"string"==typeof e&&/^P(?!$)(\d+(?:\.\d+)?Y)?(\d+(?:\.\d+)?M)?(\d+(?:\.\d+)?W)?(\d+(?:\.\d+)?D)?(T(?=\d)(\d+(?:\.\d+)?H)?(\d+(?:\.\d+)?M)?(\d+(?:\.\d+)?S)?)?$/.test(e)},validateEmailAddress:i,validateLindyEmailAddress:function(e){return i(e)&&(/@(\w+.)?lindymail.ai$/.test(e)||e.endsWith("dev.parse.lindy.ai")||e.endsWith("local.lindymail.ai"))},validatePluralArray:function(e){return Array.isArray(e)&&e.length>1},validateTimeZone:function(e){try{return!!(Intl&&Intl.DateTimeFormat().resolvedOptions().timeZone&&"string"==typeof e&&Intl.DateTimeFormat(void 0,{timeZone:e}))}catch(e){return!1}},validateURL:function(e){try{return new URL(e),!0}catch(e){return!1}},validatePassword:function(e){return a.k.newPassword().safeParse(e).success},validateNewUserName:function(e){return e.length>=2}}},72352:(e,t,n)=>{"use strict";n.d(t,{Ju:()=>o,OW:()=>r,YO:()=>l,aE:()=>function e(t){if("object"!=typeof t||null===t)return t;if(Array.isArray(t))return t.map(e);let n=a.J.safeParse(t);if(n.success){var l;return null===(l=n.data)||void 0===l?void 0:l.preview}let i={};for(let n in t)i[n]=e(t[n]);return i},ku:()=>i,qJ:()=>s});var a=n(28097);function l(e){if("object"!=typeof e||null===e)return e;let t={};for(let n in e)if("object"!=typeof e[n]||null===e[n]||Array.isArray(e[n]))t[n]=e[n];else for(let a in e[n])t["".concat(n,".").concat(a)]=e[n][a];return t}function i(e){return o(e.split(".").pop()||"")}function r(e){return null!==e&&(!!Array.isArray(e)||"object"==typeof e)}function s(e){return"string"==typeof e?e:JSON.stringify(e)}function o(e){return e.slice(Math.max(0,e.lastIndexOf("_")+1)).replace(/([a-z])(?=[A-Z])/g,"$1_").replace(/([A-Z])(?=[A-Z][a-z])/g,"$1_").split("_").map(e=>"ID"===e.toUpperCase()?"ID":"URL"===e.toUpperCase()?"URL":e.toUpperCase()===e?e:e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" ")}},85341:(e,t,n)=>{"use strict";n.d(t,{Kp:()=>d,dR:()=>o});var a=n(36760),l=n.n(a),i=n(76233),r=n.n(i),s=n(69748);let o=e=>(function(e){let{cronExpression:t,occurrencesToReturn:n,timeZone:a="UTC",minIntervalMinutes:i=10}=e;try{let e=l().parseExpression(t,{tz:a}),r=[];for(let t=0;t<Math.max(n,2);t++)r.push(e.next().toDate());let s=r.slice(0,n),[o,d]=r;if((d.getTime()-o.getTime())/6e4>=i)return{isValid:!0,errorMessage:null,nextOccurrences:s};return{isValid:!1,errorMessage:"The cron expression must have an interval of at least ".concat(i," minutes"),nextOccurrences:s}}catch(e){}return{isValid:!1,errorMessage:"Invalid cron expression",nextOccurrences:[]}})({cronExpression:e,minIntervalMinutes:10,occurrencesToReturn:1});function d(e){let t=r().toString(e,{verbose:!1}),n="At 0 minutes past the hour, ";return t.startsWith(n)&&(t=(0,s.A)(t.slice(n.length))),t.replace(/\b(monday|tuesday|wednesday|thursday|friday|saturday|sunday)\b/i,function(e){return e.charAt(0).toUpperCase()+e.slice(1)})}},39548:(e,t,n)=>{"use strict";function a(e){var t,n;return JSON.stringify({nodeId:null!==(t=e.nodeId)&&void 0!==t?t:"",values:null!==(n=e.values)&&void 0!==n?n:[]})}function l(e){if(!e)return null;try{let t=JSON.parse(e);if(!t.nodeId||!t.values||!Array.isArray(t.values))return null;return t}catch(e){return null}}function i(e){var t,n,a,l;return JSON.stringify({nodeId:null!==(t=e.nodeId)&&void 0!==t?t:"",fieldKey:null!==(n=e.fieldKey)&&void 0!==n?n:"",fieldType:null!==(a=e.fieldType)&&void 0!==a?a:"",displayName:null!==(l=e.displayName)&&void 0!==l?l:""})}function r(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!e)return null;try{let n=JSON.parse(e);if(!t)return n;if(!n.nodeId||!n.fieldKey||!n.fieldType||!n.displayName)return null;return n}catch(e){return null}}n.d(t,{BZ:()=>a,TX:()=>l,Vu:()=>i,Zx:()=>r})},84318:(e,t,n)=>{"use strict";n.d(t,{w:()=>function e(t){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return l.KQ.isObject(t)?Object.entries(t.properties).map(t=>{var n,a;let[r,s]=t;return(null===(n=s.lindyMetadata)||void 0===n?void 0:n.excludeFromOutputReferences)?null:l.KQ.isObject(s)?e(s,!1).map(e=>({value:"".concat(r,".").concat(e.value),displayName:e.displayName,type:e.type})):[{value:r,type:i(s)?s.type:"unknown",displayName:null===(a=s.lindyMetadata)||void 0===a?void 0:a.displayName}]}).filter(a.Pe).flat():n&&i(t)?[{value:"#",type:t.type,displayName:"output"}]:[]}});var a=n(63193),l=n(95654);let i=e=>"type"in e&&"string"==typeof e.type},90076:(e,t,n)=>{"use strict";n.d(t,{C:()=>i,i:()=>r});var a=n(95654),l=n(86937);function i(e){var t;let n=e.path.at(-1);return(null===(t=e.schema.lindyMetadata)||void 0===t?void 0:t.displayName)!=null?e.schema.lindyMetadata.displayName:n?(0,l.De)(n):a.KQ.isObject(e.schema)?"Object":a.KQ.isArray(e.schema)?"Array":""}function r(e){var t;return null!==(t=(0,a.l$)(e.schema))&&void 0!==t?t:""}},28097:(e,t,n)=>{"use strict";n.d(t,{J:()=>l});var a=n(7094);let l=a.z.object({_isNativeObject:a.z.literal(!0),type:a.z.string(),constructExpr:a.z.string(),rawValue:a.z.unknown(),preview:a.z.string()})},88748:(e,t,n)=>{"use strict";n.d(t,{Rb:()=>k,Rj:()=>y});var a=n(49398),l=n(87345),i=n(38928),r=n(7094);let s=e=>r.z.object({type:r.z.literal("AuthInput"),id:a.NC,auth:i.k.dropdown(e)}).addLindyMetadata({displayName:"Authorization",userDescription:"This will prompt the user to connect their account to the Lindy"}),o=s([]).merge(r.z.object({auth:r.z.string()})),d=r.z.object({type:r.z.literal("Button"),id:a.NC,label:r.z.string(),variant:r.z.enum(["primary","danger","outline","text"]).optional(),action:r.z.enum(["submit","next","skip"]).optional()}).addLindyMetadata({displayName:"Button"}),u=r.z.object({type:r.z.literal("CopyText"),id:a.NC,label:r.z.string(),description:r.z.string().optional(),content:r.z.string()}).addLindyMetadata({displayName:"Copyable content"}),c=r.z.object({type:r.z.literal("Header"),id:a.NC,content:r.z.string()}).addLindyMetadata({displayName:"Header"}),m=r.z.object({type:r.z.literal("Info"),id:a.NC,content:r.z.string(),variant:r.z.enum(["info","warning","success","error"]).default("info")}).addLindyMetadata({displayName:"Info"}),p=r.z.object({type:r.z.literal("NumberInput"),id:a.NC,label:r.z.string(),description:r.z.string().optional(),defaultValue:r.z.number().optional(),validation:r.z.object({min:r.z.union([r.z.null().addLindyMetadata({displayName:"None"}),r.z.number().default(0)]).optional().default(null),max:r.z.union([r.z.null().addLindyMetadata({displayName:"None"}),r.z.number().default(100)]).optional().default(null)}).optional(),required:r.z.boolean().optional()}).addLindyMetadata({displayName:"Number Input"}),g=r.z.object({type:r.z.literal("Paragraph"),id:a.NC,content:r.z.string()}).addLindyMetadata({displayName:"Paragraph"}),h=r.z.object({type:r.z.literal("SelectInput"),id:a.NC,label:r.z.string(),description:r.z.string().optional(),options:r.z.array(r.z.object({value:r.z.string(),label:r.z.string()})),addOtherOption:r.z.boolean().optional(),required:r.z.boolean().optional(),submits:r.z.boolean().optional().default(!1).describe("If true, the form will be submitted when the user selects an option.")}).addLindyMetadata({displayName:"Select Input"}),f=r.z.object({type:r.z.literal("TextInput"),id:a.NC,label:r.z.string(),description:r.z.string().optional(),defaultValue:r.z.string().optional(),placeholder:r.z.string().optional(),validation:r.z.object({minLength:r.z.union([r.z.null().addLindyMetadata({displayName:"None"}),r.z.number().default(1)]).optional().default(null),maxLength:r.z.union([r.z.null().addLindyMetadata({displayName:"None"}),r.z.number().default(100)]).optional().default(null)}).optional(),multiline:r.z.boolean().optional(),required:r.z.boolean().optional()}).addLindyMetadata({displayName:"Text Input"}),v=r.z.object({type:r.z.literal("StateGraphNodeField"),id:a.NC,field:l.v,authId:r.z.string().optional()}).addLindyMetadata({displayName:"Configure specific field"}),x=e=>r.z.discriminatedUnion("type",[d,u,c,m,p,g,h,f,...e.length>0?[s(e)]:[o],v]),b=new Set(["TextInput","NumberInput","SelectInput","AuthInput","StateGraphNodeField"]);function y(e){return b.has(e.type)}let j=r.z.object({__UNION_TYPE__:r.z.number(),value:r.z.object({id:r.z.string()}).and(r.z.union([r.z.object({label:r.z.object({__ACTION_CONFIG_VALUE_REFERENCE__:r.z.literal(!0),references:r.z.array(r.z.unknown())}),auth:r.z.undefined(),field:r.z.undefined()}),r.z.object({auth:r.z.object({__UNION_TYPE__:r.z.number(),value:r.z.string()}),label:r.z.undefined(),field:r.z.undefined()}),r.z.object({field:r.z.string(),auth:r.z.undefined(),label:r.z.undefined()})]))});function k(e){let t=j.safeParse(e);return t.success&&function(e){var t;let n="number"!=typeof e?null:null!==(t=x([])._def.options.map(e=>e.shape.type.value)[e])&&void 0!==t?t:null;return!!n&&b.has(n)}(t.data.__UNION_TYPE__)}r.z.object({__UNION_TYPE__:r.z.number(),value:r.z.object({id:r.z.string(),field:r.z.string()})})},47565:e=>{e.exports={enter:"agentResponseTokenEnterAnimation_enter__bHDq6"}},98800:()=>{}}]);